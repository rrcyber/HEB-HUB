<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:BW="java://com.tibco.pe.core.JavaCustomXPATHFunctions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns="http://www.tibco.com/pe/DeployedVarsType" xmlns:ns12="http://www.tibco.com/pe/GenerateErrorActivity/InputSchema" xmlns:pfx="http://xmlns.heb.com/ei/InAltaUsuario" xmlns:ns2="http://www.tibco.com/pe/EngineTypes" xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:ns1="http://www.tibco.com/xmlns/ae2xsd/2002/05/ae/adapter/ldap/activedirectory/heb.vendor.com.mx" xmlns:ns4="http://www.tibco.com/pe/WriteToLogActivitySchema" xmlns:ns3="http://www.tibco.com/xmlns/ae2xsd/2002/05/ae/adapter/ldap/activedirectory/ad.heb.com.mx" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:pfx5="http://xmlns.heb.com/ei/OutCrearUsuario" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:pfx4="http://xmlns.heb.com/ei/InCrearUsuario" xmlns:pfx3="http://xmlns.heb.com/ei/error" xmlns:pfx2="http://xmlns.heb.com/ei/OutAltaUsuario" xmlns:pfx8="http://www.tibco.com/ns/no_namespace_schema_location/Shared Resources/Schema Definitions/Common/Exception.xsd" xmlns:pfx7="http://www.tibco.com/schemas/IdentityManagement_mx/Shared Resources/Schema Definitions/Custom/Schema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pfx6="http://xmlns.heb.com/ei/ErrorManagementSchema">
    <xsd:import namespace="http://xmlns.heb.com/ei/error" schemaLocation="/Resources/EIM/Services/error/error.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/InAltaUsuario" schemaLocation="/Shared Resources/Schema Definitions/Custom/InAltaUsuario.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/OutAltaUsuario" schemaLocation="/Shared Resources/Schema Definitions/Custom/OutAltaUsuario.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/error" schemaLocation="/Shared Resources/Schema Definitions/Common/error.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/InCrearUsuario" schemaLocation="/Shared Resources/Schema Definitions/Custom/InCrearUsuario.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/OutCrearUsuario" schemaLocation="/Shared Resources/Schema Definitions/Custom/OutCrearUsuario.xsd"/>
    <xsd:import namespace="http://xmlns.heb.com/ei/ErrorManagementSchema" schemaLocation="/Shared Resources/Schema Definitions/Common/ErrorManagementSchema_SOAP.xsd"/>
    <xsd:import namespace="http://www.tibco.com/schemas/IdentityManagement_mx/Shared Resources/Schema Definitions/Custom/Schema.xsd" schemaLocation="/Shared Resources/Schema Definitions/Custom/RecordFromPS.xsd"/>
    <xsd:import namespace="http://www.tibco.com/ns/no_namespace_schema_location/Shared Resources/Schema Definitions/Common/Exception.xsd" schemaLocation="/Shared Resources/Schema Definitions/Common/Exception.xsd"/>
    <pd:name>PeopleSoftIdentityManagementMX/Employee_PeopleSoft_Process/Employee_PeopleSoft_To_ActiveDirectory_Process.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startType ref="pfx7:EMPLOYEE"/>
    <pd:startX>45</pd:startX>
    <pd:startY>571</pd:startY>
    <pd:returnBindings>
        <xsl:choose>
            <xsl:when test="$Add_ControlCount_AD/javaCodeActivityOutput/out_result='Success'  and  $Operacion/Operacion_Out='A' and $Search-ID_LDAP-3/javaCodeActivityOutput/out_dn!=''">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '1','-',substring($Add_ControlCount_AD/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:when test="$Add_ControlCount_AD/javaCodeActivityOutput/out_result!='Success'  and  $Operacion/Operacion_Out='A'">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '3','-',substring($Add_ControlCount_AD/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:when test="$Mod_Employee_LDAP-2/javaCodeActivityOutput/out_result='Success'  and  $Operacion/Operacion_Out='M' and $Search-ID_LDAP/javaCodeActivityOutput/out_dn!=''">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '1','-',substring($Mod_Employee_LDAP-2/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:when test="$Mod_Employee_LDAP-2/javaCodeActivityOutput/out_result!='Success'  and  $Operacion/Operacion_Out='M'">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '0','-',substring($Mod_Employee_LDAP-2/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:when test="$Baja_Count_AD/javaCodeActivityOutput/out_result='Success'  and  $Operacion/Operacion_Out='B' and $Search-ID_LDAP/javaCodeActivityOutput/out_dn!=''">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '1','-',substring($Baja_Count_AD/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:when test="$Baja_Count_AD/javaCodeActivityOutput/out_result!='Success'  and  $Operacion/Operacion_Out='B'">
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '0','-',substring($Baja_Count_AD/javaCodeActivityOutput/out_result, 1,20))"/>
                </resultOperation>
            </xsl:when>
            <xsl:otherwise>
                <resultOperation>
                    <xsl:value-of select="concat($Operacion/Operacion_Out, '2','-NO DEFINIDO')"/>
                </resultOperation>
            </xsl:otherwise>
        </xsl:choose>
    </pd:returnBindings>
    <pd:endName>End</pd:endName>
    <pd:endType>
        <xsd:element name="resultOperation" type="xsd:string"/>
    </pd:endType>
    <pd:endX>1167</pd:endX>
    <pd:endY>247</pd:endY>
    <pd:errorSchemas>
        <Exception ref="pfx8:Exception"/>
    </pd:errorSchemas>
    <pd:processVariables>
        <Operacion>
            <xsd:element name="Operacion_Out" type="xsd:string"/>
        </Operacion>
        <membersOff>
            <xsd:element name="membersgroups" type="xsd:string"/>
        </membersOff>
        <memeberFrom_AD>
            <xsd:element name="memberString_from_Ad" type="xsd:string"/>
        </memeberFrom_AD>
        <Resultado>
            <xsd:element name="Resultado_Out" type="xsd:string"/>
        </Resultado>
        <cnUser>
            <xsd:element name="cnUser_Value" type="xsd:string"/>
        </cnUser>
        <dnPrincipal>
            <xsd:element name="dnToOperate" type="xsd:string"/>
        </dnPrincipal>
    </pd:processVariables>
    <pd:targetNamespace>http://xmlns.example.com/1387488551500</pd:targetNamespace>
    <pd:group name="Group (1)">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>540</pd:x>
        <pd:y>1</pd:y>
        <pd:width>287</pd:width>
        <pd:height>185</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>repeat</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:indexSlot>in2</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:repeatCondition>$Search-ID_LDAP-3/javaCodeActivityOutput/out_dn !=''</pd:repeatCondition>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>Search-ID_LDAP-3</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Search-ID_LDAP-1</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Search-ID_LDAP-3</pd:from>
            <pd:to>Search-ID_LDAP-1</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="Search-ID_LDAP-1">
            <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
            <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
            <pd:x>604</pd:x>
            <pd:y>56</pd:y>
            <config>
                <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP1</fileName>
                <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
                <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP1{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP1() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

	
          // Create the search controls         
	      SearchControls searchCtls = new SearchControls();

	      //Specify the attributes to return
	      String returnedAtts[]={"objectGUID","distinguishedName", "cn","samAccountName"};
	      searchCtls.setReturningAttributes(returnedAtts);

	      //Specify the search scope
	      searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);

	      //specify the LDAP search filter
	      String searchFilter = "(&amp;(objectClass=user)(samAccountName=" + in_sAMAccountName + "))";

	      //Specify the Base for the search
	      String searchBase = in_dn;

	      // Search for objects using the filter
	      NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	      //Loop through the search results
	      while (answer.hasMoreElements())
	      {
	        SearchResult sr = (SearchResult)answer.next();

	        Attributes attrs = sr.getAttributes();
	        
	        byte[] guid = (byte[]) attrs.get("objectGUID").get();
		out_guid = convertToBindingString(guid);
		//out_guid = convertToByteString(guid);
                String dn = attrs.get("distinguishedName").toString();
                String[] name = dn.split(":");
                out_dn = name[1].trim();
		out_dn = out_dn.replace("á", "\\E1"); 
		out_dn = out_dn.replace("é", "\\E9");
		out_dn = out_dn.replace("í", "\\ED");
		out_dn = out_dn.replace("ó", "\\F3");
		out_dn = out_dn.replace("ú", "\\FA");
                out_dn = out_dn.replace("ñ", "\\F1");
                String cn = attrs.get("cn").toString();
                String[] cname = cn.split(":");
                out_cn = cname[1].trim();
                out_samAccountName="";
                }
                
                if (out_cn.equals("")) {
                  searchFilter = "(&amp;(objectClass=user)(employeeID=" + in_employeeid + "))";
                  searchBase = in_dn;
                  answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	          //Loop through the search results
	          while (answer.hasMoreElements())
	          {
	            SearchResult sr = (SearchResult)answer.next();

	            Attributes attrs = sr.getAttributes();
	        
	            byte[] guid = (byte[]) attrs.get("objectGUID").get();
		    out_guid = convertToBindingString(guid);
		    //out_guid = convertToByteString(guid);
                    String dn = attrs.get("distinguishedName").toString();
                    String[] name = dn.split(":");
                    out_dn = name[1].trim();
		    out_dn = out_dn.replace("á", "\\E1"); 
		    out_dn = out_dn.replace("é", "\\E9");
		    out_dn = out_dn.replace("í", "\\ED");
		    out_dn = out_dn.replace("ó", "\\F3");
		    out_dn = out_dn.replace("ú", "\\FA");
                    out_dn = out_dn.replace("ñ", "\\F1");
                    String cn = attrs.get("cn").toString();
                    String[] cname = cn.split(":");
                    out_cn = cname[1].trim();
                    out_samAccountName= attrs.get("samAccountName").toString();;
                }
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
                <inputData>
                    <row>
                        <fieldName>in_userDN</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_sAMAccountName</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_server</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_port</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_dn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_employeeid</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                </inputData>
                <outputData>
                    <row>
                        <fieldName>out_guid</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_dn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_cn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_samAccountName</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                </outputData>
                <byteCode>
                    <class>
                        <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP1</name>
                        <byteCode>yv66vgAAADIBBgkAUACLCQBQAIwJAFAAjQkAUACOCQBQAI8JAFAAkAkAUACRCQBQAJIJAFAAkwkAUACUCgBRAJUIAJYHAJcKAA0AmAgAmQgAmgoADQCbCACcBwCdCgATAJUIAJ4KABMAnwgAoAoAEwChCACiCACjCACkCAClCACmCgCnAKgIAKkIAKoHAKsKACEArAcArQoAIwCVBwCuCACvCACwCACxCgAjALIKACMAswgAtAgAtQsAtgC3CwC4ALkLALgAugcAuwoAMAC8CwC9AL4LAL8AwAcAwQoAUADCCgBRAKEKACUAwwoAJQDECADFCADGCgAlAMcIAMgIAMkIAMoIAMsIAMwIAM0IAM4IAM8IANAIANEKACUA0ggA0wsAtgDUCgBQANUKAFAA1ggA1wgA2AoAEwDZCgDaANsIANwHAN0HAN4BAAlpbl91c2VyRE4BABJMamF2YS9sYW5nL1N0cmluZzsBABFpbl9zQU1BY2NvdW50TmFtZQEACWluX3NlcnZlcgEAB2luX3BvcnQBAAVpbl9kbgEADWluX2VtcGxveWVlaWQBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEADGdldGluX3VzZXJETgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEADHNldGluX3VzZXJETgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAFGdldGluX3NBTUFjY291bnROYW1lAQAUc2V0aW5fc0FNQWNjb3VudE5hbWUBAAxnZXRpbl9zZXJ2ZXIBAAxzZXRpbl9zZXJ2ZXIBAApnZXRpbl9wb3J0AQAKc2V0aW5fcG9ydAEACGdldGluX2RuAQAIc2V0aW5fZG4BABBnZXRpbl9lbXBsb3llZWlkAQAQc2V0aW5fZW1wbG95ZWVpZAEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAAY8aW5pdD4BAAMoKVYBAAZpbnZva2UBAA1TdGFja01hcFRhYmxlBwDdBwDfBwCXBwCtBwDgBwCuBwDhAQAKRXhjZXB0aW9ucwcA4gEAFmNvbnZlcnRUb0JpbmRpbmdTdHJpbmcBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAVY29udmVydFRvRGFzaGVkU3RyaW5nAQALcHJlZml4WmVyb3MBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBABNjb252ZXJ0VG9CeXRlU3RyaW5nBwCdAQAKU291cmNlRmlsZQEAQUVtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9MREFQMS5qYXZhDABSAFMMAFQAUwwAVQBTDABWAFMMAFcAUwwAWABTDABZAFMMAFoAUwwAWwBTDABcAFMMAHUAdgEAAAEAE2phdmEvdXRpbC9IYXNodGFibGUMAHUA4wEAG2phdmEubmFtaW5nLmZhY3RvcnkuaW5pdGlhbAEAIGNvbS5zdW4uam5kaS5sZGFwLkxkYXBDdHhGYWN0b3J5DADkAOUBABhqYXZhLm5hbWluZy5wcm92aWRlci51cmwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAB2xkYXA6Ly8MAOYA5wEAAToMAOgAXgEAI2phdmEubmFtaW5nLnNlY3VyaXR5LmF1dGhlbnRpY2F0aW9uAQAGc2ltcGxlAQAeamF2YS5uYW1pbmcuc2VjdXJpdHkucHJpbmNpcGFsAQAgamF2YS5uYW1pbmcuc2VjdXJpdHkuY3JlZGVudGlhbHMBAC10aWJjby5jbGllbnRWYXIuQ29ubmVjdGlvbnMvTERBUC9JbnRlcm5vL1Bhc3MHAOkMAOoA6wEAImphdmEubmFtaW5nLmxkYXAuYXR0cmlidXRlcy5iaW5hcnkBAApvYmplY3RHVUlEAQAoamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Jbml0aWFsRGlyQ29udGV4dAwAdQDsAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hDb250cm9scwEAEGphdmEvbGFuZy9TdHJpbmcBABFkaXN0aW5ndWlzaGVkTmFtZQEAAmNuAQAOc2FtQWNjb3VudE5hbWUMAO0A7gwA7wDjAQAkKCYob2JqZWN0Q2xhc3M9dXNlcikoc2FtQWNjb3VudE5hbWU9AQACKSkHAN8MAPAA8QcA4QwA8gDzDAD0APUBACNqYXZheC9uYW1pbmcvZGlyZWN0b3J5L1NlYXJjaFJlc3VsdAwA9gD3BwD4DAD5APoHAPsMAPkA9QEAAltCDACCAIMMAPwA/QwA/gBeAQACw6EBAANcRTEMAP8BAAEAAsOpAQADXEU5AQACw60BAANcRUQBAALDswEAA1xGMwEAAsO6AQADXEZBAQACw7EBAANcRjEMAQEBAgEAICgmKG9iamVjdENsYXNzPXVzZXIpKGVtcGxveWVlSUQ9DAEDAHYMAIQAgwwAhQCGAQABLQEAATAMAHUAYgcBBAwBBQCGAQABXAEAplBlb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzU2VhcmNoSURfTERBUDEBABBqYXZhL2xhbmcvT2JqZWN0AQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9EaXJDb250ZXh0AQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAHmphdmF4L25hbWluZy9OYW1pbmdFbnVtZXJhdGlvbgEAE2phdmEvbGFuZy9FeGNlcHRpb24BAAQoSSlWAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBABZzZXRSZXR1cm5pbmdBdHRyaWJ1dGVzAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEADnNldFNlYXJjaFNjb3BlAQAGc2VhcmNoAQBtKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9uYW1pbmcvZGlyZWN0b3J5L1NlYXJjaENvbnRyb2xzOylMamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uOwEAD2hhc01vcmVFbGVtZW50cwEAAygpWgEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADWdldEF0dHJpYnV0ZXMBACUoKUxqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0F0dHJpYnV0ZXM7AQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGVzAQADZ2V0AQA2KExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGU7AQAgamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGUBAAVzcGxpdAEAJyhMamF2YS9sYW5nL1N0cmluZzspW0xqYXZhL2xhbmcvU3RyaW5nOwEABHRyaW0BAAdyZXBsYWNlAQBEKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlO0xqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylMamF2YS9sYW5nL1N0cmluZzsBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAVjbG9zZQEAEWphdmEvbGFuZy9JbnRlZ2VyAQALdG9IZXhTdHJpbmcAIQBQAFEAAAAKAAQAUgBTAAAABABUAFMAAAAEAFUAUwAAAAQAVgBTAAAABABXAFMAAAAEAFgAUwAAAAQAWQBTAAAABABaAFMAAAAEAFsAUwAAAAQAXABTAAAAGgABAF0AXgABAF8AAAAdAAEAAQAAAAUqtAABsAAAAAEAYAAAAAYAAQAAABsAAQBhAGIAAQBfAAAAIgACAAIAAAAGKiu1AAGxAAAAAQBgAAAACgACAAAAHgAFAB8AAQBjAF4AAQBfAAAAHQABAAEAAAAFKrQAArAAAAABAGAAAAAGAAEAAAAhAAEAZABiAAEAXwAAACIAAgACAAAABiortQACsQAAAAEAYAAAAAoAAgAAACQABQAlAAEAZQBeAAEAXwAAAB0AAQABAAAABSq0AAOwAAAAAQBgAAAABgABAAAAJwABAGYAYgAB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</byteCode>
                    </class>
                </byteCode>
            </config>
            <pd:inputBindings>
                <javaCodeActivityInput>
                    <in_userDN>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                    </in_userDN>
                    <in_sAMAccountName>
                        <xsl:value-of select="$Map-Data/login"/>
                    </in_sAMAccountName>
                    <in_server>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                    </in_server>
                    <in_port>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                    </in_port>
                    <in_dn>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNSearch"/>
                    </in_dn>
                    <in_employeeid>
                        <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                    </in_employeeid>
                </javaCodeActivityInput>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="Search-ID_LDAP-3">
            <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
            <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
            <pd:x>738</pd:x>
            <pd:y>130</pd:y>
            <config>
                <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP3</fileName>
                <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
                <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.Vector;
import java.util.Enumeration;



public class Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP3{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_cert_loc = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_member = "";
	protected String out_mail = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_cert_loc() {
		return in_cert_loc;
	}
	public void setin_cert_loc(String val) {
		in_cert_loc = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_member() {
		return out_member;
	}
	public void setout_member(String val) {
		out_member = val;
	}
	public String getout_mail() {
		return out_mail;
	}
	public void setout_mail(String val) {
		out_mail = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP3() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_cert_loc
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_member
	Out : String out_mail
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
              if (in_port.equals("636")) {
                  String keystore=in_cert_loc;
                  //"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";
                  //C:\tibco\jre\1.5.0\lib\security\hebcacerts2
                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

              //ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      

                            

	      ldapContext = new InitialDirContext(ldapEnv);

              
          // Create the search controls         
	      SearchControls searchCtls = new SearchControls();

	      //Specify the attributes to return
	      String returnedAtts[]={"objectGUID","distinguishedName", "cn","sAMAccountName","memberOf","mail"};
	      searchCtls.setReturningAttributes(returnedAtts);

	      //Specify the search scope
	      searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);

	      //specify the LDAP search filter
	      String searchFilter = "(&amp;(objectClass=user)(sAMAccountName=" + in_sAMAccountName + "))";

	      //Specify the Base for the search
	      String searchBase = in_dn;

	      // Search for objects using the filter
	      NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	      //Loop through the search results
	      while (answer.hasMoreElements())
	      {
	        SearchResult sr = (SearchResult)answer.next();

	        Attributes attrs = sr.getAttributes();
	        
	        byte[] guid = (byte[]) attrs.get("objectGUID").get();
		out_guid = convertToBindingString(guid);
		//out_guid = convertToByteString(guid);
                String dn = attrs.get("distinguishedName").toString();
                String[] name = dn.split(":");
                out_dn = name[1].trim();
		out_dn = out_dn.replace("á", "\\E1"); 
		out_dn = out_dn.replace("é", "\\E9");
		out_dn = out_dn.replace("í", "\\ED");
		out_dn = out_dn.replace("ó", "\\F3");
		out_dn = out_dn.replace("ú", "\\FA");
                out_dn = out_dn.replace("ñ", "\\F1");
                String cn = attrs.get("cn").toString();
                String[] cname = cn.split(":");
                out_cn = cname[1].trim();
                out_samAccountName="";
                }
                
                if (out_cn.equals("")) {
                  searchFilter = "(&amp;(objectClass=user)(employeeID=" + in_employeeid + "))";
                  searchBase = in_dn;
                  answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	          //Loop through the search results
	          while (answer.hasMoreElements())
	          {
	            SearchResult sr = (SearchResult)answer.next();

	            Attributes attrs = sr.getAttributes();
	        
	            byte[] guid = (byte[]) attrs.get("objectGUID").get();
		    out_guid = convertToBindingString(guid);
		    //out_guid = convertToByteString(guid);
                    String dn = attrs.get("distinguishedName").toString();
                    String[] name = dn.split(":");
                    out_dn = name[1].trim();
		    out_dn = out_dn.replace("á", "\\E1"); 
		    out_dn = out_dn.replace("é", "\\E9");
		    out_dn = out_dn.replace("í", "\\ED");
		    out_dn = out_dn.replace("ó", "\\F3");
		    out_dn = out_dn.replace("ú", "\\FA");
                    out_dn = out_dn.replace("ñ", "\\F1");
                    String cn = attrs.get("cn").toString();
                    String[] cname = cn.split(":");
                    out_cn = cname[1].trim();
                    out_samAccountName= attrs.get("sAMAccountName").toString();
                    out_mail= attrs.get("mail").toString();
                    //out_member=attrs.get("memberOf").toString();
                   
                   //List&lt;String&gt; memberOf = new ArrayList&lt;String&gt;();
                   out_member="";
                   for(Enumeration vals = attrs.get("memberOf").getAll(); vals.hasMoreElements();){
                       //memberOf.add((String)vals.nextElement());
                       out_member=out_member+(String)vals.nextElement()+"+";
                   }
                }
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
                <outputData>
                    <row>
                        <fieldName>out_guid</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_dn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_cn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_samAccountName</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_member</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>out_mail</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                </outputData>
                <inputData>
                    <row>
                        <fieldName>in_userDN</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_sAMAccountName</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_server</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_port</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_dn</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_employeeid</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                    <row>
                        <fieldName>in_cert_loc</fieldName>
                        <fieldType>string</fieldType>
                        <fieldRequired>required</fieldRequired>
                    </row>
                </inputData>
                <byteCode>
                    <class>
                        <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP3</name>
                        <byteCode>yv66vgAAADIBOAkAXwCmCQBfAKcJAF8AqAkAXwCpCQBfAKoJAF8AqwkAXwCsCQBfAK0JAF8ArgkAXwCvCQBfALAJAF8AsQkAXwCyCgBgALMIALQHALUKABAAtggAtwoALwC4CAC5CgC6ALsIALwHAL0KABcAswgAvgoAFwC/CADACADBCgAXAMIKABAAwwgAxAgAxQgAxggAxwgAyAgAyQgAyggAywgAzAoAzQDOCADPCADQBwDRCgArANIHANMKAC0AswcA1AgA1QgA1ggA1wgA2AgA2QoALQDaCgAtANsIANwIAN0LAN4A3wsA4ADhCwDgAOIHAOMKADwA5AsA5QDmCwDnAOgHAOkKAF8A6goAYADCCgAvAOsKAC8A7AgA7QgA7goALwDvCADwCADxCADyCADzCAD0CAD1CAD2CAD3CAD4CAD5CAD6CwDnAPsLAPwA4QsA/AD9CAD+CwDeAP8KAF8BAAoAXwEBCAECCAEDCgAXAQQKAQUBBggBBwcBCAcBCQEACWluX3VzZXJETgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAEWluX3NBTUFjY291bnROYW1lAQAJaW5fc2VydmVyAQAHaW5fcG9ydAEABWluX2RuAQANaW5fZW1wbG95ZWVpZAEAC2luX2NlcnRfbG9jAQAIb3V0X2d1aWQBAAZvdXRfZG4BAAZvdXRfY24BABJvdXRfc2FtQWNjb3VudE5hbWUBAApvdXRfbWVtYmVyAQAIb3V0X21haWwBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBAA5nZXRpbl9jZXJ0X2xvYwEADnNldGluX2NlcnRfbG9jAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9tZW1iZXIBAA1zZXRvdXRfbWVtYmVyAQALZ2V0b3V0X21haWwBAAtzZXRvdXRfbWFpbAEABjxpbml0PgEAAygpVgEABmludm9rZQEADVN0YWNrTWFwVGFibGUHALUHAQgHAQoHANMHAQsHANQHAQwHAOMHAQ0HAQ4BAApFeGNlcHRpb25zBwEPAQAWY29udmVydFRvQmluZGluZ1N0cmluZwEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBABVjb252ZXJ0VG9EYXNoZWRTdHJpbmcBAAtwcmVmaXhaZXJvcwEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAE2NvbnZlcnRUb0J5dGVTdHJpbmcHAL0BAApTb3VyY2VGaWxlAQBBRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzc1NlYXJjaElEX0xEQVAzLmphdmEMAGEAYgwAYwBiDABkAGIMAGUAYgwAZgBiDABnAGIMAGgAYgwAaQBiDABqAGIMAGsAYgwAbABiDABtAGIMAG4AYgwAjQCOAQAAAQATamF2YS91dGlsL0hhc2h0YWJsZQwAjQEQAQADNjM2DAERARIBABhqYXZheC5uZXQuc3NsLnRydXN0U3RvcmUHARMMARQBFQEAGGphdmEubmFtaW5nLnByb3ZpZGVyLnVybAEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyAQAHbGRhcDovLwwBFgEXAQABOgEAAzM4OQwBGABwDAEZARoBABtqYXZhLm5hbWluZy5mYWN0b3J5LmluaXRpYWwBACBjb20uc3VuLmpuZGkubGRhcC5MZGFwQ3R4RmFjdG9yeQEAHWphdmEubmFtaW5nLnNlY3VyaXR5LnByb3RvY29sAQADc3NsAQAjamF2YS5uYW1pbmcuc2VjdXJpdHkuYXV0aGVudGljYXRpb24BAAZzaW1wbGUBAB5qYXZhLm5hbWluZy5zZWN1cml0eS5wcmluY2lwYWwBACBqYXZhLm5hbWluZy5zZWN1cml0eS5jcmVkZW50aWFscwEALXRpYmNvLmNsaWVudFZhci5Db25uZWN0aW9ucy9MREFQL0ludGVybm8vUGFzcwcBGwwBHAEdAQAiamF2YS5uYW1pbmcubGRhcC5hdHRyaWJ1dGVzLmJpbmFyeQEACm9iamVjdEdVSUQBAChqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0luaXRpYWxEaXJDb250ZXh0DACNAR4BACVqYXZheC9uYW1pbmcvZGlyZWN0b3J5L1NlYXJjaENvbnRyb2xzAQAQamF2YS9sYW5nL1N0cmluZwEAEWRpc3Rpbmd1aXNoZWROYW1lAQACY24BAA5zQU1BY2NvdW50TmFtZQEACG1lbWJlck9mAQAEbWFpbAwBHwEgDAEhARABACQoJihvYmplY3RDbGFzcz11c2VyKShzQU1BY2NvdW50TmFtZT0BAAIpKQcBCgwBIgEjBwEMDAEkASUMASYBJwEAI2phdmF4L25hbWluZy9kaXJlY3RvcnkvU2VhcmNoUmVzdWx0DAEoASkHAQ0MASoBKwcBLAwBKgEnAQACW0IMAJ0AngwBLQEuDAEvAHABAALDoQEAA1xFMQwBMAExAQACw6kBAANcRTkBAALDrQEAA1xFRAEAAsOzAQADXEYzAQACw7oBAANcRkEBAALDsQEAA1xGMQEAICgmKG9iamVjdENsYXNzPXVzZXIpKGVtcGxveWVlSUQ9DAEyATMHAQ4MATQBJwEAASsMATUAjgwAnwCeDACgAKEBAAEtAQABMAwAjQB0BwE2DAE3AKEBAAFcAQCmUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9MREFQMwEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABNbTGphdmEvbGFuZy9TdHJpbmc7AQAeamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uAQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGVzAQAVamF2YS91dGlsL0VudW1lcmF0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABChJKVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBqYXZhL2xhbmcvU3lzdGVtAQALc2V0UHJvcGVydHkBADgoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBACRjb20vdGliY28vcGUvcGx1Z2luL1BsdWdpblByb3BlcnRpZXMBAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAYKExqYXZhL3V0aWwvSGFzaHRhYmxlOylWAQAWc2V0UmV0dXJuaW5nQXR0cmlidXRlcwEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAA5zZXRTZWFyY2hTY29wZQEABnNlYXJjaAEAbShMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hDb250cm9sczspTGphdmF4L25hbWluZy9OYW1pbmdFbnVtZXJhdGlvbjsBAA9oYXNNb3JlRWxlbWVudHMBAAMoKVoBAARuZXh0AQAUKClMamF2YS9sYW5nL09iamVjdDsBAA1nZXRBdHRyaWJ1dGVzAQAlKClMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGVzOwEAA2dldAEANihMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlOwEAIGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlAQAFc3BsaXQBACcoTGphdmEvbGFuZy9TdHJpbmc7KVtMamF2YS9sYW5nL1N0cmluZzsBAAR0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</byteCode>
                    </class>
                </byteCode>
            </config>
            <pd:inputBindings>
                <javaCodeActivityInput>
                    <in_userDN>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                    </in_userDN>
                    <in_sAMAccountName>
                        <xsl:value-of select="$Map-Data/login"/>
                    </in_sAMAccountName>
                    <in_server>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                    </in_server>
                    <in_port>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                    </in_port>
                    <in_dn>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNSearch"/>
                    </in_dn>
                    <in_employeeid>
                        <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                    </in_employeeid>
                    <in_cert_loc>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                    </in_cert_loc>
                </javaCodeActivityInput>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:activity name="Add_Employee_LDAP">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>467</pd:x>
        <pd:y>62</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Employee_LDAP</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.*;
import javax.naming.*;
import javax.naming.directory.*;

public class Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Employee_LDAP{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_entry_dn = "";
	protected String in_cn_user = "";
	protected String in_samAccountName = "";
	protected String in_sn = "";
	protected String in_mail = "";
	protected String in_telephone = "";
	protected int in_useraccountcontrol = 0;
	protected String in_givenname = "";
	protected String in_displayname = "";
	protected String in_employeenumber = "";
	protected String in_employetype = "";
	protected String in_userprincipalname = "";
	protected String in_departamentnumber = "";
	protected String in_location = "";
	protected String in_title = "";
	protected String in_physicaldeliveryofficename = "";
	protected String in_departament = "";
	protected String in_company = "";
	protected String in_description = "";
	protected String in_info = "";
	protected String in_name = "";
	protected String in_complete_name = "";
	protected String in_password = "";
	protected String in_certi_loc = "";
	protected String poBoxData = "";
	protected String jobCode = "";
	protected String manager_cn = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected int out_error = 0;
	protected String out_email = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_entry_dn() {
		return in_entry_dn;
	}
	public void setin_entry_dn(String val) {
		in_entry_dn = val;
	}
	public String getin_cn_user() {
		return in_cn_user;
	}
	public void setin_cn_user(String val) {
		in_cn_user = val;
	}
	public String getin_samAccountName() {
		return in_samAccountName;
	}
	public void setin_samAccountName(String val) {
		in_samAccountName = val;
	}
	public String getin_sn() {
		return in_sn;
	}
	public void setin_sn(String val) {
		in_sn = val;
	}
	public String getin_mail() {
		return in_mail;
	}
	public void setin_mail(String val) {
		in_mail = val;
	}
	public String getin_telephone() {
		return in_telephone;
	}
	public void setin_telephone(String val) {
		in_telephone = val;
	}
	public int getin_useraccountcontrol() {
		return in_useraccountcontrol;
	}
	public void setin_useraccountcontrol(int val) {
		in_useraccountcontrol = val;
	}
	public String getin_givenname() {
		return in_givenname;
	}
	public void setin_givenname(String val) {
		in_givenname = val;
	}
	public String getin_displayname() {
		return in_displayname;
	}
	public void setin_displayname(String val) {
		in_displayname = val;
	}
	public String getin_employeenumber() {
		return in_employeenumber;
	}
	public void setin_employeenumber(String val) {
		in_employeenumber = val;
	}
	public String getin_employetype() {
		return in_employetype;
	}
	public void setin_employetype(String val) {
		in_employetype = val;
	}
	public String getin_userprincipalname() {
		return in_userprincipalname;
	}
	public void setin_userprincipalname(String val) {
		in_userprincipalname = val;
	}
	public String getin_departamentnumber() {
		return in_departamentnumber;
	}
	public void setin_departamentnumber(String val) {
		in_departamentnumber = val;
	}
	public String getin_location() {
		return in_location;
	}
	public void setin_location(String val) {
		in_location = val;
	}
	public String getin_title() {
		return in_title;
	}
	public void setin_title(String val) {
		in_title = val;
	}
	public String getin_physicaldeliveryofficename() {
		return in_physicaldeliveryofficename;
	}
	public void setin_physicaldeliveryofficename(String val) {
		in_physicaldeliveryofficename = val;
	}
	public String getin_departament() {
		return in_departament;
	}
	public void setin_departament(String val) {
		in_departament = val;
	}
	public String getin_company() {
		return in_company;
	}
	public void setin_company(String val) {
		in_company = val;
	}
	public String getin_description() {
		return in_description;
	}
	public void setin_description(String val) {
		in_description = val;
	}
	public String getin_info() {
		return in_info;
	}
	public void setin_info(String val) {
		in_info = val;
	}
	public String getin_name() {
		return in_name;
	}
	public void setin_name(String val) {
		in_name = val;
	}
	public String getin_complete_name() {
		return in_complete_name;
	}
	public void setin_complete_name(String val) {
		in_complete_name = val;
	}
	public String getin_password() {
		return in_password;
	}
	public void setin_password(String val) {
		in_password = val;
	}
	public String getin_certi_loc() {
		return in_certi_loc;
	}
	public void setin_certi_loc(String val) {
		in_certi_loc = val;
	}
	public String getpoBoxData() {
		return poBoxData;
	}
	public void setpoBoxData(String val) {
		poBoxData = val;
	}
	public String getjobCode() {
		return jobCode;
	}
	public void setjobCode(String val) {
		jobCode = val;
	}
	public String getmanager_cn() {
		return manager_cn;
	}
	public void setmanager_cn(String val) {
		manager_cn = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public int getout_error() {
		return out_error;
	}
	public void setout_error(int val) {
		out_error = val;
	}
	public String getout_email() {
		return out_email;
	}
	public void setout_email(String val) {
		out_email = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Employee_LDAP() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_entry_dn
	In  : String in_cn_user
	In  : String in_samAccountName
	In  : String in_sn
	In  : String in_mail
	In  : String in_telephone
	In  : int in_useraccountcontrol
	In  : String in_givenname
	In  : String in_displayname
	In  : String in_employeenumber
	In  : String in_employetype
	In  : String in_userprincipalname
	In  : String in_departamentnumber
	In  : String in_location
	In  : String in_title
	In  : String in_physicaldeliveryofficename
	In  : String in_departament
	In  : String in_company
	In  : String in_description
	In  : String in_info
	In  : String in_name
	In  : String in_complete_name
	In  : String in_password
	In  : String in_certi_loc
	In  : String poBoxData
	In  : String jobCode
	In  : String manager_cn
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : int out_error
	Out : String out_email
* Available Variables: DO NOT MODIFY *****/
             
		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
              
              if (in_port.equals("636")) {
                  String keystore=in_certi_loc;
                  //"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";
                  
                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }
 
	      
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);
             //try {
  
              if (in_mail.equals("")) {
                 in_mail=" ";
              }
              if (in_mail==null) {
                 in_mail=" ";
              }
	      if (in_telephone==null) {
                 in_telephone="0";
              }
	      if (in_telephone.equals("")) {
                 in_telephone="0";
              }

                out_email=in_mail;
               // postOfficeBox
               Attribute cn = new BasicAttribute("cn", in_cn_user);

 		Attribute samacc = new BasicAttribute("samAccountName", in_samAccountName);

		Attribute sn = new BasicAttribute("sn", in_sn); // mandatory attribute

                //Attribute mail = new BasicAttribute("mail", in_mail); 30sep16 se quita

                Attribute phone = new BasicAttribute("telephoneNumber", in_telephone);
                Attribute employeeid = new BasicAttribute("employeeid", in_employeeid);

                Attribute employeeid1 = new BasicAttribute("givenName", in_givenname);
                Attribute employeeid2 = new BasicAttribute("displayName", in_displayname);
                Attribute employeeid3 = new BasicAttribute("employeeNumber", in_employeenumber);
                Attribute employeeid4 = new BasicAttribute("employeeType", in_employetype);
                Attribute employeeid5 = new BasicAttribute("userPrincipalName", in_userprincipalname);
                Attribute employeeid6 = new BasicAttribute("departmentNumber", in_departamentnumber);
                Attribute employeeid7 = new BasicAttribute("l", in_location);
                Attribute employeeid8 = new BasicAttribute("title", in_title);
                Attribute employeeid9 = new BasicAttribute("physicaldeliveryOfficeName", in_physicaldeliveryofficename);
                Attribute employeeid10 = new BasicAttribute("department", in_departament);
                Attribute employeeid11 = new BasicAttribute("company", in_company);
                Attribute employeeid12 = new BasicAttribute("description", in_description);
                Attribute employeeid13 = new BasicAttribute("info", in_info);
                Attribute employeeid14 = new BasicAttribute("middleName",in_complete_name);
                Attribute employeeid15 = new BasicAttribute("name", in_name);

                Attribute employeeid16 = null;
                if (manager_cn!=null  &amp;&amp; !manager_cn.isEmpty()  &amp;&amp; !manager_cn.equals("")) {
                   employeeid16 = new BasicAttribute("manager", manager_cn);
                }
               //some useful constants from lmaccess.h
               //int UF_ACCOUNTDISABLE = 0x0002;
               //int UF_PASSWD_NOTREQD = 0x0020;
               //int UF_PASSWD_CANT_CHANGE = 0x0040;
               //int UF_NORMAL_ACCOUNT = 0x0200;
               //int UF_DONT_EXPIRE_PASSWD = 0x10000;
               //int UF_PASSWORD_EXPIRED = 0x800000;
 
                  //attrs.put("userAccountControl",Integer.toString(UF_NORMAL_ACCOUNT + UF_PASSWD_NOTREQD + UF_PASSWORD_EXPIRED+ UF_ACCOUNTDISABLE));
                  //Attribute useraccountcontrol = new BasicAttribute("userAccountControl", Integer.toString(512+32));

                Attribute useraccountcontrol = new BasicAttribute("userAccountControl", Integer.toString(in_useraccountcontrol));
                String newQuotedPassword = "\""+in_password+"\"";
                byte[] newUnicodePassword = newQuotedPassword.getBytes("UTF-16LE");
 
                Attribute passworduser = new BasicAttribute("unicodePwd", newUnicodePassword);

 		Attribute oc = new BasicAttribute("objectClass");
 		oc.add("top");
 		oc.add("person");
 		oc.add("organizationalPerson");
 		oc.add("user");



 		// build the entry
 		Attributes entry = new BasicAttributes();

 		entry.put(cn);
                entry.put(samacc);
 		entry.put(sn);
 		//entry.put(mail); 30sep16 se quita
 		entry.put(phone);
                entry.put(employeeid);

                entry.put(oc);
                entry.put(employeeid1);
                entry.put(employeeid2);
                entry.put(employeeid3);
                entry.put(employeeid4);
                entry.put(employeeid5);

                entry.put(employeeid6);
                entry.put(employeeid7);
                entry.put(employeeid8);
                entry.put(employeeid9);
                entry.put(employeeid10);
                entry.put(employeeid11);
                entry.put(employeeid12);
                entry.put(employeeid13);
                entry.put(employeeid14);
                entry.put(employeeid15);
                if (employeeid16!=null) {
                   entry.put(employeeid16);
                }
                if (poBoxData.contains(jobCode) || poBoxData.contains("TTT") ) {
                   Attribute addAtr01 = new BasicAttribute("postOfficeBox", in_samAccountName);
                   entry.put(addAtr01);
                   
                }
                //entry.put(employeeid16);
                entry.put(useraccountcontrol);

                //   EsteCodigo debe reacticrase
                entry.put(passworduser);
                

 		// Add the entry
                String entryDN=in_entry_dn;
                ldapContext.createSubcontext(entryDN, entry);

              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_error</fieldName>
                    <fieldType>int</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_email</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_entry_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_mail</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_telephone</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_useraccountcontrol</fieldName>
                    <fieldType>int</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_givenname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_displayname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeenumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employetype</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_userprincipalname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_departamentnumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_location</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_title</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_physicaldeliveryofficename</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_departament</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_company</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_description</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_info</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_name</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_complete_name</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_password</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_certi_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>poBoxData</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>jobCode</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>manager_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>optional</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Employee_LDAP</name>
                    <byteCode>yv66vgAAADMBtAkAfAERCQB8ARIJAHwBEwkAfAEUCQB8ARUJAHwBFgkAfAEXCQB8ARgJAHwBGQkAfAEaCQB8ARsJAHwBHAkAfAEdCQB8AR4JAHwBHwkAfAEgCQB8ASEJAHwBIgkAfAEjCQB8ASQJAHwBJQkAfAEmCQB8AScJAHwBKAkAfAEpCQB8ASoJAHwBKwkAfAEsCQB8AS0JAHwBLgkAfAEvCQB8ATAJAHwBMQkAfAEyCQB8ATMJAHwBNAkAfAE1CQB8ATYJAHwBNwoAfQE4CAE5BwE6CgAqATsIATwKAT0BPggBPwoBQAFBCAFCBwFDCgAxATgIAUQKADEBRQgBRggBRwoAMQFICgAqAUkIAUoIAUsIAUwIAU0IAU4IAU8IAVAIAVEIAVIKAVMBVAgBVQgBVgcBVwoARQFYCAFZCAFaBwFbCAFcCgBJAV0IAV4IAV8IAWAIAWEIAWIIAWMIAWQIAWUIAWYIAWcIAWgIAWkIAWoIAWsIAWwIAW0IAW4IAW8IAXAKAT0BcQgBcggBcwoBdAF1CAF2CAF3CgE9AXgIAXkIAXoKAEkBewgBfAsBfQF+CAF/CAGACAGBBwGCCgBuATgLAYMBhAoBPQGFCAGGCAGHCwGIAYkLAYgBigoAfAGLCgB8AYwIAY0KADEBewoBdAGOCAGPBwGQBwGRAQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQALaW5fZW50cnlfZG4BAAppbl9jbl91c2VyAQARaW5fc2FtQWNjb3VudE5hbWUBAAVpbl9zbgEAB2luX21haWwBAAxpbl90ZWxlcGhvbmUBABVpbl91c2VyYWNjb3VudGNvbnRyb2wBAAFJAQAMaW5fZ2l2ZW5uYW1lAQAOaW5fZGlzcGxheW5hbWUBABFpbl9lbXBsb3llZW51bWJlcgEADmluX2VtcGxveWV0eXBlAQAUaW5fdXNlcnByaW5jaXBhbG5hbWUBABRpbl9kZXBhcnRhbWVudG51bWJlcgEAC2luX2xvY2F0aW9uAQAIaW5fdGl0bGUBAB1pbl9waHlzaWNhbGRlbGl2ZXJ5b2ZmaWNlbmFtZQEADmluX2RlcGFydGFtZW50AQAKaW5fY29tcGFueQEADmluX2Rlc2NyaXB0aW9uAQAHaW5faW5mbwEAB2luX25hbWUBABBpbl9jb21wbGV0ZV9uYW1lAQALaW5fcGFzc3dvcmQBAAxpbl9jZXJ0aV9sb2MBAAlwb0JveERhdGEBAAdqb2JDb2RlAQAKbWFuYWdlcl9jbgEACG91dF9ndWlkAQAGb3V0X2RuAQAGb3V0X2NuAQASb3V0X3NhbUFjY291bnROYW1lAQAJb3V0X2Vycm9yAQAJb3V0X2VtYWlsAQAMZ2V0aW5fdXNlckROAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQAMc2V0aW5fdXNlckROAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAUZ2V0aW5fc0FNQWNjb3VudE5hbWUBABRzZXRpbl9zQU1BY2NvdW50TmFtZQEADGdldGluX3NlcnZlcgEADHNldGluX3NlcnZlcgEACmdldGluX3BvcnQBAApzZXRpbl9wb3J0AQAIZ2V0aW5fZG4BAAhzZXRpbl9kbgEAEGdldGluX2VtcGxveWVlaWQBABBzZXRpbl9lbXBsb3llZWlkAQAOZ2V0aW5fZW50cnlfZG4BAA5zZXRpbl9lbnRyeV9kbgEADWdldGluX2NuX3VzZXIBAA1zZXRpbl9jbl91c2VyAQAUZ2V0aW5fc2FtQWNjb3VudE5hbWUBABRzZXRpbl9zYW1BY2NvdW50TmFtZQEACGdldGluX3NuAQAIc2V0aW5fc24BAApnZXRpbl9tYWlsAQAKc2V0aW5fbWFpbAEAD2dldGluX3RlbGVwaG9uZQEAD3NldGluX3RlbGVwaG9uZQEAGGdldGluX3VzZXJhY2NvdW50Y29udHJvbAEAAygpSQEAGHNldGluX3VzZXJhY2NvdW50Y29udHJvbAEABChJKVYBAA9nZXRpbl9naXZlbm5hbWUBAA9zZXRpbl9naXZlbm5hbWUBABFnZXRpbl9kaXNwbGF5bmFtZQEAEXNldGluX2Rpc3BsYXluYW1lAQAUZ2V0aW5fZW1wbG95ZWVudW1iZXIBABRzZXRpbl9lbXBsb3llZW51bWJlcgEAEWdldGluX2VtcGxveWV0eXBlAQARc2V0aW5fZW1wbG95ZXR5cGUBABdnZXRpbl91c2VycHJpbmNpcGFsbmFtZQEAF3NldGluX3VzZXJwcmluY2lwYWxuYW1lAQAXZ2V0aW5fZGVwYXJ0YW1lbnRudW1iZXIBABdzZXRpbl9kZXBhcnRhbWVudG51bWJlcgEADmdldGluX2xvY2F0aW9uAQAOc2V0aW5fbG9jYXRpb24BAAtnZXRpbl90aXRsZQEAC3NldGluX3RpdGxlAQAgZ2V0aW5fcGh5c2ljYWxkZWxpdmVyeW9mZmljZW5hbWUBACBzZXRpbl9waHlzaWNhbGRlbGl2ZXJ5b2ZmaWNlbmFtZQEAEWdldGluX2RlcGFydGFtZW50AQARc2V0aW5fZGVwYXJ0YW1lbnQBAA1nZXRpbl9jb21wYW55AQANc2V0aW5fY29tcGFueQEAEWdldGluX2Rlc2NyaXB0aW9uAQARc2V0aW5fZGVzY3JpcHRpb24BAApnZXRpbl9pbmZvAQAKc2V0aW5faW5mbwEACmdldGluX25hbWUBAApzZXRpbl9uYW1lAQATZ2V0aW5fY29tcGxldGVfbmFtZQEAE3NldGluX2NvbXBsZXRlX25hbWUBAA5nZXRpbl9wYXNzd29yZAEADnNldGluX3Bhc3N3b3JkAQAPZ2V0aW5fY2VydGlfbG9jAQAPc2V0aW5fY2VydGlfbG9jAQAMZ2V0cG9Cb3hEYXRhAQAMc2V0cG9Cb3hEYXRhAQAKZ2V0am9iQ29kZQEACnNldGpvYkNvZGUBAA1nZXRtYW5hZ2VyX2NuAQANc2V0bWFuYWdlcl9jbgEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAAxnZXRvdXRfZXJyb3IBAAxzZXRvdXRfZXJyb3IBAAxnZXRvdXRfZW1haWwBAAxzZXRvdXRfZW1haWwBAAY8aW5pdD4BAAMoKVYBAAZpbnZva2UBAA1TdGFja01hcFRhYmxlBwE6BwGQBwGSBwGTBwGUBwGVBwGWAQAKRXhjZXB0aW9ucwcBlwEAFmNvbnZlcnRUb0JpbmRpbmdTdHJpbmcBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAVY29udmVydFRvRGFzaGVkU3RyaW5nAQALcHJlZml4WmVyb3MBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBABNjb252ZXJ0VG9CeXRlU3RyaW5nBwFDAQAKU291cmNlRmlsZQEAREVtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NBZGRfRW1wbG95ZWVfTERBUC5qYXZhDAB+AH8MAIAAfwwAgQB/DACCAH8MAIMAfwwAhAB/DACFAH8MAIYAfwwAhwB/DACIAH8MAIkAfwwAigB/DACLAIwMAI0AfwwAjgB/DACPAH8MAJAAfwwAkQB/DACSAH8MAJMAfwwAlAB/DACVAH8MAJYAfwwAlwB/DACYAH8MAJkAfwwAmgB/DACbAH8MAJwAfwwAnQB/DACeAH8MAJ8AfwwAoAB/DAChAH8MAKIAfwwAowB/DACkAH8MAKUAjAwApgB/DAD7APwBAAABABNqYXZhL3V0aWwvSGFzaHRhYmxlDAD7AMYBAAM2MzYHAZQMAZgBmQEAGGphdmF4Lm5ldC5zc2wudHJ1c3RTdG9yZQcBmgwBmwGcAQAYamF2YS5uYW1pbmcucHJvdmlkZXIudXJsAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAdsZGFwOi8vDAGdAZ4BAAE6AQADMzg5DAGfAKgMAaABoQEAG2phdmEubmFtaW5nLmZhY3RvcnkuaW5pdGlhbAEAIGNvbS5zdW4uam5kaS5sZGFwLkxkYXBDdHhGYWN0b3J5AQAdamF2YS5uYW1pbmcuc2VjdXJpdHkucHJvdG9jb2wBAANzc2wBACNqYXZhLm5hbWluZy5zZWN1cml0eS5hdXRoZW50aWNhdGlvbgEABnNpbXBsZQEAHmphdmEubmFtaW5nLnNlY3VyaXR5LnByaW5jaXBhbAEAIGphdmEubmFtaW5nLnNlY3VyaXR5LmNyZWRlbnRpYWxzAQAtdGliY28uY2xpZW50VmFyLkNvbm5lY3Rpb25zL0xEQVAvSW50ZXJuby9QYXNzBwGiDAGjAaQBACJqYXZhLm5hbWluZy5sZGFwLmF0dHJpYnV0ZXMuYmluYXJ5AQAKb2JqZWN0R1VJRAEAKGphdmF4L25hbWluZy9kaXJlY3RvcnkvSW5pdGlhbERpckNvbnRleHQMAPsBpQEAASABAAEwAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9CYXNpY0F0dHJpYnV0ZQEAAmNuDAD7AaYBAA5zYW1BY2NvdW50TmFtZQEAAnNuAQAPdGVsZXBob25lTnVtYmVyAQAKZW1wbG95ZWVpZAEACWdpdmVuTmFtZQEAC2Rpc3BsYXlOYW1lAQAOZW1wbG95ZWVOdW1iZXIBAAxlbXBsb3llZVR5cGUBABF1c2VyUHJpbmNpcGFsTmFtZQEAEGRlcGFydG1lbnROdW1iZXIBAAFsAQAFdGl0bGUBABpwaHlzaWNhbGRlbGl2ZXJ5T2ZmaWNlTmFtZQEACmRlcGFydG1lbnQBAAdjb21wYW55AQALZGVzY3JpcHRpb24BAARpbmZvAQAKbWlkZGxlTmFtZQEABG5hbWUMAacBqAEAB21hbmFnZXIBABJ1c2VyQWNjb3VudENvbnRyb2wHAakMAZ8BDAEAASIBAAhVVEYtMTZMRQwBqgGrAQAKdW5pY29kZVB3ZAEAC29iamVjdENsYXNzDAD7AKwBAAN0b3AHAZMMAawBmQEABnBlcnNvbgEAFG9yZ2FuaXphdGlvbmFsUGVyc29uAQAEdXNlcgEAJmphdmF4L25hbWluZy9kaXJlY3RvcnkvQmFzaWNBdHRyaWJ1dGVzBwGWDAGgAa0MAa4BrwEAA1RUVAEADXBvc3RPZmZpY2VCb3gHAZIMAbABsQwBsgD8DAEKAQkMAQsBDAEAAS0MAbMBDAEAAVwBAKlQZW9wbGVTb2Z0SWRlbnRpdHlNYW5hZ2VtZW50TVgvRW1wbG95ZWVfUGVvcGxlU29mdF9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzc0FkZF9FbXBsb3llZV9MREFQAQAQamF2YS9sYW5nL09iamVjdAEAIWphdmF4L25hbWluZy9kaXJlY3RvcnkvRGlyQ29udGV4dAEAIGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlAQAQamF2YS9sYW5nL1N0cmluZwEAAltCAQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGVzAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAEGphdmEvbGFuZy9TeXN0ZW0BAAtzZXRQcm9wZXJ0eQEAOChMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAdpc0VtcHR5AQADKClaAQARamF2YS9sYW5nL0ludGVnZXIBAAhnZXRCeXRlcwEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAANhZGQBAEYoTGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlOylMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGU7AQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBABBjcmVhdGVTdWJjb250ZXh0AQBaKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0F0dHJpYnV0ZXM7KUxqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQ7AQAFY2xvc2UBAAt0b0hleFN0cmluZwAhAHwAfQAAACcABAB+AH8AAAAEAIAAfwAAAAQAgQB/AAAABACCAH8AAAAEAIMAfwAAAAQAhAB/AAAABACFAH8AAAAEAIYAfwAAAAQAhwB/AAAABACIAH8AAAAEAIkAfwAAAAQAigB/AAAABACLAIwAAAAEAI0AfwAAAAQAjgB/AAAABACPAH8AAAAEAJAAfwAAAAQAkQB/AAAABACSAH8AAAAEAJMAfwAAAAQAlAB/AAAABACVAH8AAAAEAJYAfwAAAAQAlwB/AAAABACYAH8AAAAEAJkAfwAAAAQAmgB/AAAABACbAH8AAAAEAJwAfwAAAAQAnQB/AAAABACeAH8AAAAEAJ8AfwAAAAQAoAB/AAAABAChAH8AAAAEAKIAfwAAAAQAowB/AAAABACkAH8AAAAEAKUAjAAAAAQApgB/AAAAVAABAKcAqAABAKkAAAAdAAEAAQAAAAUqtAABsAAAAAEAqgAAAAYAAQAAADoAAQCrAKwAAQCpAAAAIgACAAIAAAAGKiu1AAGxAAAAAQCqAAAACgACAAAAPQAFAD4AAQCtAKgAAQCpAAAAHQABAAEAAAAFKrQAArAAAAABAKoAAAAGAAEAAABAAAEArgCsAAEAqQAAACIAAgACAAAABiortQACsQAAAAEAqgAAAAoAAgAAAEMABQBEAAEArwCoAAEAqQAAAB0AAQABAAAABSq0AAOwAAAAAQCqAAAABgABAAAARgABALAArAABAKkAAAAiAAIAAgAAAAYqK7UAA7EAAAABAKoAAAAKAAIAAABJAAUASgABALEAqAABAKkAAAAdAAEAAQAAAAUqtAAEsAAAAAEAqgAAAAYAAQAAAEwAAQCyAKwAAQCpAAAAIgACAAIAAAAGKiu1AASxAAAAAQCqAAAACgACAAAATwAFAFAAAQCzAKgAAQCpAAAAHQABAAEAAAAFKrQABbAAAAABAKoAAAAGAAEAAABSAAEAtACsAAEAqQAAACIAAgACAAAABiortQAFsQAAAAEAqgAAAAoAAgAAAFUABQBWAAEAtQCoAAEAqQAAAB0AAQABAAAABSq0AAawAAAAAQCqAAAABgABAAAAWAABALYArAABAKkAAAAiAAIAAgAAAAYqK7UABrEAAAABAKoAAAAKAAIAAABbAAUAXAABALcAqAABAKkAAAAdAAEAAQAAAAUqtAAHsAAAAAEAqgAAAAYAAQAAAF4AAQC4AKwAAQCpAAAAIgACAAIAAAAGKiu1AAexAAAAAQCqAAAACgACAAAAYQAFAGIAAQC5AKgAAQCpAAAAHQABAAEAAAAFKrQACLAAAAABAKoAAAAGAAEAAABkAAEAugCsAAEAqQAAACIAAgACAAAABiortQAIsQAAAAEAqgAAAAoAAgAAAGcABQBoAAEAuwCoAAEAqQAAAB0AAQABAAAABSq0AAmwAAAAAQCqAAAABgABAAAAagABALwArAABAKkAAAAiAAIAAgAAAAYqK7UACbEAAAABAKoAAAAKAAIAAABtAAUAbgABAL0AqAABAKkAAAAdAAEAAQAAAAUqtAAKsAAAAAEAqgAAAAYAAQAAAHAAAQC+AKwAAQCpAAAAIgACAAIAAAAGKiu1AAqxAAAAAQCqAAAACgACAAAAcwAFAHQAAQC/AKgAAQCpAAAAHQABAAEAAAAFKrQAC7AAAAABAKoAAAAGAAEAAAB2AAEAwACsAAEAqQAAACIAAgACAAAABiortQALsQAAAAEAqgAAAAoAAgAAAHkABQB6AAEAwQCoAAEAqQAAAB0AAQABAAAABSq0AAywAAAAAQCqAAAABgABAAAAfAABAMIArAABAKkAAAAiAAIAAgAAAAYqK7UADLEAAAABAKoAAAAKAAIAAAB/AAUAgAABAMMAxAABAKkAAAAdAAEAAQAAAAUqtAANrAAAAAEAqgAAAAYAAQAAAIIAAQDFAMYAAQCpAAAAIgACAAIAAAAGKhu1AA2xAAAAAQCqAAAACgACAAAAhQAFAIYAAQDHAKgAAQCpAAAAHQABAAEAAAAFKrQADrAAAAABAKoAAAAGAAEAAACIAAEAyACsAAEAqQAAACIAAgACAAAABiortQAOsQAAAAEAqgAAAAoAAgAAAIsABQCMAAEAyQCoAAEAqQAAAB0AAQABAAAABSq0AA+wAAAAAQCqAAAABgABAAAAjgABAMoArAABAKkAAAAiAAIAAgAAAAYqK7UAD7EAAAABAKoAAAAKAAIAAACRAAUAkgABAMsAqAABAKkAAAAdAAEAAQAAAAUqtAAQsAAAAAEAqgAAAAYAAQAAAJQAAQDMAKwAAQCpAAAAIgACAAIAAAAGKiu1ABCxAAAAAQCqAAAACgACAAAAlwAFAJgAAQDNAKgAAQCpAAAAHQABAAEAAAAFKrQAEbAAAAABAKoAAAAGAAEAAACaAAEAzgCsAAEAqQAAACIAAgACAAAABiortQARsQAAAAEAqgAAAAoAAgAAAJ0ABQCeAAEAzwCoAAEAqQAAAB0AAQABAAAABSq0ABKwAAAAAQCqAAAABgABAAAAoAABANAArAABAKkAAAAiAAIAAgAAAAYqK7UAErEAAAABAKoAAAAKAAIAAACjAAUApAABANEAqAABAKkAAAAdAAEAAQAAAAUqtAATsAAAAAEAqgAAAAYAAQAAAKYAAQDSAKwAAQCpAAAAIgACAAIAAAAGKiu1ABOxAAAAAQCqAAAACgACAAAAqQAFAKoAAQDTAKgAAQCpAAAAHQABAAEAAAAFKrQAFLAAAAABAKoAAAAGAAEAAACsAAEA1ACsAAEAqQAAACIAAgACAAAABiortQAUsQAAAAEAqgAAAAoAAgAAAK8ABQCwAAEA1QCoAAEAqQAAAB0AAQABAAAABSq0ABWwAAAAAQCqAAAABgABAAAAsgABANYArAABAKkAAAAiAAIAAgAAAAYqK7UAFbEAAAABAKoAAAAKAAIAAAC1AAUAtgABANcAqAABAKkAAAAdAAEAAQAAAAUqtAAWsAAAAAEAqgAAAAYAAQAAALgAAQDYAKwAAQCpAAAAIgACAAIAAAAGKiu1ABaxAAAAAQCqAAAACgACAAAAuwAFALwAAQDZAKgAAQCpAAAAHQABAAEAAAAFKrQAF7AAAAABAKoAAAAGAAEAAAC+AAEA2gCsAAEAqQAAACIAAgACAAAABiortQAXsQAAAAEAqgAAAAoAAgAAAMEABQDCAAEA2wCoAAEAqQAAAB0AAQABAAAABSq0ABiwAAAAAQCqAAAABgABAAAAxAABANwArAABAKkAAAAiAAIAAgAAAAYqK7UAGLEAAAABAKoAAAAKAAIAAADHAAUAyAABAN0AqAABAKkAAAAdAAEAAQAAAAUqtAAZsAAAAAEAqgAAAAYAAQAAAMoAAQDeAKwAAQCpAAAAIgACAAIAAAAGKiu1ABmxAAAAAQCqAAAACgACAAAAzQAFAM4AAQDfAKgAAQCpAAAAHQABAAEAAAAFKrQAGrAAAAABAKoAAAAGAAEAAADQAAEA4ACsAAEAqQAAACIAAgACAAAABiortQAasQAAAAEAqgAAAAoAAgAAANMABQDUAAEA4QCoAAEAqQAAAB0AAQABAAAABSq0ABuwAAAAAQCqAAAABgABAAAA1gABAOIArAABAKkAAAAiAAIAAgAAAAYqK7UAG7EAAAABAKoAAAAKAAIAAADZAAUA2gABAOMAqAABAKkAAAAdAAEAAQAAAAUqtAAcsAAAAAEAqgAAAAYAAQAAANwAAQDkAKwAAQCpAAAAIgACAAIAAAAGKiu1AByxAAAAAQCqAAAACgACAAAA3wAFAOAAAQDlAKgAAQCpAAAAHQABAAEAAAAFKrQAHbAAAAABAKoAAAAGAAEAAADiAAEA5gCsAAEAqQAAACIAAgACAAAABiortQAdsQAAAAEAqgAAAAoAAgAAAOUABQDmAAEA5wCoAAEAqQAAAB0AAQABAAAABSq0AB6wAAAAAQCqAAAABgABAAAA6AABAOgArAABAKkAAAAiAAIAAgAAAAYqK7UAHrEAAAABAKoAAAAKAAIAAADrAAUA7AABAOkAqAABAKkAAAAdAAEAAQAAAAUqtAAfsAAAAAEAqgAAAAYAAQAAAO4AAQDqAKwAAQCpAAAAIgACAAIAAAAGKiu1AB+xAAAAAQCqAAAACgACAAAA8QAFAPIAAQDrAKgAAQCpAAAAHQABAAEAAAAFKrQAILAAAAABAKoAAAAGAAEAAAD0AAEA7ACsAAEAqQAAACIAAgACAAAABiortQAgsQAAAAEAqgAAAAoAAgAAAPcABQD4AAEA7QCoAAEAqQAAAB0AAQABAAAABSq0ACGwAAAAAQCqAAAABgABAAAA+gABAO4ArAABAKkAAAAiAAIAAgAAAAYqK7UAIbEAAAABAKoAAAAKAAIAAAD9AAUA/gABAO8AqAABAKkAAAAdAAEAAQAAAAUqtAAisAAAAAEAqgAAAAYAAQAAAQAAAQDwAKwAAQCpAAAAIgACAAIAAAAGKiu1ACKxAAAAAQCqAAAACgACAAABAwAFAQQAAQDxAKgAAQCpAAAAHQABAAEAAAAFKrQAI7AAAAABAKoAAAAGAAEAAAEGAAEA8gCsAAEAqQAAACIAAgACAAAABiortQAjsQAAAAEAqgAAAAoAAgAAAQkABQEKAAEA8wCoAAEAqQAAAB0AAQABAAAABSq0ACSwAAAAAQCqAAAABgABAAABDAABAPQArAABAKkAAAAiAAIAAgAAAAYqK7UAJLEAAAABAKoAAAAKAAIAAAEPAAUBEAABAPUAqAABAKkAAAAdAAEAAQAAAAUqtAAlsAAAAAEAqgAAAAYAAQAAARIAAQD2AKwAAQCpAAAAIgACAAIAAAAGKiu1ACWxAAAAAQCqAAAACgACAAABFQAFARYAAQD3AMQAAQCpAAAAHQABAAEAAAAFKrQAJqwAAAABAKoAAAAGAAEAAAEYAAEA+ADGAAEAqQAAACIAAgACAAAABiobtQAmsQAAAAEAqgAAAAoAAgAAARsABQEcAAEA+QCoAAEAqQAAAB0AAQABAAAABSq0ACewAAAAAQCqAAAABgABAAABHgABAPoArAABAKkAAAAiAAIAAgAAAAYqK7UAJ7EAAAABAKoAAAAKAAIAAAEhAAUBIgABAPsA/AABAKkAAAGlAAIAAQAAAO0qtwAoKhIptQABKhIptQACKhIptQADKhIptQAEKhIptQAFKhIptQAGKhIptQAHKhIptQAIKhIptQAJKhIptQAKKhIptQALKhIptQAMKgO1AA0qEim1AA4qEim1AA8qEim1ABAqEim1ABEqEim1ABIqEim1ABMqEim1ABQqEim1ABUqEim1ABYqEim1ABcqEim1ABgqEim1ABkqEim1ABoqEim1ABsqEim1ABwqEim1AB0qEim1AB4qEim1AB8qEim1ACAqEim1ACEqEim1ACIqEim1ACMqEim1ACQqEim1ACUqA7UAJioSKbUAJ7EAAAABAKoAAACmACkAAAEkAAQAEgAKABMAEAAUABYAFQAcABYAIgAXACgAGAAuABkANAAaADoAGwBAABwARgAdAEwAHgBRAB8AVwAgAF0AIQBjACIAaQAjAG8AJAB1ACUAewAmAIEAJwCHACgAjQApAJMAKgCZACsAnwAsAKUALQCrAC4AsQAvALcAMAC9ADEAwwAyAMkAMwDPADQA1QA1ANsANgDhADcA5gA4AOwBJQABAP0A/AACAKkAAAaiAAQAHwAABE27ACpZEAu3ACtNKrQABBIstgAtmQASKrQAHk4SLi24AC9XpwAqLBIwuwAxWbcAMhIztgA0KrQAA7YANBI1tgA0Eja2ADS2ADe2ADhXLBI5Ejq2ADhXKrQABBIstgAtmQA2LBI7Ejy2ADhXLBIwuwAxWbcAMhIztgA0KrQAA7YANBI1tgA0Eiy2ADS2ADe2ADhXpwAqLBIwuwAxWbcAMhIztgA0KrQAA7YANBI1tgA0Eja2ADS2ADe2ADhXLBI9Ej62ADhXLBI/KrQAAbYAOFcsEkASQbgAQrYAOFcsEkMSRLYAOFe7AEVZLLcARkwqtAALEim2AC2ZAAkqEke1AAsqtAALxwAJKhJHtQALKrQADMcACSoSSLUADCq0AAwSKbYALZkACSoSSLUADCoqtAALtQAnuwBJWRJKKrQACLcAS067AElZEkwqtAAJtwBLOgS7AElZEk0qtAAKtwBLOgW7AElZEk4qtAAMtwBLOga7AElZEk8qtAAGtwBLOge7AElZElAqtAAOtwBLOgi7AElZElEqtAAPtwBLOgm7AElZElIqtAAQtwBLOgq7AElZElMqtAARtwBLOgu7AElZElQqtAAStwBLOgy7AElZElUqtAATtwBLOg27AElZElYqtAAUtwBLOg67AElZElcqtAAVtwBLOg+7AElZElgqtAAWtwBLOhC7AElZElkqtAAXtwBLOhG7AElZEloqtAAYtwBLOhK7AElZElsqtAAZtwBLOhO7AElZElwqtAAatwBLOhS7AElZEl0qtAActwBLOhW7AElZEl4qtAAbtwBLOhYBOhcqtAAhxgAoKrQAIbYAX5oAHiq0ACESKbYALZoAErsASVkSYCq0ACG3AEs6F7sASVkSYSq0AA24AGK3AEs6GLsAMVm3ADISY7YANCq0AB22ADQSY7YANLYANzoZGRkSZLYAZToauwBJWRJmGRq3AEs6G7sASVkSZ7cAaDocGRwSabkAagIAVxkcEmu5AGoCAFcZHBJsuQBqAgBXGRwSbbkAagIAV7sAblm3AG86HRkdLbkAcAIAVxkdGQS5AHACAFcZHRkFuQBwAgBXGR0ZBrkAcAIAVxkdGQe5AHACAFcZHRkcuQBwAgBXGR0ZCLkAcAIAVxkdGQm5AHACAFcZHRkKuQBwAgBXGR0ZC7kAcAIAVxkdGQy5AHACAFcZHRkNuQBwAgBXGR0ZDrkAcAIAVxkdGQ+5AHACAFcZHRkQuQBwAgBXGR0ZEbkAcAIAVxkdGRK5AHACAFcZHRkTuQBwAgBXGR0ZFLkAcAIAVxkdGRW5AHACAFcZHRkWuQBwAgBXGRfGAA0ZHRkXuQBwAgBXKrQAHyq0ACC2AHGaAA8qtAAfEnK2AHGZABy7AElZEnMqtAAJtwBLOh4ZHRkeuQBwAgBXGR0ZGLkAcAIAVxkdGRu5AHACAFcqtAAHOh4rGR4ZHbkAdAMAVyu5AHUBALEAAAACAKoAAAFqAFoAAAFTAAoBVQAWAVYAGwFZACIBWgAlAVsATAFeAFUBYABhAWEAagFiAJQBZAC7AWgAxAFpAM8BagDbAWsA5AFtAO0BcAD5AXEA/wFzAQYBdAEMAXYBEwF3ARkBeQElAXoBKwF9ATMBfwFBAYEBUAGDAV8BhwFuAYgBfQGKAYwBiwGbAYwBqgGNAbkBjgHIAY8B1wGQAeYBkQH1AZICBAGTAhMBlAIiAZUCMQGWAkABlwJPAZgCXgGaAmEBmwJ+AZwCjQGpAp8BqgK8AasCxQGtAtIBrwLdAbAC5wGxAvEBsgL7AbMDBQG4Aw4BugMXAbsDIQG8AysBvgM1Ab8DPwHBA0kBwgNTAcMDXQHEA2cBxQNxAcYDewHIA4UByQOPAcoDmQHLA6MBzAOtAc0DtwHOA8EBzwPLAdAD1QHRA98B0gPkAdMD7gHVBAgB1gQXAdcEIQHbBCsB3gQ1AeIEOwHjBEYB5wRMAegA/gAAANMADP0AJQAHAP8m+wBHJv8AQwADBwEABwEBBwD/AAAMDBH/AWEAGAcBAAcBAQcA/wcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgcBAgAA/wFgAB4HAQAHAQEHAP8HAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQIHAQMHAQQHAQIHAQIHAQUAABkYAQYAAAAEAAEBBwAKAQgBCQABAKkAAAA2AAIAAgAAABa7ADFZtwAyTCsquAB2tgA0Vyu2ADewAAAAAQCqAAAADgADAAAB6wAIAe0AEQHvAAoBCgEJAAEAqQAAAY8AAwACAAABI7sAMVm3ADJMKyoGMxEA/364AHe2ADRXKyoFMxEA/364AHe2ADRXKyoEMxEA/364AHe2ADRXKyoDMxEA/364AHe2ADRXKxJ4tgA0VysqCDMRAP9+uAB3tgA0VysqBzMRAP9+uAB3tgA0VysSeLYANFcrKhAHMxEA/364AHe2ADRXKyoQBjMRAP9+uAB3tgA0VysSeLYANFcrKhAIMxEA/364AHe2ADRXKyoQCTMRAP9+uAB3tgA0VysSeLYANFcrKhAKMxEA/364AHe2ADRXKyoQCzMRAP9+uAB3tgA0VysqEAwzEQD/frgAd7YANFcrKhANMxEA/364AHe2ADRXKyoQDjMRAP9+uAB3tgA0VysqEA8zEQD/frgAd7YANFcrtgA3sAAAAAEAqgAAAFoAFgAAAfMACAH1ABcB9gAmAfcANQH4AEQB+QBLAfoAWgH7AGkB/ABwAf0AgAH+AJAB/wCXAgAApwIBALcCAgC+AgMAzgIEAN4CBQDuAgYA/gIHAQ4CCAEeAgoACgELAQwAAQCpAAAAVAADAAIAAAAjGhAPowAbuwAxWRJItwB5TCsauAB6tgA0Vyu2ADewGrgAerAAAAACAKoAAAAWAAUAAAIOAAYCDwAQAhAAGQISAB4CFQD+AAAAAwABHgAKAQ0BCQABAKkAAAB1AAIABAAAADO7ADFZtwAyTAM9HCq+ogAhKhwzEQD/frgAd04rEnu2ADRXKy22ADRXhAIBp//fK7YAN7AAAAACAKoAAAAeAAcAAAIaAAgCHAAQAh0AGwIeACICHwAoAhwALgIiAP4AAAAMAAL9AAoHAQ4B+gAjAAEBDwAAAAIBEA==</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/SecurePort"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_entry_dn>
                    <xsl:value-of select="translate(concat('cn=',$cnUser/cnUser_Value,',', $dnPrincipal/dnToOperate),'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  ')"/>
                </in_entry_dn>
                <in_cn_user>
                    <xsl:value-of select="translate($cnUser/cnUser_Value,'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  ')"/>
                </in_cn_user>
                <in_samAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_samAccountName>
                <in_sn>
                    <xsl:value-of select="translate(translate($Start/pfx7:EMPLOYEE/pfx7:SURNAME,'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  '),'%','')"/>
                </in_sn>
                <in_mail>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMAIL_ADDR"/>
                </in_mail>
                <xsl:choose>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)>0">
                        <in_telephone>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONE"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)=0">
                        <in_telephone>
                            <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre1_Tienda,  substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 4,2),' ',$_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre2_Tienda)"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                        <xsl:choose>
                            <xsl:when test="string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)>0">
                                <in_telephone>
                                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONE"/>
                                </in_telephone>
                            </xsl:when>
                            <xsl:otherwise>
                                <in_telephone>
                                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONEASIG"/>
                                </in_telephone>
                            </xsl:otherwise>
                        </xsl:choose>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_telephone>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONEASIG"/>
                        </in_telephone>
                    </xsl:otherwise>
                </xsl:choose>
                <in_useraccountcontrol>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/userAccountControlInicial"/>
                </in_useraccountcontrol>
                <in_givenname>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:GIVENAME"/>
                </in_givenname>
                <xsl:choose>
                    <xsl:when test="$Search-ID_LDAP-2/javaCodeActivityOutput/out_elements>0">
                        <in_displayname>
                            <xsl:value-of select="concat($Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME,' ', '(',$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID,')')"/>
                        </in_displayname>
                    </xsl:when>
                    <xsl:when test="$Search-ID_LDAP-2/javaCodeActivityOutput/out_elements&lt;=0">
                        <in_displayname>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                        </in_displayname>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_displayname>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                        </in_displayname>
                    </xsl:otherwise>
                </xsl:choose>
                <in_employeenumber>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PRIMARY_NID"/>
                </in_employeenumber>
                <in_employetype>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPLOYEE_TYPE"/>
                </in_employetype>
                <in_userprincipalname>
                    <xsl:value-of select="concat($Map-Data/login,'@ad.heb.com.mx')"/>
                </in_userprincipalname>
                <in_departamentnumber>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DEPT_ID"/>
                </in_departamentnumber>
                <in_location>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:CITY"/>
                </in_location>
                <in_title>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:JOBCODE_DESCR"/>
                </in_title>
                <in_physicaldeliveryofficename>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:LOCATION_DESCR"/>
                </in_physicaldeliveryofficename>
                <in_departament>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DEP_DESCR"/>
                </in_departament>
                <in_company>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:COMPANY_DESCR"/>
                </in_company>
                <in_description>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:JOBCODE_DESCR"/>
                </in_description>
                <in_info>
                    <xsl:value-of select="&quot; &quot;"/>
                </in_info>
                <in_name>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                </in_name>
                <in_complete_name>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:NAME"/>
                </in_complete_name>
                <xsl:choose>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                        <in_password>
                            <xsl:value-of select="concat($Map-Data/login,upper-case($Start/pfx7:EMPLOYEE/pfx7:NATIONAL_ID))"/>
                        </in_password>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_password>
                            <xsl:value-of select="concat($Map-Data/login,upper-case($Start/pfx7:EMPLOYEE/pfx7:NATIONAL_ID))"/>
                        </in_password>
                    </xsl:otherwise>
                </xsl:choose>
                <in_certi_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_certi_loc>
                <poBoxData>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/PoBox_JobCodes"/>
                </poBoxData>
                <jobCode>
                    <xsl:value-of select="concat($Start/pfx7:EMPLOYEE/pfx7:DEPT_ID ,$Start/pfx7:EMPLOYEE/pfx7:JOB_CD)"/>
                </jobCode>
                <manager_cn>
                    <xsl:value-of select="$Search-ID_MANAGER/javaCodeActivityOutput/out_dn"/>
                </manager_cn>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Add_Group_Employee_LDAP">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>898</pd:x>
        <pd:y>133</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Group_Employee_LDAP</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.StringTokenizer;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Group_Employee_LDAP{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String String_To_Remove_Puesto = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getString_To_Remove_Puesto() {
		return String_To_Remove_Puesto;
	}
	public void setString_To_Remove_Puesto(String val) {
		String_To_Remove_Puesto = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Group_Employee_LDAP() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String String_To_Remove_Puesto
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);
              out_result="";
               //in_cn="CN=Gloria Velazquez,OU=Usuarios HEBANCO,DC=ad,DC=heb,DC=com,DC=mx";
               if (!in_cn.equals("")) {
                   
          StringTokenizer tokenizerGroupsbyCodJob;
        if (String_To_Remove_Puesto!=null) {
           if (!String_To_Remove_Puesto.contains("+")) {
              String_To_Remove_Puesto=String_To_Remove_Puesto+"+";
            }
            tokenizerGroupsbyCodJob = new StringTokenizer(String_To_Remove_Puesto,"+");
            String groupNamebyCD="";
            while (tokenizerGroupsbyCodJob.hasMoreElements()) {
                  groupNamebyCD = tokenizerGroupsbyCodJob.nextToken();
                  //System.out.println("Quitar :"+groupNamebyCD);
                  in_Groups_To_Add_user=in_Groups_To_Add_user.replaceAll(groupNamebyCD,"");
                  in_Groups_To_Add_user=in_Groups_To_Add_user.replace("++","+");
            }
            //System.out.println(in_Groups_To_Add_user);
            
            
          }                  

                  if (!in_Groups_To_Add_user.contains("+")) {
                       in_Groups_To_Add_user=in_Groups_To_Add_user+"+";
                  }
               StringTokenizer tokenizerGroups = new StringTokenizer(in_Groups_To_Add_user,"+");
               while (tokenizerGroups.hasMoreElements()) {
                   
                     ModificationItem mods[] = new ModificationItem[1];
                     //.ADD_ATTRIBUTE
                     mods[0]= new ModificationItem(DirContext.ADD_ATTRIBUTE, new BasicAttribute("member", in_cn));
                     //update the group
                     String groupName;
                     
                     groupName = tokenizerGroups.nextToken();
                     if (groupName!=null &amp;&amp; !groupName.equals("")) {
                        
     		        ldapContext.modifyAttributes(groupName,mods);
                        
		     }
               }
               out_result="Success";
              }
	
              ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>String_To_Remove_Puesto</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_Group_Employee_LDAP</name>
                    <byteCode>yv66vgAAADIA6AkAQACECQBAAIUJAEAAhgkAQACHCQBAAIgJAEAAiQkAQACKCQBAAIsJAEAAjAkAQACNCQBAAI4JAEAAjwkAQACQCQBAAJEKAEEAkggAkwcAlAoAEQCVCACWCACXCgARAJgIAJkHAJoKABcAkggAmwoAFwCcCACdCgAXAJ4IAJ8IAKAIAKEIAKIIAKMKAKQApQgApggApwcAqAoAJQCpCgCqAKsIAKwKAKoArQcArgoAKgCvCgAqALAKACoAsQoAqgCyCACzCgCqALQHALUHALYIALcKADIAuAoAMQC5CwC6ALsIALwLALoAvQoAQAC+CgBAAL8IAMAIAMEKABcAwgoAwwDECADFBwDGBwDHAQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQAVaW5fR3JvdXBzX1RvX0FkZF91c2VyAQAFaW5fY24BABdTdHJpbmdfVG9fUmVtb3ZlX1B1ZXN0bwEACG91dF9ndWlkAQAGb3V0X2RuAQAGb3V0X2NuAQASb3V0X3NhbUFjY291bnROYW1lAQAKb3V0X3Jlc3VsdAEADGdldGluX3VzZXJETgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEADHNldGluX3VzZXJETgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAFGdldGluX3NBTUFjY291bnROYW1lAQAUc2V0aW5fc0FNQWNjb3VudE5hbWUBAAxnZXRpbl9zZXJ2ZXIBAAxzZXRpbl9zZXJ2ZXIBAApnZXRpbl9wb3J0AQAKc2V0aW5fcG9ydAEACGdldGluX2RuAQAIc2V0aW5fZG4BABBnZXRpbl9lbXBsb3llZWlkAQAQc2V0aW5fZW1wbG95ZWVpZAEAGGdldGluX0dyb3Vwc19Ub19BZGRfdXNlcgEAGHNldGluX0dyb3Vwc19Ub19BZGRfdXNlcgEACGdldGluX2NuAQAIc2V0aW5fY24BABpnZXRTdHJpbmdfVG9fUmVtb3ZlX1B1ZXN0bwEAGnNldFN0cmluZ19Ub19SZW1vdmVfUHVlc3RvAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcAyAcAlAcArgcAyQEACkV4Y2VwdGlvbnMHAMoBABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAmgEAClNvdXJjZUZpbGUBAEpFbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzQWRkX0dyb3VwX0VtcGxveWVlX0xEQVAuamF2YQwAQgBDDABEAEMMAEUAQwwARgBDDABHAEMMAEgAQwwASQBDDABKAEMMAEsAQwwATABDDABNAEMMAE4AQwwATwBDDABQAEMMAHEAcgEAAAEAE2phdmEvdXRpbC9IYXNodGFibGUMAHEAywEAG2phdmEubmFtaW5nLmZhY3RvcnkuaW5pdGlhbAEAIGNvbS5zdW4uam5kaS5sZGFwLkxkYXBDdHhGYWN0b3J5DADMAM0BABhqYXZhLm5hbWluZy5wcm92aWRlci51cmwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAB2xkYXA6Ly8MAM4AzwEAAToMANAAUgEAI2phdmEubmFtaW5nLnNlY3VyaXR5LmF1dGhlbnRpY2F0aW9uAQAGc2ltcGxlAQAeamF2YS5uYW1pbmcuc2VjdXJpdHkucHJpbmNpcGFsAQAgamF2YS5uYW1pbmcuc2VjdXJpdHkuY3JlZGVudGlhbHMBAC10aWJjby5jbGllbnRWYXIuQ29ubmVjdGlvbnMvTERBUC9JbnRlcm5vL1Bhc3MHANEMANIA0wEAImphdmEubmFtaW5nLmxkYXAuYXR0cmlidXRlcy5iaW5hcnkBAApvYmplY3RHVUlEAQAoamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Jbml0aWFsRGlyQ29udGV4dAwAcQDUBwDJDADVANYBAAErDADXANgBABlqYXZhL3V0aWwvU3RyaW5nVG9rZW5pemVyDABxANkMANoA2wwA3ABSDADdAN4BAAIrKwwA3wDgAQAnamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9CYXNpY0F0dHJpYnV0ZQEABm1lbWJlcgwAcQDhDABxAOIHAMgMAOMA5AEAB1N1Y2Nlc3MMAOUAcgwAfQB8DAB+AH8BAAEtAQABMAwAcQBWBwDmDADnAH8BAAFcAQCvUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NBZGRfR3JvdXBfRW1wbG95ZWVfTERBUAEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABBqYXZhL2xhbmcvU3RyaW5nAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABChJKVYBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQAkY29tL3RpYmNvL3BlL3BsdWdpbi9QbHVnaW5Qcm9wZXJ0aWVzAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAGChMamF2YS91dGlsL0hhc2h0YWJsZTspVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hh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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBEROFF"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="concat('cn=',$cnUser/cnUser_Value,',', $dnPrincipal/dnToOperate)"/>
                </in_cn>
                <String_To_Remove_Puesto>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBER_TOREMOVE_PUESTO"/>
                </String_To_Remove_Puesto>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Add_new_Group_Employee_LDAP">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>630</pd:x>
        <pd:y>245</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_new_Group_Employee_LDAP</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.StringTokenizer;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_new_Group_Employee_LDAP{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String invalidChars = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getinvalidChars() {
		return invalidChars;
	}
	public void setinvalidChars(String val) {
		invalidChars = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_new_Group_Employee_LDAP() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String invalidChars
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

               
               if (!in_cn.equals("")) {
                  if (!in_Groups_To_Add_user.contains("+")) {
                       in_Groups_To_Add_user=in_Groups_To_Add_user+"+";
                  }

               StringTokenizer tokenizerGroups = new StringTokenizer(in_Groups_To_Add_user,"+");
               
               String someChars=invalidChars;
               StringTokenizer someCharsTokenizer = new StringTokenizer(someChars,",");
               String InvalidString = "";
               while (someCharsTokenizer.hasMoreElements()) {
                     InvalidString = InvalidString + someCharsTokenizer.nextToken();
               }

               while (tokenizerGroups.hasMoreElements()) {
                   
                     ModificationItem mods[] = new ModificationItem[1];
                     //mods[0]= new ModificationItem(DirContext.REMOVE_ATTRIBUTE, new BasicAttribute("member", in_cn));
                     mods[0]= new ModificationItem(DirContext.ADD_ATTRIBUTE, new BasicAttribute("member", in_cn));

                     //update the group
                     String groupName;
                    
                     groupName = tokenizerGroups.nextToken();
                     if (groupName!=null ) {
         		//if (!groupName.equals("")) {
                         // ldapContext.modifyAttributes(groupName,mods);
                        //}

                          boolean agregarEspecial = false;
		          if (!groupName.equals("")) {
                              for (int j=0 ;j&lt;InvalidString.length();j++) {
                              if (groupName.contains(InvalidString.substring(j,j+1))) {
                                  agregarEspecial = true;
                              }
                              }
                              if (agregarEspecial) {
                     	         groupName="'"+groupName+"'";
                              } 
                             
                              ldapContext.modifyAttributes(groupName,mods);
                              
                              //}
                              
       		          }
                 }
               }
              }
	
              ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>invalidChars</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_new_Group_Employee_LDAP</name>
                    <byteCode>yv66vgAAADIA6wkAQACGCQBAAIcJAEAAiAkAQACJCQBAAIoJAEAAiwkAQACMCQBAAI0JAEAAjgkAQACPCQBAAJAJAEAAkQkAQACSCQBAAJMKAEEAlAgAlQcAlgoAEQCXCACYCACZCgARAJoIAJsHAJwKABcAlAgAnQoAFwCeCACfCgAXAKAIAKEIAKIIAKMIAKQIAKUKAKYApwgAqAgAqQcAqgoAJQCrCgCsAK0IAK4KAKwArwcAsAoAKgCxCACyCgAqALMKACoAtAcAtQcAtggAtwoAMAC4CgAvALkKAKwAugoArAC7CAC8CwC9AL4LAL0AvwoAQADACgBAAMEIAMIIAMMKABcAxAoAxQDGCADHBwDIBwDJAQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQAVaW5fR3JvdXBzX1RvX0FkZF91c2VyAQAFaW5fY24BAAxpbnZhbGlkQ2hhcnMBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBABhnZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBABhzZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBAAhnZXRpbl9jbgEACHNldGluX2NuAQAPZ2V0aW52YWxpZENoYXJzAQAPc2V0aW52YWxpZENoYXJzAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcAygcAlgcAyAcAsAcAywcAzAEACkV4Y2VwdGlvbnMHAM0BABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAnAEAClNvdXJjZUZpbGUBAE5FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzQWRkX25ld19Hcm91cF9FbXBsb3llZV9MREFQLmphdmEMAEIAQwwARABDDABFAEMMAEYAQwwARwBDDABIAEMMAEkAQwwASgBDDABLAEMMAEwAQwwATQBDDABOAEMMAE8AQwwAUABDDABxAHIBAAABABNqYXZhL3V0aWwvSGFzaHRhYmxlDABxAM4BABtqYXZhLm5hbWluZy5mYWN0b3J5LmluaXRpYWwBACBjb20uc3VuLmpuZGkubGRhcC5MZGFwQ3R4RmFjdG9yeQwAzwDQAQAYamF2YS5uYW1pbmcucHJvdmlkZXIudXJsAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAdsZGFwOi8vDADRANIBAAE6DADTAFIBACNqYXZhLm5hbWluZy5zZWN1cml0eS5hdXRoZW50aWNhdGlvbgEABnNpbXBsZQEAHmphdmEubmFtaW5nLnNlY3VyaXR5LnByaW5jaXBhbAEAIGphdmEubmFtaW5nLnNlY3VyaXR5LmNyZWRlbnRpYWxzAQAtdGliY28uY2xpZW50VmFyLkNvbm5lY3Rpb25zL0xEQVAvSW50ZXJuby9QYXNzBwDUDADVANYBACJqYXZhLm5hbWluZy5sZGFwLmF0dHJpYnV0ZXMuYmluYXJ5AQAKb2JqZWN0R1VJRAEAKGphdmF4L25hbWluZy9kaXJlY3RvcnkvSW5pdGlhbERpckNvbnRleHQMAHEA1wcAywwA2ADZAQABKwwA2gDbAQAZamF2YS91dGlsL1N0cmluZ1Rva2VuaXplcgwAcQDcAQABLAwA3QDeDADfAFIBACdqYXZheC9uYW1pbmcvZGlyZWN0b3J5L01vZGlmaWNhdGlvbkl0ZW0BACVqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0Jhc2ljQXR0cmlidXRlAQAGbWVtYmVyDABxAOAMAHEA4QwA4gDjDADkAOUBAAEnBwDKDADmAOcMAOgAcgwAfwB+DACAAIEBAAEtAQABMAwAcQBWBwDpDADqAIEBAAFcAQCzUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NBZGRfbmV3X0dyb3VwX0VtcGxveWVlX0xEQVABABBqYXZhL2xhbmcvT2JqZWN0AQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9EaXJDb250ZXh0AQAQamF2YS9sYW5nL1N0cmluZwEAKltMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtOwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAAQoSSlWAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAhjb250YWlu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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="$Proccess_Groups/String_Final_Groups/Groups_To_Add_AD"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_dn"/>
                </in_cn>
                <invalidChars>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/invalidChars"/>
                </invalidChars>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign Alta">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>178</pd:x>
        <pd:y>60</pd:y>
        <config>
            <variableName>Operacion</variableName>
        </config>
        <pd:inputBindings>
            <Operacion_Out>
                <xsl:value-of select="'A'"/>
            </Operacion_Out>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign Baja">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>147</pd:x>
        <pd:y>385</pd:y>
        <config>
            <variableName>Operacion</variableName>
        </config>
        <pd:inputBindings>
            <Operacion_Out>
                <xsl:value-of select="'B'"/>
            </Operacion_Out>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign-Alta-1">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>44</pd:x>
        <pd:y>265</pd:y>
        <config>
            <variableName>dnPrincipal</variableName>
        </config>
        <pd:inputBindings>
            <xsl:choose>
                <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                    <dnToOperate>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNInterno"/>
                    </dnToOperate>
                </xsl:when>
                <xsl:otherwise>
                    <dnToOperate>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNInternoTienda"/>
                    </dnToOperate>
                </xsl:otherwise>
            </xsl:choose>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign-cnUser">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>278</pd:x>
        <pd:y>61</pd:y>
        <config>
            <variableName>cnUser</variableName>
        </config>
        <pd:inputBindings>
            <xsl:choose>
                <xsl:when test="$Search-ID_LDAP-2/javaCodeActivityOutput/out_elements>0">
                    <cnUser_Value>
                        <xsl:value-of select="concat($Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME,' (',$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID,')')"/>
                    </cnUser_Value>
                </xsl:when>
                <xsl:when test="$Search-ID_LDAP-2/javaCodeActivityOutput/out_elements&lt;=0">
                    <cnUser_Value>
                        <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                    </cnUser_Value>
                </xsl:when>
                <xsl:otherwise>
                    <cnUser_Value>
                        <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                    </cnUser_Value>
                </xsl:otherwise>
            </xsl:choose>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign-Modifica">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>270</pd:x>
        <pd:y>335</pd:y>
        <config>
            <variableName>Operacion</variableName>
        </config>
        <pd:inputBindings>
            <Operacion_Out>
                <xsl:value-of select="'M'"/>
            </Operacion_Out>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Catch">
        <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
        <pd:resourceType>ae.activities.catch</pd:resourceType>
        <pd:x>231</pd:x>
        <pd:y>484</pd:y>
        <pd:handler>true</pd:handler>
        <config>
            <catchAll>true</catchAll>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="GenerateError">
        <pd:type>com.tibco.pe.core.GenerateErrorActivity</pd:type>
        <pd:resourceType>ae.activities.throw</pd:resourceType>
        <pd:x>598</pd:x>
        <pd:y>493</pd:y>
        <config>
            <faultName>Exception</faultName>
        </config>
        <pd:inputBindings>
            <ns12:ActivityInput>
                <message>
                    <xsl:value-of select="concat(&quot;&#xA;&quot; , 'Error al procesar registro de Empl_Id ',$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID, ',', '&#xA; ' ,'Nombre:', $Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME , '   Operacion:', $Operacion/Operacion_Out, '   Fecha:', $Start/pfx7:EMPLOYEE/pfx7:LAST_UPDATE_DT , '&#xA; ', &quot;&#xA;&quot; ,$_error/ns2:ErrorReport/StackTrace)"/>
                </message>
                <messageCode>
                    <xsl:value-of select="$_error/ns2:ErrorReport/MsgCode"/>
                </messageCode>
                <data>
                    <Exception>
                        <Domain>
                            <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/Source_Domain"/>
                        </Domain>
                        <Deployment>
                            <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Deployment"/>
                        </Deployment>
                        <Project>
                            <xsl:value-of select="$_processContext/ns2:ProcessContext/ProjectName"/>
                        </Project>
                        <EngineName>
                            <xsl:value-of select="$_processContext/ns2:ProcessContext/EngineName"/>
                        </EngineName>
                        <TimeStamp>
                            <xsl:value-of select="current-dateTime()"/>
                        </TimeStamp>
                        <xsl:if test="$_error/ns2:ErrorReport/MsgCode">
                            <Code>
                                <xsl:value-of select="$_error/ns2:ErrorReport/MsgCode"/>
                            </Code>
                        </xsl:if>
                        <Message>
                            <xsl:value-of select="tib:render-xml($_error/ns2:ErrorReport, 0,0)"/>
                        </Message>
                    </Exception>
                </data>
            </ns12:ActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Map Data">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>44</pd:x>
        <pd:y>73</pd:y>
        <config>
            <element>
                <xsd:element name="login" type="xsd:string"/>
            </element>
        </config>
        <pd:inputBindings>
            <xsl:variable name="Zeros" select="&quot;000000&quot;"/>
            <xsl:variable name="nZeros" select="6 - string-length($Start/pfx7:EMPLOYEE/pfx7:EMPL_ID)"/>
            <login>
                <xsl:value-of select="concat(substring($Start/pfx7:EMPLOYEE/pfx7:SURNAME, 1,1) ,substring($Zeros, 1, $nZeros), $Start/pfx7:EMPLOYEE/pfx7:EMPL_ID)"/>
            </login>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Map-Data-1">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>362</pd:x>
        <pd:y>62</pd:y>
        <config>
            <element>
                <xsd:element name="username" type="xsd:string"/>
            </element>
        </config>
        <pd:inputBindings>
            <xsl:variable name="count" select="$Search-ID_LDAP-2/javaCodeActivityOutput/out_elements+ 1"/>
            <username>
                <xsl:value-of select="$Map-Data/login"/>
            </username>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Operacion-Fallo-1">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>1024</pd:x>
        <pd:y>384</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Proccess_Groups">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>374</pd:x>
        <pd:y>243</pd:y>
        <config>
            <processName>/PeopleSoftIdentityManagementMX/Employee_PeopleSoft_Process/Proccess_Groups.process</processName>
        </config>
        <pd:inputBindings>
            <StringGroups>
                <String_from_BD>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBEROFF"/>
                </String_from_BD>
                <String_from_AD>
                    <xsl:value-of select="tib:substring-before-last($memeberFrom_AD/memberString_from_Ad, '+')"/>
                </String_from_AD>
                <String_To_Remove>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBER_TOREMOVE"/>
                </String_To_Remove>
                <String_To_Remove_Puesto>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBER_TOREMOVE_PUESTO"/>
                </String_To_Remove_Puesto>
            </StringGroups>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Remove_Group_Employee_LDAP-1">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>499</pd:x>
        <pd:y>245</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP1</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.StringTokenizer;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP1{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String invalidChars = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getinvalidChars() {
		return invalidChars;
	}
	public void setinvalidChars(String val) {
		invalidChars = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP1() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String invalidChars
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

               if (!in_cn.equals("")) {
                   if (!in_Groups_To_Add_user.contains("+")) {
                       in_Groups_To_Add_user=in_Groups_To_Add_user+"+";
                   }
               StringTokenizer tokenizerGroups = new StringTokenizer(in_Groups_To_Add_user,"+");
               String someChars=invalidChars;
               StringTokenizer someCharsTokenizer = new StringTokenizer(someChars,",");
               String InvalidString = "";
               while (someCharsTokenizer.hasMoreElements()) {
                     InvalidString = InvalidString + someCharsTokenizer.nextToken();
               }
               while (tokenizerGroups.hasMoreElements()) {
                   
                     ModificationItem mods[] = new ModificationItem[1];
                     mods[0]= new ModificationItem(DirContext.REMOVE_ATTRIBUTE, new BasicAttribute("member", in_cn));
                     //update the group
                     String groupName;
                     groupName = tokenizerGroups.nextToken();
                     // Instruccion agregada 19 Junio 2015
		     //if (!groupName.equals("")) {
                     //	ldapContext.modifyAttributes(groupName,mods);
       		     //}
                          boolean agregarEspecial = false;
		          if (!groupName.equals("")) {
                              for (int j=0 ;j&lt;InvalidString.length();j++) {
                              if (groupName.contains(InvalidString.substring(j,j+1))) {
                                  agregarEspecial = true;
                              }
                              }
                              if (agregarEspecial) {
                     	         groupName="'"+groupName+"'";
                              } 
                              ldapContext.modifyAttributes(groupName,mods);
                              
       		          }
               }
              }
	
              ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>invalidChars</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP1</name>
                    <byteCode>yv66vgAAADIA6wkAQACGCQBAAIcJAEAAiAkAQACJCQBAAIoJAEAAiwkAQACMCQBAAI0JAEAAjgkAQACPCQBAAJAJAEAAkQkAQACSCQBAAJMKAEEAlAgAlQcAlgoAEQCXCACYCACZCgARAJoIAJsHAJwKABcAlAgAnQoAFwCeCACfCgAXAKAIAKEIAKIIAKMIAKQIAKUKAKYApwgAqAgAqQcAqgoAJQCrCgCsAK0IAK4KAKwArwcAsAoAKgCxCACyCgAqALMKACoAtAcAtQcAtggAtwoAMAC4CgAvALkKAKwAugoArAC7CAC8CwC9AL4LAL0AvwoAQADACgBAAMEIAMIIAMMKABcAxAoAxQDGCADHBwDIBwDJAQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQAVaW5fR3JvdXBzX1RvX0FkZF91c2VyAQAFaW5fY24BAAxpbnZhbGlkQ2hhcnMBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBABhnZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBABhzZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBAAhnZXRpbl9jbgEACHNldGluX2NuAQAPZ2V0aW52YWxpZENoYXJzAQAPc2V0aW52YWxpZENoYXJzAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcAygcAlgcAyAcAsAcAywcAzAEACkV4Y2VwdGlvbnMHAM0BABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAnAEAClNvdXJjZUZpbGUBAE5FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzUmVtb3ZlX0dyb3VwX0VtcGxveWVlX0xEQVAxLmphdmEMAEIAQwwARABDDABFAEMMAEYAQwwARwBDDABIAEMMAEkAQwwASgBDDABLAEMMAEwAQwwATQBDDABOAEMMAE8AQwwAUABDDABxAHIBAAABABNqYXZhL3V0aWwvSGFzaHRhYmxlDABxAM4BABtqYXZhLm5hbWluZy5mYWN0b3J5LmluaXRpYWwBACBjb20uc3VuLmpuZGkubGRhcC5MZGFwQ3R4RmFjdG9yeQwAzwDQAQAYamF2YS5uYW1pbmcucHJvdmlkZXIudXJsAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAdsZGFwOi8vDADRANIBAAE6DADTAFIBACNqYXZhLm5hbWluZy5zZWN1cml0eS5hdXRoZW50aWNhdGlvbgEABnNpbXBsZQEAHmphdmEubmFtaW5nLnNlY3VyaXR5LnByaW5jaXBhbAEAIGphdmEubmFtaW5nLnNlY3VyaXR5LmNyZWRlbnRpYWxzAQAtdGliY28uY2xpZW50VmFyLkNvbm5lY3Rpb25zL0xEQVAvSW50ZXJuby9QYXNzBwDUDADVANYBACJqYXZhLm5hbWluZy5sZGFwLmF0dHJpYnV0ZXMuYmluYXJ5AQAKb2JqZWN0R1VJRAEAKGphdmF4L25hbWluZy9kaXJlY3RvcnkvSW5pdGlhbERpckNvbnRleHQMAHEA1wcAywwA2ADZAQABKwwA2gDbAQAZamF2YS91dGlsL1N0cmluZ1Rva2VuaXplcgwAcQDcAQABLAwA3QDeDADfAFIBACdqYXZheC9uYW1pbmcvZGlyZWN0b3J5L01vZGlmaWNhdGlvbkl0ZW0BACVqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0Jhc2ljQXR0cmlidXRlAQAGbWVtYmVyDABxAOAMAHEA4QwA4gDjDADkAOUBAAEnBwDKDADmAOcMAOgAcgwAfwB+DACAAIEBAAEtAQABMAwAcQBWBwDpDADqAIEBAAFcAQCzUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NSZW1vdmVfR3JvdXBfRW1wbG95ZWVfTERBUDEBABBqYXZhL2xhbmcvT2JqZWN0AQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9EaXJDb250ZXh0AQAQamF2YS9sYW5nL1N0cmluZwEAKltMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtOwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAAQoSSlWAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAhjb250YWlu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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="$Proccess_Groups/String_Final_Groups/Groups_To_Remove_AD"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_dn"/>
                </in_cn>
                <invalidChars>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/invalidChars"/>
                </invalidChars>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Res Alta">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1022</pd:x>
        <pd:y>85</pd:y>
        <config>
            <variableName>Resultado</variableName>
        </config>
        <pd:inputBindings>
            <Resultado_Out>
                <xsl:value-of select="''"/>
            </Resultado_Out>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Search-ID_LDAP">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>144</pd:x>
        <pd:y>272</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.Vector;
import java.util.Enumeration;



public class Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_certi_loc = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_member = "";
	protected String out_company = "";
	protected String out_mail = "";
	protected String out_poBox = "";
	protected String out_physicaldeliveryOfficeName = "";
	protected String out_location = "";
	protected String out_telephoneNumber = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_certi_loc() {
		return in_certi_loc;
	}
	public void setin_certi_loc(String val) {
		in_certi_loc = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_member() {
		return out_member;
	}
	public void setout_member(String val) {
		out_member = val;
	}
	public String getout_company() {
		return out_company;
	}
	public void setout_company(String val) {
		out_company = val;
	}
	public String getout_mail() {
		return out_mail;
	}
	public void setout_mail(String val) {
		out_mail = val;
	}
	public String getout_poBox() {
		return out_poBox;
	}
	public void setout_poBox(String val) {
		out_poBox = val;
	}
	public String getout_physicaldeliveryOfficeName() {
		return out_physicaldeliveryOfficeName;
	}
	public void setout_physicaldeliveryOfficeName(String val) {
		out_physicaldeliveryOfficeName = val;
	}
	public String getout_location() {
		return out_location;
	}
	public void setout_location(String val) {
		out_location = val;
	}
	public String getout_telephoneNumber() {
		return out_telephoneNumber;
	}
	public void setout_telephoneNumber(String val) {
		out_telephoneNumber = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_certi_loc
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_member
	Out : String out_company
	Out : String out_mail
	Out : String out_poBox
	Out : String out_physicaldeliveryOfficeName
	Out : String out_location
	Out : String out_telephoneNumber
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
              if (in_port.equals("636")) {
                  String keystore=in_certi_loc;
//"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";

                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

              //ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      

                            

	      ldapContext = new InitialDirContext(ldapEnv);

               
          // Create the search controls         
	      SearchControls searchCtls = new SearchControls();

	      //Specify the attributes to return
	      String returnedAtts[]={"objectGUID","distinguishedName", "cn","sAMAccountName","memberOf","mail","postOfficeBox","physicaldeliveryOfficeName","company","l","telephoneNumber"};
	      searchCtls.setReturningAttributes(returnedAtts);

	      //Specify the search scope
	      searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);
              

	      //specify the LDAP search filter
	      String searchFilter = "(&amp;(objectClass=user)(sAMAccountName=" + in_sAMAccountName + "))";

	      //Specify the Base for the search
	      String searchBase = in_dn;

	      // Search for objects using the filter
	      NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	      //Loop through the search results
	      while (answer.hasMoreElements())
	      {
	        SearchResult sr = (SearchResult)answer.next();

	        Attributes attrs = sr.getAttributes();
	        
	        byte[] guid = (byte[]) attrs.get("objectGUID").get();
		out_guid = convertToBindingString(guid);
		//out_guid = convertToByteString(guid);
                String dn = attrs.get("distinguishedName").toString();
                String[] name = dn.split(":");
                out_dn = name[1].trim();
		out_dn = out_dn.replace("á", "\\E1"); 
		out_dn = out_dn.replace("é", "\\E9");
		out_dn = out_dn.replace("í", "\\ED");
		out_dn = out_dn.replace("ó", "\\F3");
		out_dn = out_dn.replace("ú", "\\FA");
                out_dn = out_dn.replace("ñ", "\\F1");
                String cn = attrs.get("cn").toString();
                String[] cname = cn.split(":");
                out_cn = cname[1].trim();
                //System.out.println(out_cn);
                out_samAccountName="";   // Hay que sacar este valor original
                }
              
                //System.out.println(out_cn);  
				//Estaba asi !out_cn.equals("")
				// Cuando existe samacount siempre entra y son los datos que utiliza memeroff
				// Cuando no existe samaccount no entra y deberia checar con emplid
                if (!out_cn.equals("") || out_guid.equals("")) {
                  searchFilter = "(&amp;(objectClass=user)(employeeID=" + in_employeeid + "))";
                  searchBase = in_dn;
                  answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	          //Loop through the search results
                  out_guid = "";
	          while (answer.hasMoreElements())
	          {
	            SearchResult sr = (SearchResult)answer.next();

	            Attributes attrs = sr.getAttributes();
	        
	            byte[] guid = (byte[]) attrs.get("objectGUID").get();
		    out_guid = convertToBindingString(guid);
		    //out_guid = convertToByteString(guid);
                    String dn = attrs.get("distinguishedName").toString();
                    String[] name = dn.split(":");
                    out_dn = name[1].trim();
		    out_dn = out_dn.replace("á", "\\E1"); 
		    out_dn = out_dn.replace("é", "\\E9");
		    out_dn = out_dn.replace("í", "\\ED");
		    out_dn = out_dn.replace("ó", "\\F3");
		    out_dn = out_dn.replace("ú", "\\FA");
                    out_dn = out_dn.replace("ñ", "\\F1");
                    String cn = attrs.get("cn").toString();
                    String[] cname = cn.split(":");
                    out_cn = cname[1].trim();
                    //System.out.println(out_cn);
					out_samAccountName="";   // Hay que sacar este valor original
                    //out_samAccountName= attrs.get("sAMAccountName").toString();
                    if (attrs.get("mail")!=null) {
                        out_mail= (String)attrs.get("mail").get();
                        //out_mail= attrs.get("mail").toString();
                    }
                    if (attrs.get("postOfficeBox")!=null) {
                        out_poBox= (String)attrs.get("postOfficeBox").get();
                    }

                    if (attrs.get("physicaldeliveryOfficeName")!=null) {
                        out_physicaldeliveryOfficeName= (String)attrs.get("physicaldeliveryOfficeName").get();
                    }
                    if (attrs.get("l")!=null) {
                        out_location= (String)attrs.get("l").get();
                    }

                    if (attrs.get("telephoneNumber")!=null) {
                        out_telephoneNumber= (String)attrs.get("telephoneNumber").get();
                    }
                     
                    if (attrs.get("company")!=null) {
                        out_company= (String)attrs.get("company").get();
                    }
                       
                                             
                    //out_member=attrs.get("memberOf").toString();
                   
                   //List&lt;String&gt; memberOf = new ArrayList&lt;String&gt;();
                   out_member="";
                   if (attrs.get("memberOf")!=null) {
                       Enumeration vals = attrs.get("memberOf").getAll();
                       while (vals.hasMoreElements()) {
                             //memberOf.add((String)vals.nextElement());
                             out_member=out_member+(String)vals.nextElement()+"+";
                       }
                   }
                   
                }
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_certi_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_member</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_company</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_mail</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_poBox</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_physicaldeliveryOfficeName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_location</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_telephoneNumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP</name>
                    <byteCode>yv66vgAAADIBWwkAaQC/CQBpAMAJAGkAwQkAaQDCCQBpAMMJAGkAxAkAaQDFCQBpAMYJAGkAxwkAaQDICQBpAMkJAGkAygkAaQDLCQBpAMwJAGkAzQkAaQDOCQBpAM8JAGkA0AoAagDRCADSBwDTCgAVANQIANUKADQA1ggA1woA2ADZCADaBwDbCgAcANEIANwKABwA3QgA3ggA3woAHADgCgAVAOEIAOIIAOMIAOQIAOUIAOYIAOcIAOgIAOkIAOoKAOsA7AgA7QgA7gcA7woAMADwBwDxCgAyANEHAPIIAPMIAPQIAPUIAPYIAPcIAPgIAPkIAPoIAPsIAPwKADIA/QoAMgD+CAD/CAEACwEBAQILAQMBBAsBAwEFBwEGCgBGAQcLAQgBCQsBCgELBwEMCgBpAQ0KAGoA4AoANAEOCgA0AQ8IARAIAREKADQBEggBEwgBFAgBFQgBFggBFwgBGAgBGQgBGggBGwgBHAgBHQsBCgEeCwEfAQQLAR8BIAgBIQsBAQEiCgBpASMKAGkBJAgBJQgBJgoAHAEnCgEoASkIASoHASsHASwBAAlpbl91c2VyRE4BABJMamF2YS9sYW5nL1N0cmluZzsBABFpbl9zQU1BY2NvdW50TmFtZQEACWluX3NlcnZlcgEAB2luX3BvcnQBAAVpbl9kbgEADWluX2VtcGxveWVlaWQBAAxpbl9jZXJ0aV9sb2MBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9tZW1iZXIBAAtvdXRfY29tcGFueQEACG91dF9tYWlsAQAJb3V0X3BvQm94AQAeb3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAMb3V0X2xvY2F0aW9uAQATb3V0X3RlbGVwaG9uZU51bWJlcgEADGdldGluX3VzZXJETgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEADHNldGluX3VzZXJETgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAFGdldGluX3NBTUFjY291bnROYW1lAQAUc2V0aW5fc0FNQWNjb3VudE5hbWUBAAxnZXRpbl9zZXJ2ZXIBAAxzZXRpbl9zZXJ2ZXIBAApnZXRpbl9wb3J0AQAKc2V0aW5fcG9ydAEACGdldGluX2RuAQAIc2V0aW5fZG4BABBnZXRpbl9lbXBsb3llZWlkAQAQc2V0aW5fZW1wbG95ZWVpZAEAD2dldGluX2NlcnRpX2xvYwEAD3NldGluX2NlcnRpX2xvYwEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAA1nZXRvdXRfbWVtYmVyAQANc2V0b3V0X21lbWJlcgEADmdldG91dF9jb21wYW55AQAOc2V0b3V0X2NvbXBhbnkBAAtnZXRvdXRfbWFpbAEAC3NldG91dF9tYWlsAQAMZ2V0b3V0X3BvQm94AQAMc2V0b3V0X3BvQm94AQAhZ2V0b3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAhc2V0b3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAPZ2V0b3V0X2xvY2F0aW9uAQAPc2V0b3V0X2xvY2F0aW9uAQAWZ2V0b3V0X3RlbGVwaG9uZU51bWJlcgEAFnNldG91dF90ZWxlcGhvbmVOdW1iZXIBAAY8aW5pdD4BAAMoKVYBAAZpbnZva2UBAA1TdGFja01hcFRhYmxlBwDTBwErBwEtBwDxBwEuBwDyBwEvBwEGBwEwBwExAQAKRXhjZXB0aW9ucwcBMgEAFmNvbnZlcnRUb0JpbmRpbmdTdHJpbmcBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAVY29udmVydFRvRGFzaGVkU3RyaW5nAQALcHJlZml4WmVyb3MBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBABNjb252ZXJ0VG9CeXRlU3RyaW5nBwDbAQAKU291cmNlRmlsZQEAQEVtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9MREFQLmphdmEMAGsAbAwAbQBsDABuAGwMAG8AbAwAcABsDABxAGwMAHIAbAwAcwBsDAB0AGwMAHUAbAwAdgBsDAB3AGwMAHgAbAwAeQBsDAB6AGwMAHsAbAwAfABsDAB9AGwMAKYApwEAAAEAE2phdmEvdXRpbC9IYXNodGFibGUMAKYBMwEAAzYzNgwBNAE1AQAYamF2YXgubmV0LnNzbC50cnVzdFN0b3JlBwE2DAE3ATgBABhqYXZhLm5hbWluZy5wcm92aWRlci51cmwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAB2xkYXA6Ly8MATkBOgEAAToBAAMzODkMATsAfwwBPAE9AQAbamF2YS5uYW1pbmcuZmFjdG9yeS5pbml0aWFsAQAgY29tLnN1bi5qbmRpLmxkYXAuTGRhcEN0eEZhY3RvcnkBAB1qYXZhLm5hbWluZy5zZWN1cml0eS5wcm90b2NvbAEAA3NzbAEAI2phdmEubmFtaW5nLnNlY3VyaXR5LmF1dGhlbnRpY2F0aW9uAQAGc2ltcGxlAQAeamF2YS5uYW1pbmcuc2VjdXJpdHkucHJpbmNpcGFsAQAgamF2YS5uYW1pbmcuc2VjdXJpdHkuY3JlZGVudGlhbHMBAC10aWJjby5jbGllbnRWYXIuQ29ubmVjdGlvbnMvTERBUC9JbnRlcm5vL1Bhc3MHAT4MAT8BQAEAImphdmEubmFtaW5nLmxkYXAuYXR0cmlidXRlcy5iaW5hcnkBAApvYmplY3RHVUlEAQAoamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Jbml0aWFsRGlyQ29udGV4dAwApgFBAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hDb250cm9scwEAEGphdmEvbGFuZy9TdHJpbmcBABFkaXN0aW5ndWlzaGVkTmFtZQEAAmNuAQAOc0FNQWNjb3VudE5hbWUBAAhtZW1iZXJPZgEABG1haWwBAA1wb3N0T2ZmaWNlQm94AQAacGh5c2ljYWxkZWxpdmVyeU9mZmljZU5hbWUBAAdjb21wYW55AQABbAEAD3RlbGVwaG9uZU51bWJlcgwBQgFDDAFEATMBACQoJihvYmplY3RDbGFzcz11c2VyKShzQU1BY2NvdW50TmFtZT0BAAIpKQcBLQwBRQFGBwEvDAFHAUgMAUkBSgEAI2phdmF4L25hbWluZy9kaXJlY3RvcnkvU2VhcmNoUmVzdWx0DAFLAUwHATAMAU0BTgcBTwwBTQFKAQACW0IMALYAtwwBUAFRDAFSAH8BAALDoQEAA1xFMQwBUwFUAQACw6kBAANcRTkBAALDrQEAA1xFRAEAAsOzAQADXEYzAQACw7oBAANcRkEBAALDsQEAA1xGMQEAICgmKG9iamVjdENsYXNzPXVzZXIpKGVtcGxveWVlSUQ9DAFVAVYHATEMAVcBSgEAASsMAVgApwwAuAC3DAC5ALoBAAEtAQABMAwApgCDBwFZDAFaALoBAAFcAQClUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9MREFQAQAQamF2YS9sYW5nL09iamVjdAEAIWphdmF4L25hbWluZy9kaXJlY3RvcnkvRGlyQ29udGV4dAEAE1tMamF2YS9sYW5nL1N0cmluZzsBAB5qYXZheC9uYW1pbmcvTmFtaW5nRW51bWVyYXRpb24BACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0F0dHJpYnV0ZXMBABVqYXZhL3V0aWwvRW51bWVyYXRpb24BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAEKEkpVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAEGphdmEvbGFuZy9TeXN0ZW0BAAtzZXRQcm9wZXJ0eQEAOChMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBABZzZXRSZXR1cm5pbmdBdHRyaWJ1dGVzAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEADnNldFNlYXJjaFNjb3BlAQAGc2VhcmNoAQBtKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9uYW1pbmcvZGlyZWN0b3J5L1NlYXJjaENvbnRyb2xzOylMamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uOwEAD2hhc01vcmVFbGVtZW50cwEAAygpWgEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADWdldEF0dHJpYnV0ZXMBACUoKUxqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0F0dHJpYnV0ZXM7AQADZ2V0AQA2KExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGU7AQAgamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGUBAAVzcGxpdAEAJyhMamF2YS9sYW5nL1N0cmluZzspW0xqYXZhL2xhbmcvU3RyaW5nOwEABHRyaW0BAAdyZXBsYWNlAQBEKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlO0xqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylMamF2YS9sYW5nL1N0cmluZzsBAAZnZXRBbGwBACIoKUxqYXZheC9uYW1pbmcvTmFtaW5nRW51bWVyYXRpb247AQALbmV4dEVsZW1lbnQBAAVjbG9zZQEAEWphdmEvbGFuZy9JbnRlZ2VyAQALdG9IZXhTdHJpbmcAIQBpAGoAAAASAAQAawBsAAAABABtAGwAAAAEAG4AbAAAAAQAbwBsAAAABABwAGwAAAAEAHEAbAAAAAQAcgBsAAAABABzAGwAAAAEAHQAbAAAAAQAdQBsAAAABAB2AGwAAAAEAHcAbAAAAAQAeABsAAAABAB5AGwAAAAEAHoAbAAAAAQAewBsAAAABAB8AGwAAAAEAH0AbAAAACoAAQB+AH8AAQCAAAAAHQABAAEAAAAFKrQAAbAAAAABAIEAAAAGAAEAAAAmAAEAggCDAAEAgAAAACIAAgACAAAABiortQABsQAAAAEAgQAAAAoAAgAAACkABQAqAAEAhAB/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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNSearch"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_certi_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_certi_loc>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Upd-Emp-Pend-Det">
        <pd:type>com.tibco.plugin.jdbc.JDBCUpdateActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCUpdateActivity</pd:resourceType>
        <pd:x>491</pd:x>
        <pd:y>492</pd:y>
        <config>
            <timeout>10</timeout>
            <commit>false</commit>
            <emptyStrAsNil>false</emptyStrAsNil>
            <statement>Update PS_EMPL_DATA_DETAIL_MX set  Status_AD=?,Operacion_AD=?,Intentos_AD=Intentos_AD+?,Resultado_AD=?  where EMPL_ID=? and INSERTEDDATE=?</statement>
            <jdbcSharedConfig>/Shared Resources/Connections/Connections/Database/Mssql/DBSTG JDBC Connection.sharedjdbc</jdbcSharedConfig>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>STATUSAD</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>OPERACIONAD</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>INTENTOSAD</parameterName>
                    <dataType>INTEGER</dataType>
                </parameter>
                <parameter>
                    <parameterName>RESULTADOAD</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>EMPL_ID</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>INSERTEDDATE</parameterName>
                    <dataType>TIMESTAMP</dataType>
                </parameter>
            </Prepared_Param_DataType>
        </config>
        <pd:inputBindings>
            <jdbcUpdateActivityInput>
                <STATUSAD>
                    <xsl:value-of select="'Z'"/>
                </STATUSAD>
                <OPERACIONAD>
                    <xsl:value-of select="$Operacion/Operacion_Out"/>
                </OPERACIONAD>
                <INTENTOSAD>
                    <xsl:value-of select="1"/>
                </INTENTOSAD>
                <RESULTADOAD>
                    <xsl:value-of select="'0'"/>
                </RESULTADOAD>
                <EMPL_ID>
                    <xsl:choose>
                        <xsl:when test="exists($Start/pfx7:EMPLOYEE/pfx7:EMPL_ID)">
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </EMPL_ID>
                <INSERTEDDATE>
                    <xsl:choose>
                        <xsl:when test="exists($Start/pfx7:EMPLOYEE/pfx7:INSERTEDDATE)">
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:INSERTEDDATE"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </INSERTEDDATE>
            </jdbcUpdateActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Verificar Operacion">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>901</pd:x>
        <pd:y>251</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Search-ID_LDAP-2">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>236</pd:x>
        <pd:y>167</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP2</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;

public class Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP2{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_cn = "";
	protected String in_cert_loc = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected int out_elements = 0;
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getin_cert_loc() {
		return in_cert_loc;
	}
	public void setin_cert_loc(String val) {
		in_cert_loc = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public int getout_elements() {
		return out_elements;
	}
	public void setout_elements(int val) {
		out_elements = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP2() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_cn
	In  : String in_cert_loc
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : int out_elements
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);

              if (in_port.equals("636")) {
                  String keystore=in_cert_loc;
                  //"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";
                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }
              
              ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      

                            

	      ldapContext = new InitialDirContext(ldapEnv);

               
          // Create the search controls         
	      SearchControls searchCtls = new SearchControls();

	      //Specify the attributes to return
	      String returnedAtts[]={"objectGUID","distinguishedName", "cn","sAMAccountName"};
	      searchCtls.setReturningAttributes(returnedAtts);

	      //Specify the search scope
	      searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);

	      //specify the LDAP search filter
	      String searchFilter = "(&amp;(objectClass=user)(cn=" + in_cn + "))";

	      //Specify the Base for the search
	      String searchBase = in_dn;

	      // Search for objects using the filter
	      NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

              out_elements=0;
	      //Loop through the search results
	      while (answer.hasMoreElements())
	      {
                out_elements++;
	        SearchResult sr = (SearchResult)answer.next();

	        Attributes attrs = sr.getAttributes();
	        
	        byte[] guid = (byte[]) attrs.get("objectGUID").get();
		out_guid = convertToBindingString(guid);
		//out_guid = convertToByteString(guid);
                String dn = attrs.get("distinguishedName").toString();
                String[] name = dn.split(":");
                out_dn = name[1].trim();
		out_dn = out_dn.replace("á", "\\E1"); 
		out_dn = out_dn.replace("é", "\\E9");
		out_dn = out_dn.replace("í", "\\ED");
		out_dn = out_dn.replace("ó", "\\F3");
		out_dn = out_dn.replace("ú", "\\FA");
                out_dn = out_dn.replace("ñ", "\\F1");
                String cn = attrs.get("cn").toString();
                String[] cname = cn.split(":");
                out_cn = cname[1].trim();
                out_samAccountName="";
                }
                
                if (out_cn.equals("")) {
                  searchFilter = "(&amp;(objectClass=user)(employeeID=" + in_employeeid + "))";
                  searchBase = in_dn;
                  answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	          //Loop through the search results
	          while (answer.hasMoreElements())
	          {
	            SearchResult sr = (SearchResult)answer.next();

	            Attributes attrs = sr.getAttributes();
	        
	            byte[] guid = (byte[]) attrs.get("objectGUID").get();
		    out_guid = convertToBindingString(guid);
		    //out_guid = convertToByteString(guid);
                    String dn = attrs.get("distinguishedName").toString();
                    String[] name = dn.split(":");
                    out_dn = name[1].trim();
		    out_dn = out_dn.replace("á", "\\E1"); 
		    out_dn = out_dn.replace("é", "\\E9");
		    out_dn = out_dn.replace("í", "\\ED");
		    out_dn = out_dn.replace("ó", "\\F3");
		    out_dn = out_dn.replace("ú", "\\FA");
                    out_dn = out_dn.replace("ñ", "\\F1");
                    String cn = attrs.get("cn").toString();
                    String[] cname = cn.split(":");
                    out_cn = cname[1].trim();
                    out_samAccountName= attrs.get("sAMAccountName").toString();;
                }
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_elements</fieldName>
                    <fieldType>int</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cert_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_LDAP2</name>
                    <byteCode>yv66vgAAADIBJwkAWQCgCQBZAKEJAFkAogkAWQCjCQBZAKQJAFkApQkAWQCmCQBZAKcJAFkAqAkAWQCpCQBZAKoJAFkAqwkAWQCsCgBaAK0IAK4HAK8KABAAsAgAsQoALwCyCACzCgC0ALUIALYHALcKABcArQgAuAoAFwC5CAC6CAC7CgAXALwKABAAvQgAvggAvwgAwAgAwQgAwggAwwgAxAgAxQgAxgoAxwDICADJCADKBwDLCgArAMwHAM0KAC0ArQcAzggAzwgA0AgA0QoALQDSCgAtANMIANQIANULANYA1wsA2ADZCwDYANoHANsKADoA3AsA3QDeCwDfAOAHAOEKAFkA4goAWgC8CgAvAOMKAC8A5AgA5QgA5goALwDnCADoCADpCADqCADrCADsCADtCADuCADvCADwCADxCADyCwDWAPMKAFkA9AoAWQD1CAD2CAD3CgAXAPgKAPkA+ggA+wcA/AcA/QEACWluX3VzZXJETgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAEWluX3NBTUFjY291bnROYW1lAQAJaW5fc2VydmVyAQAHaW5fcG9ydAEABWluX2RuAQANaW5fZW1wbG95ZWVpZAEABWluX2NuAQALaW5fY2VydF9sb2MBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEADG91dF9lbGVtZW50cwEAAUkBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBAAhnZXRpbl9jbgEACHNldGluX2NuAQAOZ2V0aW5fY2VydF9sb2MBAA5zZXRpbl9jZXJ0X2xvYwEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAA9nZXRvdXRfZWxlbWVudHMBAAMoKUkBAA9zZXRvdXRfZWxlbWVudHMBAAQoSSlWAQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcArwcA/AcA/gcAzQcA/wcAzgcBAAEACkV4Y2VwdGlvbnMHAQEBABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAtwEAClNvdXJjZUZpbGUBAEFFbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzU2VhcmNoSURfTERBUDIuamF2YQwAWwBcDABdAFwMAF4AXAwAXwBcDABgAFwMAGEAXAwAYgBcDABjAFwMAGQAXAwAZQBcDABmAFwMAGcAXAwAaABpDACKAIsBAAABABNqYXZhL3V0aWwvSGFzaHRhYmxlDACKAIkBAAM2MzYMAQIBAwEAGGphdmF4Lm5ldC5zc2wudHJ1c3RTdG9yZQcBBAwBBQEGAQAYamF2YS5uYW1pbmcucHJvdmlkZXIudXJsAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAAdsZGFwOi8vDAEHAQgBAAE6AQADMzg5DAEJAGsMAQoBCwEAG2phdmEubmFtaW5nLmZhY3RvcnkuaW5pdGlhbAEAIGNvbS5zdW4uam5kaS5sZGFwLkxkYXBDdHhGYWN0b3J5AQAdamF2YS5uYW1pbmcuc2VjdXJpdHkucHJvdG9jb2wBAANzc2wBACNqYXZhLm5hbWluZy5zZWN1cml0eS5hdXRoZW50aWNhdGlvbgEABnNpbXBsZQEAHmphdmEubmFtaW5nLnNlY3VyaXR5LnByaW5jaXBhbAEAIGphdmEubmFtaW5nLnNlY3VyaXR5LmNyZWRlbnRpYWxzAQAtdGliY28uY2xpZW50VmFyLkNvbm5lY3Rpb25zL0xEQVAvSW50ZXJuby9QYXNzBwEMDAENAQ4BACJqYXZhLm5hbWluZy5sZGFwLmF0dHJpYnV0ZXMuYmluYXJ5AQAKb2JqZWN0R1VJRAEAKGphdmF4L25hbWluZy9kaXJlY3RvcnkvSW5pdGlhbERpckNvbnRleHQMAIoBDwEAJWphdmF4L25hbWluZy9kaXJlY3RvcnkvU2VhcmNoQ29udHJvbHMBABBqYXZhL2xhbmcvU3RyaW5nAQARZGlzdGluZ3Vpc2hlZE5hbWUBAAJjbgEADnNBTUFjY291bnROYW1lDAEQAREMARIAiQEAGCgmKG9iamVjdENsYXNzPXVzZXIpKGNuPQEAAikpBwD+DAETARQHAQAMARUBFgwBFwEYAQAjamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hSZXN1bHQMARkBGgcBGwwBHAEdBwEeDAEcARgBAAJbQgwAlwCYDAEfASAMASEAawEAAsOhAQADXEUxDAEiASMBAALDqQEAA1xFOQEAAsOtAQADXEVEAQACw7MBAANcRjMBAALDugEAA1xGQQEAAsOxAQADXEYxAQAgKCYob2JqZWN0Q2xhc3M9dXNlcikoZW1wbG95ZWVJRD0MASQAiwwAmQCYDACaAJsBAAEtAQABMAwAigBvBwElDAEmAJsBAAFcAQCmUGVvcGxlU29mdElkZW50aXR5TWFuYWdlbWVudE1YL0VtcGxveWVlX1Blb3BsZVNvZnRfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzL0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9MREFQMgEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABNbTGphdmEvbGFuZy9TdHJpbmc7AQAeamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAEGphdmEvbGFuZy9TeXN0ZW0BAAtzZXRQcm9wZXJ0eQEAOChMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAJGNvbS90aWJjby9wZS9wbHVnaW4vUGx1Z2luUHJvcGVydGllcwEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABgoTGphdmEvdXRpbC9IYXNodGFibGU7KVYBABZzZXRSZXR1cm5pbmdBdHRyaWJ1dGVzAQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgEADnNldFNlYXJjaFNjb3BlAQAGc2VhcmNoAQBtKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9uYW1pbmcvZGlyZWN0b3J5L1NlYXJjaENvbnRyb2xzOylMamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uOwEAD2hhc01vcmVFbGVtZW50cwEAAygpWgEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADWdldEF0dHJpYnV0ZXMBACUoKUxqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0F0dHJpYnV0ZXM7AQAhamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGVzAQADZ2V0AQA2KExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGU7AQAgamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGUBAAVzcGxpdAEAJyhMamF2YS9sYW5nL1N0cmluZzspW0xqYXZhL2xhbmcvU3RyaW5nOwEABHRyaW0BAAdyZXBsYWNlAQBEKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlO0xqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylMamF2YS9sYW5nL1N0cmluZzsBAAVjbG9zZQEAEWphdmEvbGFuZy9JbnRlZ2VyAQALdG9IZXhTdHJpbmcAIQBZAFoAAAANAAQAWwBcAAAABABdAFwAAAAEAF4AXAAAAAQAXwBcAAAABABgAFwAAAAEAGEAXAAAAAQAYgBcAAAABABjAFwAAAAEAGQAXAAAAAQAZQBcAAAABABmAFwAAAAEAGcAXAAAAAQAaABpAAAAIAABAGoAawABAGwAAAAdAAEAAQAAAAUqtAABsAAAAAEAbQAAAAYAAQAAAB0AAQBuAG8AAQBsAAAAIgACAAIAAAAGKiu1AAGxAAAAAQBtAAAACgACAAAAIAAFACEAAQBwAGsAAQBsAAAAHQABAAEAAAAFKrQAArAAAAABAG0AAAAGAAEAAAAjAAEAcQBvAAEAbAAAACIAAgACAAAABiortQACsQAAAAEAbQAAAAoAAgAAACYABQAnAAEAcgBrAAEAbAAAAB0AAQABAAAABSq0AAOwAAAAAQBtAAAABgABAAAAKQABAHMAbwABAGwAAAAiAAIAAgAAAAYqK7UAA7EAAAABAG0AAAAKAAIAAAAsAAUALQABAHQAawABAGwAAAAdAAEAAQAAAAUqtAAEsAAAAAEAbQAAAAYAAQAAAC8AAQB1AG8AAQBsAAAAIgACAAIAAAAGKiu1AASxAAAAAQBtAAAACgACAAAAMgAFADMAAQB2AGsAAQBsAAAAHQABAAEAAAAFKrQABbAAAAABAG0AAAAGAAEAAAA1AAEAdwBvAAEAbAAAACIAAgACAAAABiortQAFsQAAAAEAbQAAAAoAAgAAADgABQA5AAEAeABrAAEAbAAAAB0AAQABAAAABSq0AAawAAAAAQBtAAAABgABAAAAOwABAHkAbwABAGwAAAAiAAIAAgAAAAYqK7UABrEAAAABAG0AAAAKAAIAAAA+AAUAPwABAHoAawABAGwAAAAdAAEAAQAAAAUqtAAHsAAAAAEAbQAAAAYAAQAAAEEAAQB7AG8AAQBsAAAAIgACAAIAAAAGKiu1AAexAAAAAQBtAAAACgACAAAARAAFAEUAAQB8AGsAAQBsAAAAHQABAAEAAAAFKrQACLAAAAABAG0AAAAGAAEAAABHAAEAfQBvAAEAbAAAACIAAgACAAAABiortQAIsQAAAAEAbQAAAAoAAgAAAEoABQBLAAEAfgBrAAEAbAAAAB0AAQABAAAABSq0AAmwAAAAAQBtAAAABgABAAAATQABAH8AbwABAGwAAAAiAAIAAgAAAAYqK7UACbEAAAABAG0AAAAKAAIAAABQAAUAUQABAIAAawABAGwAAAAdAAEAAQAAAAUqtAAKsAAAAAEAbQAAAAYAAQAAAFMAAQCBAG8AAQBsAAAAIgACAAIAAAAGKiu1AAqxAAAAAQBtAAAACgACAAAAVgAFAFcAAQCCAGsAAQBsAAAAHQABAAEAAAAFKrQAC7AAAAABAG0AAAAGAAEAAABZAAEAgwBvAAEAbAAAACIAAgACAAAABiortQALsQAAAAEAbQAAAAoAAgAAAFwABQBdAAEAhABrAAEAbAAAAB0AAQABAAAABSq0AAywAAAAAQBtAAAABgABAAAAXwABAIUAbwABAGwAAAAiAAIAAgAAAAYqK7UADLEAAAABAG0AAAAKAAIAAABiAAUAYwABAIYAhwABAGwAAAAdAAEAAQAAAAUqtAANrAAAAAEAbQAAAAYAAQAAAGUAAQCIAIkAAQBsAAAAIgACAAIAAAAGKhu1AA2xAAAAAQBtAAAACgACAAAAaAAFAGkAAQCKAIsAAQBsAAAAogACAAEAAABSKrcADioSD7UAASoSD7UAAioSD7UAAyoSD7UABCoSD7UABSoSD7UABioSD7UAByoSD7UACCoSD7UACSoSD7UACioSD7UACyoSD7UADCoDtQANsQAAAAEAbQAAAD4ADwAAAGsABAAPAAoAEAAQABEAFgASABwAEwAiABQAKAAVAC4AFgA0ABcAOgAYAEAAGQBGABoATAAbAFEAbAABAIwAiwACAGwAAATOAAQADwAAA2y7ABBZEAu3ABFNKrQABBIStgATmQASKrQACE4SFC24ABVXpwAqLBIWuwAXWbcAGBIZtgAaKrQAA7YAGhIbtgAaEhy2ABq2AB22AB5XLBIfEiC2AB5XKrQABBIStgATmQA2LBIhEiK2AB5XLBIWuwAXWbcAGBIZtgAaKrQAA7YAGhIbtgAaEhK2ABq2AB22AB5XpwAqLBIWuwAXWbcAGBIZtgAaKrQAA7YAGhIbtgAaEhy2ABq2AB22AB5XLBIjEiS2AB5XLBIlKrQAAbYAHlcsEiYSJ7gAKLYAHlcsEikSKrYAHle7ACtZLLcALEy7AC1ZtwAuTge9AC9ZAxIqU1kEEjBTWQUSMVNZBhIyUzoELRkEtgAzLQW2ADS7ABdZtwAYEjW2ABoqtAAHtgAaEja2ABq2AB06BSq0AAU6BisZBhkFLbkANwQAOgcqA7UADRkHuQA4AQCZAOYqWbQADQRgtQANGQe5ADkBAMAAOjoIGQi2ADs6CRkJEiq5ADwCALkAPQEAwAA+wAA+OgoqGQq4AD+1AAkZCRIwuQA8AgC2AEA6CxkLEhu2AEE6DCoZDAQytgBCtQAKKiq0AAoSQxJEtgBFtQAKKiq0AAoSRhJHtgBFtQAKKiq0AAoSSBJJtgBFtQAKKiq0AAoSShJLtgBFtQAKKiq0AAoSTBJNtgBFtQAKKiq0AAoSThJPtgBFtQAKGQkSMbkAPAIAtgBAOg0ZDRIbtgBBOg4qGQ4EMrYAQrUACyoSD7UADKf/Fiq0AAsSD7YAE5kBILsAF1m3ABgSULYAGiq0AAa2ABoSNrYAGrYAHToFKrQABToGKxkGGQUtuQA3BAA6BxkHuQA4AQCZAOYZB7kAOQEAwAA6OggZCLYAOzoJGQkSKrkAPAIAuQA9AQDAAD7AAD46CioZCrgAP7UACRkJEjC5ADwCALYAQDoLGQsSG7YAQToMKhkMBDK2AEK1AAoqKrQAChJDEkS2AEW1AAoqKrQAChJGEke2AEW1AAoqKrQAChJIEkm2AEW1AAoqKrQAChJKEku2AEW1AAoqKrQAChJMEk22AEW1AAoqKrQAChJOEk+2AEW1AAoZCRIxuQA8AgC2AEA6DRkNEhu2AEE6DioZDgQytgBCtQALKhkJEjK5ADwCALYAQLUADKf/Fiu5AFEBALEAAAACAG0AAAEWAEUAAACAAAoAggAWAIMAGwCFACIAhgAlAIcATACKAFUAjABhAI0AagCOAJQAkAC7AJMAxACUAM8AlQDbAJYA5ACbAO0AnwD1AKIBDwCjARUApgEaAKkBNwCsAT0ArwFKALEBTwCzAVkAtQFjALYBbwC4AXYAugGMALsBlQC9AaMAvgGsAL8BtwDAAcYAwQHVAMIB5ADDAfMAxAICAMUCEQDGAh8AxwIoAMgCMwDJAjkAygI8AMwCSADNAmUAzgJrAM8CeADSAoIA1AKOANYClQDYAqsA2QK0ANsCwgDcAssA3QLWAN4C5QDfAvQA4AMDAOEDEgDiAyEA4wMwAOQDPgDlA0cA5gNSAOcDYgDoA2UA7ANrAO0AjQAAADQACP0AJQAHAI4m+wBHJv8AkwAIBwCPBwCQBwCOBwCRBwCSBwCTBwCTBwCUAAD7AOw7+wDsAJUAAAAEAAEAlgAKAJcAmAABAGwAAAA2AAIAAgAAABa7ABdZtwAYTCsquABStgAaVyu2AB2wAAAAAQBtAAAADgADAAAA8AAIAPIAEQD0AAoAmQCYAAEAbAAAAY8AAwACAAABI7sAF1m3ABhMKyoGMxEA/364AFO2ABpXKyoFMxEA/364AFO2ABpXKyoEMxEA/364AFO2ABpXKyoDMxEA/364AFO2ABpXKxJUtgAaVysqCDMRAP9+uABTtgAaVysqBzMRAP9+uABTtgAaVysSVLYAGlcrKhAHMxEA/364AFO2ABpXKyoQBjMRAP9+uABTtgAaVysSVLYAGlcrKhAIMxEA/364AFO2ABpXKyoQCTMRAP9+uABTtgAaVysSVLYAGlcrKhAKMxEA/364AFO2ABpXKyoQCzMRAP9+uABTtgAaVysqEAwzEQD/frgAU7YAGlcrKhANMxEA/364AFO2ABpXKyoQDjMRAP9+uABTtgAaVysqEA8zEQD/frgAU7YAGlcrtgAdsAAAAAEAbQAAAFoAFgAAAPgACAD6ABcA+wAmAPwANQD9AEQA/gBLAP8AWgEAAGkBAQBwAQIAgAEDAJABBACXAQUApwEGALcBBwC+AQgAzgEJAN4BCgDuAQsA/gEMAQ4BDQEeAQ8ACgCaAJsAAQBsAAAAVAADAAIAAAAjGhAPowAbuwAXWRJVtwBWTCsauABXtgAaVyu2AB2wGrgAV7AAAAACAG0AAAAWAAUAAAETAAYBFAAQARUAGQEXAB4BGgCNAAAAAwABHgAKAJwAmAABAGwAAAB1AAIABAAAADO7ABdZtwAYTAM9HCq+ogAhKhwzEQD/frgAU04rEli2ABpXKy22ABpXhAIBp//fK7YAHbAAAAACAG0AAAAeAAcAAAEfAAgBIQAQASIAGwEjACIBJAAoASEALgEnAI0AAAAMAAL9AAoHAJ0B+gAjAAEAngAAAAIAnw==</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNSearch"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_cn>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                </in_cn>
                <in_cert_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_cert_loc>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Add_ControlCount_AD">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>895</pd:x>
        <pd:y>36</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_ControlCount_AD</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.*;
import javax.naming.*;
import javax.naming.directory.*;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_ControlCount_AD{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String in_userAccountControl = "";
	protected String in_cert_loc = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getin_userAccountControl() {
		return in_userAccountControl;
	}
	public void setin_userAccountControl(String val) {
		in_userAccountControl = val;
	}
	public String getin_cert_loc() {
		return in_cert_loc;
	}
	public void setin_cert_loc(String val) {
		in_cert_loc = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_ControlCount_AD() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String in_userAccountControl
	In  : String in_cert_loc
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/
             
              DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      
              if (in_port.equals("636")) {
                  String keystore=in_cert_loc;
                  //"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";
                  //C:\tibco\jre\1.5.0\lib\security\hebcacerts2
                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }


	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

              out_result="Error";
               if (!in_cn.equals("")) {
              
                   
                     ModificationItem mods[] = new ModificationItem[1];

                     Attribute mod0 = new BasicAttribute("userAccountControl", in_userAccountControl);
                     //Attribute mod1 = new BasicAttribute("info", "Registro IdentityManagement");

                     mods[0] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod0);
                     //mods[1] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod1);

                     ldapContext.modifyAttributes(in_cn, mods);
		     out_result="Success";
               
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_userAccountControl</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cert_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessAdd_ControlCount_AD</name>
                    <byteCode>yv66vgAAADIA4gkAPwCFCQA/AIYJAD8AhwkAPwCICQA/AIkJAD8AigkAPwCLCQA/AIwJAD8AjQkAPwCOCQA/AI8JAD8AkAkAPwCRCQA/AJIJAD8AkwoAQACUCACVBwCWCgASAJcIAJgKAJkAmggAmwoAnACdCACeBwCfCgAZAJQIAKAKABkAoQgAoggAowoAGQCkCgASAKUIAKYIAKcIAKgIAKkIAKoIAKsIAKwIAK0IAK4KAK8AsAgAsQgAsgcAswoALQC0CAC1BwC2BwC3CAC4CgAxALkKADAAugsAuwC8CAC9CwC7AL4KAD8AvwoAPwDACADBCADCCgAZAMMKAMQAxQgAxgcAxwcAyAEACWluX3VzZXJETgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAEWluX3NBTUFjY291bnROYW1lAQAJaW5fc2VydmVyAQAHaW5fcG9ydAEABWluX2RuAQANaW5fZW1wbG95ZWVpZAEAFWluX0dyb3Vwc19Ub19BZGRfdXNlcgEABWluX2NuAQAVaW5fdXNlckFjY291bnRDb250cm9sAQALaW5fY2VydF9sb2MBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBABhnZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBABhzZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBAAhnZXRpbl9jbgEACHNldGluX2NuAQAYZ2V0aW5fdXNlckFjY291bnRDb250cm9sAQAYc2V0aW5fdXNlckFjY291bnRDb250cm9sAQAOZ2V0aW5fY2VydF9sb2MBAA5zZXRpbl9jZXJ0X2xvYwEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAA1nZXRvdXRfcmVzdWx0AQANc2V0b3V0X3Jlc3VsdAEABjxpbml0PgEAAygpVgEABmludm9rZQEADVN0YWNrTWFwVGFibGUHAJYHAMcHAMkBAApFeGNlcHRpb25zBwDKAQAWY29udmVydFRvQmluZGluZ1N0cmluZwEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBABVjb252ZXJ0VG9EYXNoZWRTdHJpbmcBAAtwcmVmaXhaZXJvcwEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAE2NvbnZlcnRUb0J5dGVTdHJpbmcHAJ8BAApTb3VyY2VGaWxlAQBGRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzc0FkZF9Db250cm9sQ291bnRfQUQuamF2YQwAQQBCDABDAEIMAEQAQgwARQBCDABGAEIMAEcAQgwASABCDABJAEIMAEoAQgwASwBCDABMAEIMAE0AQgwATgBCDABPAEIMAFAAQgwAcwB0AQAAAQATamF2YS91dGlsL0hhc2h0YWJsZQwAcwDLAQADNjM2BwDMDADNAM4BABhqYXZheC5uZXQuc3NsLnRydXN0U3RvcmUHAM8MANAA0QEAGGphdmEubmFtaW5nLnByb3ZpZGVyLnVybAEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyAQAHbGRhcDovLwwA0gDTAQABOgEAAzM4OQwA1ABSDADVANYBABtqYXZhLm5hbWluZy5mYWN0b3J5LmluaXRpYWwBACBjb20uc3VuLmpuZGkubGRhcC5MZGFwQ3R4RmFjdG9yeQEAHWphdmEubmFtaW5nLnNlY3VyaXR5LnByb3RvY29sAQADc3NsAQAjamF2YS5uYW1pbmcuc2VjdXJpdHkuYXV0aGVudGljYXRpb24BAAZzaW1wbGUBAB5qYXZhLm5hbWluZy5zZWN1cml0eS5wcmluY2lwYWwBACBqYXZhLm5hbWluZy5zZWN1cml0eS5jcmVkZW50aWFscwEALXRpYmNvLmNsaWVudFZhci5Db25uZWN0aW9ucy9MREFQL0ludGVybm8vUGFzcwcA1wwA2ADZAQAiamF2YS5uYW1pbmcubGRhcC5hdHRyaWJ1dGVzLmJpbmFyeQEACm9iamVjdEdVSUQBAChqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0luaXRpYWxEaXJDb250ZXh0DABzANoBAAVFcnJvcgEAJ2phdmF4L25hbWluZy9kaXJlY3RvcnkvTW9kaWZpY2F0aW9uSXRlbQEAJWphdmF4L25hbWluZy9kaXJlY3RvcnkvQmFzaWNBdHRyaWJ1dGUBABJ1c2VyQWNjb3VudENvbnRyb2wMAHMA2wwAcwDcBwDJDADdAN4BAAdTdWNjZXNzDADfAHQMAH4AfQwAfwCAAQABLQEAATAMAHMAVgcA4AwA4QCAAQABXAEAq1Blb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzQWRkX0NvbnRyb2xDb3VudF9BRAEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAEKEkpVgEAEGphdmEvbGFuZy9TdHJpbmcBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBqYXZhL2xhbmcvU3lzdGVtAQALc2V0UHJvcGVydHkBADgoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09i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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBEROFF"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="concat('cn=',$cnUser/cnUser_Value,',', $dnPrincipal/dnToOperate)"/>
                </in_cn>
                <xsl:choose>
                    <xsl:when test="(substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega and substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,1)!=substring($_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega,1,1)) or substring($Start/pfx7:EMPLOYEE/pfx7:AtributoAdicional, 1,2) = $_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoOficina or substring($Start/pfx7:EMPLOYEE/pfx7:AtributoAdicional, 1,2) = $_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega">
                        <in_userAccountControl>
                            <xsl:value-of select="'512'"/>
                        </in_userAccountControl>
                    </xsl:when>
                    <xsl:when test="(substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda or substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)= $_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega or substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,1)= substring($_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega,1,1))  and substring($Start/pfx7:EMPLOYEE/pfx7:AtributoAdicional, 1,2) !=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoOficina">
                        <in_userAccountControl>
                            <xsl:value-of select="'66048'"/>
                        </in_userAccountControl>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_userAccountControl>
                            <xsl:value-of select="'512'"/>
                        </in_userAccountControl>
                    </xsl:otherwise>
                </xsl:choose>
                <in_cert_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_cert_loc>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Assign-Grupos-1">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>264</pd:x>
        <pd:y>243</pd:y>
        <config>
            <variableName>memeberFrom_AD</variableName>
        </config>
        <pd:inputBindings>
            <memberString_from_Ad>
                <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_member"/>
            </memberString_from_Ad>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Mod_Employee_LDAP-2">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>761</pd:x>
        <pd:y>245</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessMod_Employee_LDAP2</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.*;
import javax.naming.*;
import javax.naming.directory.*;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessMod_Employee_LDAP2{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_entry_dn = "";
	protected String in_cn_user = "";
	protected String in_samAccountName = "";
	protected String in_sn = "";
	protected String in_mail = "";
	protected String in_telephone = "";
	protected String in_useraccountcontrol = "";
	protected String in_givenname = "";
	protected String in_displayname = "";
	protected String in_employeenumber = "";
	protected String in_employetype = "";
	protected String in_userprincipalname = "";
	protected String in_departamentnumber = "";
	protected String in_location = "";
	protected String in_title = "";
	protected String in_physicaldeliveryofficename = "";
	protected String in_departament = "";
	protected String in_company = "";
	protected String in_description = "";
	protected String in_info = "";
	protected String in_name = "";
	protected String in_complete_name = "";
	protected String in_password = "";
	protected String in_cn = "";
	protected String in_cert_loc = "";
	protected String poBoxData = "";
	protected String jobCode = "";
	protected String in_poBoxFromAD = "";
	protected String manager_cn = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected int out_error = 0;
	protected String out_email = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_entry_dn() {
		return in_entry_dn;
	}
	public void setin_entry_dn(String val) {
		in_entry_dn = val;
	}
	public String getin_cn_user() {
		return in_cn_user;
	}
	public void setin_cn_user(String val) {
		in_cn_user = val;
	}
	public String getin_samAccountName() {
		return in_samAccountName;
	}
	public void setin_samAccountName(String val) {
		in_samAccountName = val;
	}
	public String getin_sn() {
		return in_sn;
	}
	public void setin_sn(String val) {
		in_sn = val;
	}
	public String getin_mail() {
		return in_mail;
	}
	public void setin_mail(String val) {
		in_mail = val;
	}
	public String getin_telephone() {
		return in_telephone;
	}
	public void setin_telephone(String val) {
		in_telephone = val;
	}
	public String getin_useraccountcontrol() {
		return in_useraccountcontrol;
	}
	public void setin_useraccountcontrol(String val) {
		in_useraccountcontrol = val;
	}
	public String getin_givenname() {
		return in_givenname;
	}
	public void setin_givenname(String val) {
		in_givenname = val;
	}
	public String getin_displayname() {
		return in_displayname;
	}
	public void setin_displayname(String val) {
		in_displayname = val;
	}
	public String getin_employeenumber() {
		return in_employeenumber;
	}
	public void setin_employeenumber(String val) {
		in_employeenumber = val;
	}
	public String getin_employetype() {
		return in_employetype;
	}
	public void setin_employetype(String val) {
		in_employetype = val;
	}
	public String getin_userprincipalname() {
		return in_userprincipalname;
	}
	public void setin_userprincipalname(String val) {
		in_userprincipalname = val;
	}
	public String getin_departamentnumber() {
		return in_departamentnumber;
	}
	public void setin_departamentnumber(String val) {
		in_departamentnumber = val;
	}
	public String getin_location() {
		return in_location;
	}
	public void setin_location(String val) {
		in_location = val;
	}
	public String getin_title() {
		return in_title;
	}
	public void setin_title(String val) {
		in_title = val;
	}
	public String getin_physicaldeliveryofficename() {
		return in_physicaldeliveryofficename;
	}
	public void setin_physicaldeliveryofficename(String val) {
		in_physicaldeliveryofficename = val;
	}
	public String getin_departament() {
		return in_departament;
	}
	public void setin_departament(String val) {
		in_departament = val;
	}
	public String getin_company() {
		return in_company;
	}
	public void setin_company(String val) {
		in_company = val;
	}
	public String getin_description() {
		return in_description;
	}
	public void setin_description(String val) {
		in_description = val;
	}
	public String getin_info() {
		return in_info;
	}
	public void setin_info(String val) {
		in_info = val;
	}
	public String getin_name() {
		return in_name;
	}
	public void setin_name(String val) {
		in_name = val;
	}
	public String getin_complete_name() {
		return in_complete_name;
	}
	public void setin_complete_name(String val) {
		in_complete_name = val;
	}
	public String getin_password() {
		return in_password;
	}
	public void setin_password(String val) {
		in_password = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getin_cert_loc() {
		return in_cert_loc;
	}
	public void setin_cert_loc(String val) {
		in_cert_loc = val;
	}
	public String getpoBoxData() {
		return poBoxData;
	}
	public void setpoBoxData(String val) {
		poBoxData = val;
	}
	public String getjobCode() {
		return jobCode;
	}
	public void setjobCode(String val) {
		jobCode = val;
	}
	public String getin_poBoxFromAD() {
		return in_poBoxFromAD;
	}
	public void setin_poBoxFromAD(String val) {
		in_poBoxFromAD = val;
	}
	public String getmanager_cn() {
		return manager_cn;
	}
	public void setmanager_cn(String val) {
		manager_cn = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public int getout_error() {
		return out_error;
	}
	public void setout_error(int val) {
		out_error = val;
	}
	public String getout_email() {
		return out_email;
	}
	public void setout_email(String val) {
		out_email = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessMod_Employee_LDAP2() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_entry_dn
	In  : String in_cn_user
	In  : String in_samAccountName
	In  : String in_sn
	In  : String in_mail
	In  : String in_telephone
	In  : String in_useraccountcontrol
	In  : String in_givenname
	In  : String in_displayname
	In  : String in_employeenumber
	In  : String in_employetype
	In  : String in_userprincipalname
	In  : String in_departamentnumber
	In  : String in_location
	In  : String in_title
	In  : String in_physicaldeliveryofficename
	In  : String in_departament
	In  : String in_company
	In  : String in_description
	In  : String in_info
	In  : String in_name
	In  : String in_complete_name
	In  : String in_password
	In  : String in_cn
	In  : String in_cert_loc
	In  : String poBoxData
	In  : String jobCode
	In  : String in_poBoxFromAD
	In  : String manager_cn
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : int out_error
	Out : String out_email
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/
             
		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);


              if (in_port.equals("636")) {
                  String keystore=in_cert_loc;
                  //  String keystore="/opt/tibco/tibcojre64/1.8.0/lib/security/cacerts2";
                   //"\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";
                  
                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }


	      
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      
              ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
              
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);
             //try {
  
              if (in_mail.equals("")) {
                 in_mail=" ";
              }
              if (in_mail==null) {
                 in_mail=" ";
              }
	      if (in_telephone==null) {
              in_telephone="0";
              }
	      if (in_telephone.equals("")) {
              in_telephone="0";
              }

                out_email=in_mail;
                
              
 		
              out_result="Error";
               if (!in_cn.equals("")) {

                   int sizemods=11;
                   if (manager_cn!=null  &amp;&amp; !manager_cn.isEmpty()  &amp;&amp; !manager_cn.equals("")) {
                      sizemods=12;
                   }
                   if (poBoxData.contains(jobCode) || in_poBoxFromAD.length()&gt;0 || poBoxData.contains("TTT") ) {
                      //sizemods=13;
                    }
                   ModificationItem mods[] = new ModificationItem[sizemods];
                   

                     //Attribute mod0 = new BasicAttribute("givenName", in_givenname);
                     //Attribute mod1 = new BasicAttribute("displayName", in_displayname);
                     Attribute mod2 = new BasicAttribute("employeeNumber", in_employeenumber);
                     Attribute mod3 = new BasicAttribute("employeeType", in_employetype);

                     Attribute mod4 = new BasicAttribute("userAccountControl", in_useraccountcontrol);

                     //Attribute mod5 = new BasicAttribute("userPrincipalName", in_userprincipalname);
                     Attribute mod7 = new BasicAttribute("departmentNumber", in_departamentnumber);
                     Attribute mod9 = new BasicAttribute("title", in_title);
                     Attribute mod10 = new BasicAttribute("physicaldeliveryOfficeName", in_physicaldeliveryofficename);
                     Attribute mod11 = new BasicAttribute("department", in_departament);
                     Attribute mod13 = new BasicAttribute("telephoneNumber", in_telephone);  //Qui 
                     Attribute mod14 = new BasicAttribute("description", in_description);

                     //Attribute mod6 = new BasicAttribute("mail", in_mail);  //Quitar
                     Attribute mod8 = new BasicAttribute("l", in_location); //Quitar
                     Attribute mod12 = new BasicAttribute("company", in_company); //Quitar Localizacion
                     
                     Attribute mod16=null;
    
                     if (manager_cn!=null  &amp;&amp; !manager_cn.isEmpty()  &amp;&amp; !manager_cn.equals("")) {
                         mod16 = new BasicAttribute("manager", manager_cn); 
                     }
                     //Attribute mod13 = new BasicAttribute("telephoneNumber", in_telephone);  //Quitar Actualizacion
                     //Attribute mod15 = new BasicAttribute("info", "Registro(M) IdentityManagement");

                     //mods[0] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod0);
                     //mods[1] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod1);
                     mods[0] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod13);
                     mods[1] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod2);
                     mods[2] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod3);
                     mods[3] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod4);
                     //mods[4] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod5);
                     //mods[6] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod6);
                     mods[4] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod7);
                     mods[5] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod8);
                     mods[6] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod9);
                     mods[7] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod10);
                     mods[8] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod11);
                     mods[9] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod12);
                     //mods[13] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod13);
                     mods[10] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod14);

                     if (manager_cn!=null  &amp;&amp; !manager_cn.isEmpty()  &amp;&amp; !manager_cn.equals("")) {
                         mods[11] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod16);
                     }
                     //mods[15] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod15);

                     /*if (poBoxData.contains(jobCode) || poBoxData.contains("TTT")) {
                        Attribute addAtr01 = new BasicAttribute("postOfficeBox", in_samAccountName);
                        mods[12] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, addAtr01);
                     } else {
                       if (in_poBoxFromAD.length()&gt;0) {
                           Attribute addAtr01 = new BasicAttribute("postOfficeBox", " ");
                           mods[12] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, addAtr01);
                       }
                     }*/
                     ldapContext.modifyAttributes(in_cn, mods);
		     out_result="Success";
               
              }              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_error</fieldName>
                    <fieldType>int</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_email</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_entry_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_mail</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_telephone</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_useraccountcontrol</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_givenname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_displayname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeenumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employetype</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_userprincipalname</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_departamentnumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_location</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_title</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_physicaldeliveryofficename</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_departament</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_company</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_description</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_info</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_name</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_complete_name</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_password</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cert_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>poBoxData</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>jobCode</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_poBoxFromAD</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>manager_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>optional</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessMod_Employee_LDAP2</name>
                    <byteCode>yv66vgAAADMBlAkAagEGCQBqAQcJAGoBCAkAagEJCQBqAQoJAGoBCwkAagEMCQBqAQ0JAGoBDgkAagEPCQBqARAJAGoBEQkAagESCQBqARMJAGoBFAkAagEVCQBqARYJAGoBFwkAagEYCQBqARkJAGoBGgkAagEbCQBqARwJAGoBHQkAagEeCQBqAR8JAGoBIAkAagEhCQBqASIJAGoBIwkAagEkCQBqASUJAGoBJgkAagEnCQBqASgJAGoBKQkAagEqCQBqASsJAGoBLAkAagEtCQBqAS4JAGoBLwoAawEwCAExBwEyCgAtATMIATQKATUBNggBNwoBOAE5CAE6BwE7CgA0ATAIATwKADQBPQgBPggBPwoANAFACgAtAUEIAUIIAUMIAUQIAUUIAUYIAUcIAUgIAUkIAUoKAUsBTAgBTQgBTgcBTwoASAFQCAFRCAFSCAFTCgE1AVQKATUBVQoBNQFWCAFXBwFYBwFZCAFaCgBSAVsIAVwIAV0IAV4IAV8IAWAIAWEIAWIIAWMIAWQIAWUIAWYKAFEBZwsBaAFpCAFqCwFoAWsKAGoBbAoAagFtCAFuCgA0AW8KAXABcQgBcgcBcwcBdAEACWluX3VzZXJETgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAEWluX3NBTUFjY291bnROYW1lAQAJaW5fc2VydmVyAQAHaW5fcG9ydAEABWluX2RuAQANaW5fZW1wbG95ZWVpZAEAC2luX2VudHJ5X2RuAQAKaW5fY25fdXNlcgEAEWluX3NhbUFjY291bnROYW1lAQAFaW5fc24BAAdpbl9tYWlsAQAMaW5fdGVsZXBob25lAQAVaW5fdXNlcmFjY291bnRjb250cm9sAQAMaW5fZ2l2ZW5uYW1lAQAOaW5fZGlzcGxheW5hbWUBABFpbl9lbXBsb3llZW51bWJlcgEADmluX2VtcGxveWV0eXBlAQAUaW5fdXNlcnByaW5jaXBhbG5hbWUBABRpbl9kZXBhcnRhbWVudG51bWJlcgEAC2luX2xvY2F0aW9uAQAIaW5fdGl0bGUBAB1pbl9waHlzaWNhbGRlbGl2ZXJ5b2ZmaWNlbmFtZQEADmluX2RlcGFydGFtZW50AQAKaW5fY29tcGFueQEADmluX2Rlc2NyaXB0aW9uAQAHaW5faW5mbwEAB2luX25hbWUBABBpbl9jb21wbGV0ZV9uYW1lAQALaW5fcGFzc3dvcmQBAAVpbl9jbgEAC2luX2NlcnRfbG9jAQAJcG9Cb3hEYXRhAQAHam9iQ29kZQEADmluX3BvQm94RnJvbUFEAQAKbWFuYWdlcl9jbgEACG91dF9ndWlkAQAGb3V0X2RuAQAGb3V0X2NuAQASb3V0X3NhbUFjY291bnROYW1lAQAJb3V0X2Vycm9yAQABSQEACW91dF9lbWFpbAEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBAA5nZXRpbl9lbnRyeV9kbgEADnNldGluX2VudHJ5X2RuAQANZ2V0aW5fY25fdXNlcgEADXNldGluX2NuX3VzZXIBABRnZXRpbl9zYW1BY2NvdW50TmFtZQEAFHNldGluX3NhbUFjY291bnROYW1lAQAIZ2V0aW5fc24BAAhzZXRpbl9zbgEACmdldGluX21haWwBAApzZXRpbl9tYWlsAQAPZ2V0aW5fdGVsZXBob25lAQAPc2V0aW5fdGVsZXBob25lAQAYZ2V0aW5fdXNlcmFjY291bnRjb250cm9sAQAYc2V0aW5fdXNlcmFjY291bnRjb250cm9sAQAPZ2V0aW5fZ2l2ZW5uYW1lAQAPc2V0aW5fZ2l2ZW5uYW1lAQARZ2V0aW5fZGlzcGxheW5hbWUBABFzZXRpbl9kaXNwbGF5bmFtZQEAFGdldGluX2VtcGxveWVlbnVtYmVyAQAUc2V0aW5fZW1wbG95ZWVudW1iZXIBABFnZXRpbl9lbXBsb3lldHlwZQEAEXNldGluX2VtcGxveWV0eXBlAQAXZ2V0aW5fdXNlcnByaW5jaXBhbG5hbWUBABdzZXRpbl91c2VycHJpbmNpcGFsbmFtZQEAF2dldGluX2RlcGFydGFtZW50bnVtYmVyAQAXc2V0aW5fZGVwYXJ0YW1lbnRudW1iZXIBAA5nZXRpbl9sb2NhdGlvbgEADnNldGluX2xvY2F0aW9uAQALZ2V0aW5fdGl0bGUBAAtzZXRpbl90aXRsZQEAIGdldGluX3BoeXNpY2FsZGVsaXZlcnlvZmZpY2VuYW1lAQAgc2V0aW5fcGh5c2ljYWxkZWxpdmVyeW9mZmljZW5hbWUBABFnZXRpbl9kZXBhcnRhbWVudAEAEXNldGluX2RlcGFydGFtZW50AQANZ2V0aW5fY29tcGFueQEADXNldGluX2NvbXBhbnkBABFnZXRpbl9kZXNjcmlwdGlvbgEAEXNldGluX2Rlc2NyaXB0aW9uAQAKZ2V0aW5faW5mbwEACnNldGluX2luZm8BAApnZXRpbl9uYW1lAQAKc2V0aW5fbmFtZQEAE2dldGluX2NvbXBsZXRlX25hbWUBABNzZXRpbl9jb21wbGV0ZV9uYW1lAQAOZ2V0aW5fcGFzc3dvcmQBAA5zZXRpbl9wYXNzd29yZAEACGdldGluX2NuAQAIc2V0aW5fY24BAA5nZXRpbl9jZXJ0X2xvYwEADnNldGluX2NlcnRfbG9jAQAMZ2V0cG9Cb3hEYXRhAQAMc2V0cG9Cb3hEYXRhAQAKZ2V0am9iQ29kZQEACnNldGpvYkNvZGUBABFnZXRpbl9wb0JveEZyb21BRAEAEXNldGluX3BvQm94RnJvbUFEAQANZ2V0bWFuYWdlcl9jbgEADXNldG1hbmFnZXJfY24BAAtnZXRvdXRfZ3VpZAEAC3NldG91dF9ndWlkAQAJZ2V0b3V0X2RuAQAJc2V0b3V0X2RuAQAJZ2V0b3V0X2NuAQAJc2V0b3V0X2NuAQAVZ2V0b3V0X3NhbUFjY291bnROYW1lAQAVc2V0b3V0X3NhbUFjY291bnROYW1lAQAMZ2V0b3V0X2Vycm9yAQADKClJAQAMc2V0b3V0X2Vycm9yAQAEKEkpVgEADGdldG91dF9lbWFpbAEADHNldG91dF9lbWFpbAEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcBMgcBcwcBdQcBdgcBdwEACkV4Y2VwdGlvbnMHAXgBABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcBOwEAClNvdXJjZUZpbGUBAEVFbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzTW9kX0VtcGxveWVlX0xEQVAyLmphdmEMAGwAbQwAbgBtDABvAG0MAHAAbQwAcQBtDAByAG0MAHMAbQwAdABtDAB1AG0MAHYAbQwAdwBtDAB4AG0MAHkAbQwAegBtDAB7AG0MAHwAbQwAfQBtDAB+AG0MAH8AbQwAgABtDACBAG0MAIIAbQwAgwBtDACEAG0MAIUAbQwAhgBtDACHAG0MAIgAbQwAiQBtDACKAG0MAIsAbQwAjABtDACNAG0MAI4AbQwAjwBtDACQAG0MAJEAbQwAkgBtDACTAG0MAJQAlQwAlgBtDACXAG0MAPIA8wEAAAEAE2phdmEvdXRpbC9IYXNodGFibGUMAPIA7QEAAzYzNgcBeQwBegF7AQAYamF2YXgubmV0LnNzbC50cnVzdFN0b3JlBwF8DAF9AX4BABhqYXZhLm5hbWluZy5wcm92aWRlci51cmwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAB2xkYXA6Ly8MAX8BgAEAAToBAAMzODkMAYEAmQwBggGDAQAbamF2YS5uYW1pbmcuZmFjdG9yeS5pbml0aWFsAQAgY29tLnN1bi5qbmRpLmxkYXAuTGRhcEN0eEZhY3RvcnkBAB1qYXZhLm5hbWluZy5zZWN1cml0eS5wcm90b2NvbAEAA3NzbAEAI2phdmEubmFtaW5nLnNlY3VyaXR5LmF1dGhlbnRpY2F0aW9uAQAGc2ltcGxlAQAeamF2YS5uYW1pbmcuc2VjdXJpdHkucHJpbmNpcGFsAQAgamF2YS5uYW1pbmcuc2VjdXJpdHkuY3JlZGVudGlhbHMBAC10aWJjby5jbGllbnRWYXIuQ29ubmVjdGlvbnMvTERBUC9JbnRlcm5vL1Bhc3MHAYQMAYUBhgEAImphdmEubmFtaW5nLmxkYXAuYXR0cmlidXRlcy5iaW5hcnkBAApvYmplY3RHVUlEAQAoamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Jbml0aWFsRGlyQ29udGV4dAwA8gGHAQABIAEAATABAAVFcnJvcgwBiAGJDAGKAYsMAYwA6wEAA1RUVAEAJ2phdmF4L25hbWluZy9kaXJlY3RvcnkvTW9kaWZpY2F0aW9uSXRlbQEAJWphdmF4L25hbWluZy9kaXJlY3RvcnkvQmFzaWNBdHRyaWJ1dGUBAA5lbXBsb3llZU51bWJlcgwA8gGNAQAMZW1wbG95ZWVUeXBlAQASdXNlckFjY291bnRDb250cm9sAQAQZGVwYXJ0bWVudE51bWJlcgEABXRpdGxlAQAacGh5c2ljYWxkZWxpdmVyeU9mZmljZU5hbWUBAApkZXBhcnRtZW50AQAPdGVsZXBob25lTnVtYmVyAQALZGVzY3JpcHRpb24BAAFsAQAHY29tcGFueQEAB21hbmFnZXIMAPIBjgcBdQwBjwGQAQAHU3VjY2VzcwwBkQDzDAD/AP4MAQABAQEAAS0MAPIAnQcBkgwBkwEBAQABXAEAqlBlb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzTW9kX0VtcGxveWVlX0xEQVAyAQAQamF2YS9sYW5nL09iamVjdAEAIWphdmF4L25hbWluZy9kaXJlY3RvcnkvRGlyQ29udGV4dAEAKltMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtOwEAIGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEGphdmEvbGFuZy9TdHJpbmcBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBqYXZhL2xhbmcvU3lzdGVtAQALc2V0UHJvcGVydHkBADgoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBACRjb20vdGliY28vcGUvcGx1Z2luL1BsdWdpblByb3BlcnRpZXMBAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAYKExqYXZhL3V0aWwvSGFzaHRhYmxlOylWAQAHaXNFbXB0eQEAAygpWgEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaAQAGbGVuZ3RoAQAnKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0OylWAQAmKElMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9BdHRyaWJ1dGU7KVYBABBtb2RpZnlBdHRyaWJ1dGVzAQA/KExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtOylWAQAFY2xvc2UBABFqYXZhL2xhbmcvSW50ZWdlcgEAC3RvSGV4U3RyaW5nACEAagBrAAAAKgAEAGwAbQAAAAQAbgBtAAAABABvAG0AAAAEAHAAbQAAAAQAcQBtAAAABAByAG0AAAAEAHMAbQAAAAQAdABtAAAABAB1AG0AAAAEAHYAbQAAAAQAdwBtAAAABAB4AG0AAAAEAHkAbQAAAAQAegBtAAAABAB7AG0AAAAEAHwAbQAAAAQAfQBtAAAABAB+AG0AAAAEAH8AbQAAAAQAgABtAAAABACBAG0AAAAEAIIAbQAAAAQAgwBtAAAABACEAG0AAAAEAIUAbQAAAAQAhgBtAAAABACHAG0AAAAEAIgAbQAAAAQAiQBtAAAABACKAG0AAAAEAIsAbQAAAAQAjABtAAAABACNAG0AAAAEAI4AbQAAAAQAjwBtAAAABACQAG0AAAAEAJEAbQAAAAQAkgBtAAAABACTAG0AAAAE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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/SecurePort"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_entry_dn>
                    <xsl:value-of select="translate(concat('cn=',$cnUser/cnUser_Value,',', $dnPrincipal/dnToOperate),'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  ')"/>
                </in_entry_dn>
                <in_cn_user>
                    <xsl:value-of select="translate($cnUser/cnUser_Value,'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  ')"/>
                </in_cn_user>
                <in_samAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_samAccountName>
                <in_sn>
                    <xsl:value-of select="translate(translate($Start/pfx7:EMPLOYEE/pfx7:SURNAME,'ÑñáéíóúÁÉÍÓÚ#±´?','NnaeiouAEIOU n  '),'%','')"/>
                </in_sn>
                <xsl:choose>
                    <xsl:when test="$Start/pfx7:EMPLOYEE/pfx7:EMAIL_ADDR!=&quot;&quot;">
                        <in_mail>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMAIL_ADDR"/>
                        </in_mail>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_mail>
                            <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_mail"/>
                        </in_mail>
                    </xsl:otherwise>
                </xsl:choose>
                <xsl:choose>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)>0 and string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)=0">
                        <in_telephone>
                            <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre1_Tienda, substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 4,2),' ',$_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre2_Tienda)"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)=0 and string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)>0">
                        <in_telephone>
                            <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre1_Tienda, substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 4,2),' ',$_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre2_Tienda)"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)=0 and string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)=0">
                        <in_telephone>
                            <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre1_Tienda, substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 4,2),' ',$_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre2_Tienda)"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and string-length($Start/pfx7:EMPLOYEE/pfx7:PHONE)>0 and string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)>0">
                        <in_telephone>
                            <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre1_Tienda, substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 4,2),' ',$_globalVariables/ns:GlobalVariables/ProjectConfig/TelPre2_Tienda)"/>
                        </in_telephone>
                    </xsl:when>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                        <xsl:choose>
                            <xsl:when test="string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)>0 and $Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber!='0'">
                                <in_telephone>
                                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber"/>
                                </in_telephone>
                            </xsl:when>
                            <xsl:when test="string-length($Start/pfx7:EMPLOYEE/pfx7:PHONEASIG)>0 and (string-length($Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber)=0 or $Search-ID_LDAP/javaCodeActivityOutput/out_telephoneNumber='0')">
                                <in_telephone>
                                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONEASIG"/>
                                </in_telephone>
                            </xsl:when>
                            <xsl:otherwise>
                                <in_telephone>
                                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONE"/>
                                </in_telephone>
                            </xsl:otherwise>
                        </xsl:choose>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_telephone>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PHONEASIG"/>
                        </in_telephone>
                    </xsl:otherwise>
                </xsl:choose>
                <xsl:choose>
                    <xsl:when test="(substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda and substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega and substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,1)!=substring($_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega,1,1)) or substring($Start/pfx7:EMPLOYEE/pfx7:AtributoAdicional, 1,2) = $_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoOficina or substring($Start/pfx7:EMPLOYEE/pfx7:AtributoAdicional, 1,2) = $_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoBodega">
                        <in_useraccountcontrol>
                            <xsl:value-of select="512"/>
                        </in_useraccountcontrol>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_useraccountcontrol>
                            <xsl:value-of select="66048"/>
                        </in_useraccountcontrol>
                    </xsl:otherwise>
                </xsl:choose>
                <in_givenname>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:GIVENAME"/>
                </in_givenname>
                <in_displayname>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                </in_displayname>
                <in_employeenumber>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:PRIMARY_NID"/>
                </in_employeenumber>
                <in_employetype>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPLOYEE_TYPE"/>
                </in_employetype>
                <in_userprincipalname>
                    <xsl:value-of select="concat($Map-Data/login,'@ad.heb.com.mx')"/>
                </in_userprincipalname>
                <in_departamentnumber>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DEPT_ID"/>
                </in_departamentnumber>
                <xsl:choose>
                    <xsl:when test="string-length($Start/pfx7:EMPLOYEE/pfx7:CITY)>0">
                        <in_location>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:CITY"/>
                        </in_location>
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:choose>
                            <xsl:when test="string-length($Search-ID_LDAP/javaCodeActivityOutput/out_location)>0">
                                <in_location>
                                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_location"/>
                                </in_location>
                            </xsl:when>
                            <xsl:otherwise>
                                <in_location>
                                    <xsl:value-of select="&quot; &quot;"/>
                                </in_location>
                            </xsl:otherwise>
                        </xsl:choose>
                    </xsl:otherwise>
                </xsl:choose>
                <in_title>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:JOBCODE_DESCR"/>
                </in_title>
                <xsl:choose>
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                        <in_physicaldeliveryofficename>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:LOCATION_DESCR"/>
                        </in_physicaldeliveryofficename>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_physicaldeliveryofficename>
                            <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_physicaldeliveryOfficeName"/>
                        </in_physicaldeliveryofficename>
                    </xsl:otherwise>
                </xsl:choose>
                <in_departament>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DEP_DESCR"/>
                </in_departament>
                <xsl:choose>
                    <xsl:when test="string-length($Search-ID_LDAP/javaCodeActivityOutput/out_company)>0">
                        <in_company>
                            <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_company"/>
                        </in_company>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_company>
                            <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:COMPANY_DESCR"/>
                        </in_company>
                    </xsl:otherwise>
                </xsl:choose>
                <in_description>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:JOBCODE_DESCR"/>
                </in_description>
                <in_info>
                    <xsl:value-of select="&quot; &quot;"/>
                </in_info>
                <in_name>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:DISPLAY_NAME"/>
                </in_name>
                <in_complete_name>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:NAME"/>
                </in_complete_name>
                <xsl:choose xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
                    <xsl:when test="substring($Start/pfx7:EMPLOYEE/pfx7:LOCATION_ID, 1,2)!=$_globalVariables/ns:GlobalVariables/ProjectConfig/PrefijoTienda">
                        <in_password>
                            <xsl:value-of select="concat($Map-Data/login,upper-case($Start/pfx7:EMPLOYEE/pfx7:NATIONAL_ID))"/>
                        </in_password>
                    </xsl:when>
                    <xsl:otherwise>
                        <in_password>
                            <xsl:value-of select="concat($Map-Data/login,upper-case($Start/pfx7:EMPLOYEE/pfx7:NATIONAL_ID))"/>
                        </in_password>
                    </xsl:otherwise>
                </xsl:choose>
                <in_cn>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_dn"/>
                </in_cn>
                <in_cert_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_cert_loc>
                <poBoxData>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/PoBox_JobCodes"/>
                </poBoxData>
                <jobCode>
                    <xsl:value-of select="concat($Start/pfx7:EMPLOYEE/pfx7:DEPT_ID ,$Start/pfx7:EMPLOYEE/pfx7:JOB_CD)"/>
                </jobCode>
                <in_poBoxFromAD>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_poBox"/>
                </in_poBoxFromAD>
                <manager_cn>
                    <xsl:value-of select="$Search-ID_MANAGER/javaCodeActivityOutput/out_dn"/>
                </manager_cn>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Baja_Count_AD">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>705</pd:x>
        <pd:y>385</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessBaja_Count_AD</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.*;
import javax.naming.*;
import javax.naming.directory.*;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessBaja_Count_AD{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String in_userAccountControl = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getin_userAccountControl() {
		return in_userAccountControl;
	}
	public void setin_userAccountControl(String val) {
		in_userAccountControl = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessBaja_Count_AD() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String in_userAccountControl
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/
             
              DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

              out_result="Error";
               if (!in_cn.equals("")) {
              
                   
                     ModificationItem mods[] = new ModificationItem[2];

                     String manager_cn=null;
                     Attribute mod0 = new BasicAttribute("userAccountControl", in_userAccountControl);
                     Attribute mod1 = new BasicAttribute("manager", manager_cn); 
                     //Attribute mod1 = new BasicAttribute("info", "Baja IdentityManagement");

                     mods[0] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod0);
                     mods[1] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod1);
                     //mods[1] = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, mod1);

                     ldapContext.modifyAttributes(in_cn, mods);
		     out_result="Success";
               
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_userAccountControl</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessBaja_Count_AD</name>
                    <byteCode>yv66vgAAADMAzgkAOQB7CQA5AHwJADkAfQkAOQB+CQA5AH8JADkAgAkAOQCBCQA5AIIJADkAgwkAOQCECQA5AIUJADkAhgkAOQCHCQA5AIgKADoAiQgAigcAiwoAEQCMCACNCACOCgARAI8IAJAHAJEKABcAiQgAkgoAFwCTCACUCgAXAJUIAJYIAJcIAJgIAJkIAJoKAJsAnAgAnQgAngcAnwoAJQCgCAChCgCiAKMHAKQHAKUIAKYKACoApwgAqAoAKQCpCwCqAKsIAKwLAKoArQoAOQCuCgA5AK8IALAIALEKABcAsgoAswC0CAC1BwC2BwC3AQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQAVaW5fR3JvdXBzX1RvX0FkZF91c2VyAQAFaW5fY24BABVpbl91c2VyQWNjb3VudENvbnRyb2wBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBABhnZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBABhzZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBAAhnZXRpbl9jbgEACHNldGluX2NuAQAYZ2V0aW5fdXNlckFjY291bnRDb250cm9sAQAYc2V0aW5fdXNlckFjY291bnRDb250cm9sAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcAuAcAiwEACkV4Y2VwdGlvbnMHALkBABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAkQEAClNvdXJjZUZpbGUBAEBFbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzQmFqYV9Db3VudF9BRC5qYXZhDAA7ADwMAD0APAwAPgA8DAA/ADwMAEAAPAwAQQA8DABCADwMAEMAPAwARAA8DABFADwMAEYAPAwARwA8DABIADwMAEkAPAwAagBrAQAAAQATamF2YS91dGlsL0hhc2h0YWJsZQwAagC6AQAbamF2YS5uYW1pbmcuZmFjdG9yeS5pbml0aWFsAQAgY29tLnN1bi5qbmRpLmxkYXAuTGRhcEN0eEZhY3RvcnkMALsAvAEAGGphdmEubmFtaW5nLnByb3ZpZGVyLnVybAEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyAQAHbGRhcDovLwwAvQC+AQABOgwAvwBLAQAjamF2YS5uYW1pbmcuc2VjdXJpdHkuYXV0aGVudGljYXRpb24BAAZzaW1wbGUBAB5qYXZhLm5hbWluZy5zZWN1cml0eS5wcmluY2lwYWwBACBqYXZhLm5hbWluZy5zZWN1cml0eS5jcmVkZW50aWFscwEALXRpYmNvLmNsaWVudFZhci5Db25uZWN0aW9ucy9MREFQL0ludGVybm8vUGFzcwcAwAwAwQDCAQAiamF2YS5uYW1pbmcubGRhcC5hdHRyaWJ1dGVzLmJpbmFyeQEACm9iamVjdEdVSUQBAChqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0luaXRpYWxEaXJDb250ZXh0DABqAMMBAAVFcnJvcgcAxAwAxQDGAQAnamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9CYXNpY0F0dHJpYnV0ZQEAEnVzZXJBY2NvdW50Q29udHJvbAwAagDHAQAHbWFuYWdlcgwAagDIBwC4DADJAMoBAAdTdWNjZXNzDADLAGsMAHQAcwwAdQB2AQABLQEAATAMAGoATwcAzAwAzQB2AQABXAEApVBlb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzQmFqYV9Db3VudF9BRAEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAEKEkpVgEAA3B1dAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBACRjb20vdGliY28vcGUvcGx1Z2luL1BsdWdpblByb3BlcnRpZXMBAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAYKExqYXZhL3V0aWwvSGFzaHRhYmxlOylWAQAQamF2YS9sYW5nL1N0cmluZwEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAJyhMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDspVgEAJihJTGphdmF4L25hbWluZy9kaXJlY3RvcnkvQXR0cmlidXRlOylWAQAQbW9kaWZ5QXR0cmlidXRlcwEAPyhMamF2YS9sYW5nL1N0cmluZztbTGphdmF4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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MEMBEROFF"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_dn"/>
                </in_cn>
                <in_userAccountControl>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/userAccountControlBaja"/>
                </in_userAccountControl>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="ErrorProcess (1)">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>374</pd:x>
        <pd:y>491</pd:y>
        <config>
            <processName>/Utility Services/Exception Handling/ErrorProcess (1).process</processName>
        </config>
        <pd:inputBindings>
            <Exception>
                <Domain>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Domain"/>
                </Domain>
                <Deployment>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Deployment"/>
                </Deployment>
                <Project>
                    <xsl:value-of select="$_processContext/ns2:ProcessContext/ProjectName"/>
                </Project>
                <EngineName>
                    <xsl:value-of select="$_processContext/ns2:ProcessContext/EngineName"/>
                </EngineName>
                <TimeStamp>
                    <xsl:value-of select="current-dateTime()"/>
                </TimeStamp>
                <xsl:if test="$_error/ns2:ErrorReport/MsgCode">
                    <Code>
                        <xsl:value-of select="$_error/ns2:ErrorReport/MsgCode"/>
                    </Code>
                </xsl:if>
                <Message>
                    <xsl:value-of select="concat(tib:render-xml($_error/ns2:ErrorReport, 0,0), ---'GruposRemove----',$Proccess_Groups/String_Final_Groups/Groups_To_Remove_AD)"/>
                </Message>
            </Exception>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Remove_Group_Employee_LDAP-1-1">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>493</pd:x>
        <pd:y>386</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP11</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.StringTokenizer;


public class Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP11{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_Groups_To_Add_user = "";
	protected String in_cn = "";
	protected String invalidChars = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_result = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_Groups_To_Add_user() {
		return in_Groups_To_Add_user;
	}
	public void setin_Groups_To_Add_user(String val) {
		in_Groups_To_Add_user = val;
	}
	public String getin_cn() {
		return in_cn;
	}
	public void setin_cn(String val) {
		in_cn = val;
	}
	public String getinvalidChars() {
		return invalidChars;
	}
	public void setinvalidChars(String val) {
		invalidChars = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_result() {
		return out_result;
	}
	public void setout_result(String val) {
		out_result = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP11() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_Groups_To_Add_user
	In  : String in_cn
	In  : String invalidChars
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_result
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
	      ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      
	      ldapContext = new InitialDirContext(ldapEnv);

               
               if (!in_cn.equals("")) {
                   if (!in_Groups_To_Add_user.contains("+")) {
                       in_Groups_To_Add_user=in_Groups_To_Add_user+"+";
                   }
               StringTokenizer tokenizerGroups = new StringTokenizer(in_Groups_To_Add_user,"+");
               
               String someChars=invalidChars;
               StringTokenizer someCharsTokenizer = new StringTokenizer(someChars,",");
               String InvalidString = "";
               while (someCharsTokenizer.hasMoreElements()) {
                     InvalidString = InvalidString + someCharsTokenizer.nextToken();
               }

               while (tokenizerGroups.hasMoreElements()) {
                   
                     ModificationItem mods[] = new ModificationItem[1];
                     mods[0]= new ModificationItem(DirContext.REMOVE_ATTRIBUTE, new BasicAttribute("member", in_cn));
                     
                     //update the group
                     String groupName;
                     
                     groupName = tokenizerGroups.nextToken();
                     //if (!groupName.equals("")) {
                     //	ldapContext.modifyAttributes(groupName,mods);
       		     //}
                     boolean agregarEspecial = false;
		          if (!groupName.equals("")) {
                              for (int j=0 ;j&lt;InvalidString.length();j++) {
                              if (groupName.contains(InvalidString.substring(j,j+1))) {
                                  agregarEspecial = true;
                              }
                              }
                              if (agregarEspecial) {
                     	         groupName="'"+groupName+"'";
                              } 
                              
                              ldapContext.modifyAttributes(groupName,mods);

                              
       		          }

               }
              }
	
              ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_result</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_Groups_To_Add_user</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>invalidChars</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessRemove_Group_Employee_LDAP11</name>
                    <byteCode>yv66vgAAADIA6wkAQACGCQBAAIcJAEAAiAkAQACJCQBAAIoJAEAAiwkAQACMCQBAAI0JAEAAjgkAQACPCQBAAJAJAEAAkQkAQACSCQBAAJMKAEEAlAgAlQcAlgoAEQCXCACYCACZCgARAJoIAJsHAJwKABcAlAgAnQoAFwCeCACfCgAXAKAIAKEIAKIIAKMIAKQIAKUKAKYApwgAqAgAqQcAqgoAJQCrCgCsAK0IAK4KAKwArwcAsAoAKgCxCACyCgAqALMKACoAtAcAtQcAtggAtwoAMAC4CgAvALkKAKwAugoArAC7CAC8CwC9AL4LAL0AvwoAQADACgBAAMEIAMIIAMMKABcAxAoAxQDGCADHBwDIBwDJAQAJaW5fdXNlckROAQASTGphdmEvbGFuZy9TdHJpbmc7AQARaW5fc0FNQWNjb3VudE5hbWUBAAlpbl9zZXJ2ZXIBAAdpbl9wb3J0AQAFaW5fZG4BAA1pbl9lbXBsb3llZWlkAQAVaW5fR3JvdXBzX1RvX0FkZF91c2VyAQAFaW5fY24BAAxpbnZhbGlkQ2hhcnMBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9yZXN1bHQBAAxnZXRpbl91c2VyRE4BABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAxzZXRpbl91c2VyRE4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRnZXRpbl9zQU1BY2NvdW50TmFtZQEAFHNldGluX3NBTUFjY291bnROYW1lAQAMZ2V0aW5fc2VydmVyAQAMc2V0aW5fc2VydmVyAQAKZ2V0aW5fcG9ydAEACnNldGluX3BvcnQBAAhnZXRpbl9kbgEACHNldGluX2RuAQAQZ2V0aW5fZW1wbG95ZWVpZAEAEHNldGluX2VtcGxveWVlaWQBABhnZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBABhzZXRpbl9Hcm91cHNfVG9fQWRkX3VzZXIBAAhnZXRpbl9jbgEACHNldGluX2NuAQAPZ2V0aW52YWxpZENoYXJzAQAPc2V0aW52YWxpZENoYXJzAQALZ2V0b3V0X2d1aWQBAAtzZXRvdXRfZ3VpZAEACWdldG91dF9kbgEACXNldG91dF9kbgEACWdldG91dF9jbgEACXNldG91dF9jbgEAFWdldG91dF9zYW1BY2NvdW50TmFtZQEAFXNldG91dF9zYW1BY2NvdW50TmFtZQEADWdldG91dF9yZXN1bHQBAA1zZXRvdXRfcmVzdWx0AQAGPGluaXQ+AQADKClWAQAGaW52b2tlAQANU3RhY2tNYXBUYWJsZQcAygcAlgcAyAcAsAcAywcAzAEACkV4Y2VwdGlvbnMHAM0BABZjb252ZXJ0VG9CaW5kaW5nU3RyaW5nAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAFWNvbnZlcnRUb0Rhc2hlZFN0cmluZwEAC3ByZWZpeFplcm9zAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQATY29udmVydFRvQnl0ZVN0cmluZwcAnAEAClNvdXJjZUZpbGUBAE9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzUmVtb3ZlX0dyb3VwX0VtcGxveWVlX0xEQVAxMS5qYXZhDABCAEMMAEQAQwwARQBDDABGAEMMAEcAQwwASABDDABJAEMMAEoAQwwASwBDDABMAEMMAE0AQwwATgBDDABPAEMMAFAAQwwAcQByAQAAAQATamF2YS91dGlsL0hhc2h0YWJsZQwAcQDOAQAbamF2YS5uYW1pbmcuZmFjdG9yeS5pbml0aWFsAQAgY29tLnN1bi5qbmRpLmxkYXAuTGRhcEN0eEZhY3RvcnkMAM8A0AEAGGphdmEubmFtaW5nLnByb3ZpZGVyLnVybAEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyAQAHbGRhcDovLwwA0QDSAQABOgwA0wBSAQAjamF2YS5uYW1pbmcuc2VjdXJpdHkuYXV0aGVudGljYXRpb24BAAZzaW1wbGUBAB5qYXZhLm5hbWluZy5zZWN1cml0eS5wcmluY2lwYWwBACBqYXZhLm5hbWluZy5zZWN1cml0eS5jcmVkZW50aWFscwEALXRpYmNvLmNsaWVudFZhci5Db25uZWN0aW9ucy9MREFQL0ludGVybm8vUGFzcwcA1AwA1QDWAQAiamF2YS5uYW1pbmcubGRhcC5hdHRyaWJ1dGVzLmJpbmFyeQEACm9iamVjdEdVSUQBAChqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0luaXRpYWxEaXJDb250ZXh0DABxANcHAMsMANgA2QEAASsMANoA2wEAGWphdmEvdXRpbC9TdHJpbmdUb2tlbml6ZXIMAHEA3AEAASwMAN0A3gwA3wBSAQAnamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Nb2RpZmljYXRpb25JdGVtAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9CYXNpY0F0dHJpYnV0ZQEABm1lbWJlcgwAcQDgDABxAOEMAOIA4wwA5ADlAQABJwcAygwA5gDnDADoAHIMAH8AfgwAgACBAQABLQEAATAMAHEAVgcA6QwA6gCBAQABXAEAtFBlb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzUmVtb3ZlX0dyb3VwX0VtcGxveWVlX0xEQVAxMQEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABBqYXZhL2xhbmcvU3RyaW5nAQAqW0xqYXZheC9uYW1pbmcvZGlyZWN0b3J5L01vZGlmaWNhdGlvbkl0ZW07AQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABChJKVYBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQAkY29tL3RpYmNvL3BlL3BsdWdpbi9QbHVnaW5Qcm9wZXJ0aWVzAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAGChMamF2YS91dGlsL0hhc2h0YWJsZTspVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEACGNvbnRh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</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$dnPrincipal/dnToOperate"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:EMPL_ID"/>
                </in_employeeid>
                <in_Groups_To_Add_user>
                    <xsl:value-of select="tib:substring-before-last($Search-ID_LDAP/javaCodeActivityOutput/out_member, '+')"/>
                </in_Groups_To_Add_user>
                <in_cn>
                    <xsl:value-of select="$Search-ID_LDAP/javaCodeActivityOutput/out_dn"/>
                </in_cn>
                <invalidChars>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/ProjectConfig/invalidChars"/>
                </invalidChars>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Log">
        <pd:type>com.tibco.pe.core.WriteToLogActivity</pd:type>
        <pd:resourceType>ae.activities.log</pd:resourceType>
        <pd:x>540</pd:x>
        <pd:y>576</pd:y>
        <config>
            <role>User</role>
        </config>
        <pd:inputBindings>
            <ns4:ActivityInput>
                <message>
                    <xsl:value-of select="concat('Employee: ', $Start/pfx7:EMPLOYEE/pfx7:EMPL_ID, 'did not hit the AD.')"/>
                </message>
            </ns4:ActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Search-ID_MANAGER">
        <pd:type>com.tibco.plugin.java.JavaActivity</pd:type>
        <pd:resourceType>ae.javapalette.javaActivity</pd:resourceType>
        <pd:x>109</pd:x>
        <pd:y>163</pd:y>
        <config>
            <fileName>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_MANAGER</fileName>
            <packageName>PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process</packageName>
            <fullsource>package PeopleSoftIdentityManagementMX.Employee_PeopleSoft_Process.Employee_PeopleSoft_To_ActiveDirectory_Process;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.NamingEnumeration;
import javax.naming.directory.Attributes;
import javax.naming.directory.BasicAttribute;
import javax.naming.directory.DirContext;
import javax.naming.directory.InitialDirContext;
import javax.naming.directory.ModificationItem;
import javax.naming.directory.SearchControls;
import javax.naming.directory.SearchResult;
import java.util.Vector;
import java.util.Enumeration;



public class Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_MANAGER{
/****** START SET/GET METHOD, DO NOT MODIFY *****/
	protected String in_userDN = "";
	protected String in_sAMAccountName = "";
	protected String in_server = "";
	protected String in_port = "";
	protected String in_dn = "";
	protected String in_employeeid = "";
	protected String in_certi_loc = "";
	protected String out_guid = "";
	protected String out_dn = "";
	protected String out_cn = "";
	protected String out_samAccountName = "";
	protected String out_member = "";
	protected String out_company = "";
	protected String out_mail = "";
	protected String out_poBox = "";
	protected String out_physicaldeliveryOfficeName = "";
	protected String out_location = "";
	protected String out_telephoneNumber = "";
	public String getin_userDN() {
		return in_userDN;
	}
	public void setin_userDN(String val) {
		in_userDN = val;
	}
	public String getin_sAMAccountName() {
		return in_sAMAccountName;
	}
	public void setin_sAMAccountName(String val) {
		in_sAMAccountName = val;
	}
	public String getin_server() {
		return in_server;
	}
	public void setin_server(String val) {
		in_server = val;
	}
	public String getin_port() {
		return in_port;
	}
	public void setin_port(String val) {
		in_port = val;
	}
	public String getin_dn() {
		return in_dn;
	}
	public void setin_dn(String val) {
		in_dn = val;
	}
	public String getin_employeeid() {
		return in_employeeid;
	}
	public void setin_employeeid(String val) {
		in_employeeid = val;
	}
	public String getin_certi_loc() {
		return in_certi_loc;
	}
	public void setin_certi_loc(String val) {
		in_certi_loc = val;
	}
	public String getout_guid() {
		return out_guid;
	}
	public void setout_guid(String val) {
		out_guid = val;
	}
	public String getout_dn() {
		return out_dn;
	}
	public void setout_dn(String val) {
		out_dn = val;
	}
	public String getout_cn() {
		return out_cn;
	}
	public void setout_cn(String val) {
		out_cn = val;
	}
	public String getout_samAccountName() {
		return out_samAccountName;
	}
	public void setout_samAccountName(String val) {
		out_samAccountName = val;
	}
	public String getout_member() {
		return out_member;
	}
	public void setout_member(String val) {
		out_member = val;
	}
	public String getout_company() {
		return out_company;
	}
	public void setout_company(String val) {
		out_company = val;
	}
	public String getout_mail() {
		return out_mail;
	}
	public void setout_mail(String val) {
		out_mail = val;
	}
	public String getout_poBox() {
		return out_poBox;
	}
	public void setout_poBox(String val) {
		out_poBox = val;
	}
	public String getout_physicaldeliveryOfficeName() {
		return out_physicaldeliveryOfficeName;
	}
	public void setout_physicaldeliveryOfficeName(String val) {
		out_physicaldeliveryOfficeName = val;
	}
	public String getout_location() {
		return out_location;
	}
	public void setout_location(String val) {
		out_location = val;
	}
	public String getout_telephoneNumber() {
		return out_telephoneNumber;
	}
	public void setout_telephoneNumber(String val) {
		out_telephoneNumber = val;
	}
/****** END SET/GET METHOD, DO NOT MODIFY *****/
	public Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_MANAGER() {
	}
	public void invoke() throws Exception {
/* Available Variables: DO NOT MODIFY
	In  : String in_userDN
	In  : String in_sAMAccountName
	In  : String in_server
	In  : String in_port
	In  : String in_dn
	In  : String in_employeeid
	In  : String in_certi_loc
	Out : String out_guid
	Out : String out_dn
	Out : String out_cn
	Out : String out_samAccountName
	Out : String out_member
	Out : String out_company
	Out : String out_mail
	Out : String out_poBox
	Out : String out_physicaldeliveryOfficeName
	Out : String out_location
	Out : String out_telephoneNumber
* Available Variables: DO NOT MODIFY *****/

		DirContext ldapContext;

	      Hashtable&lt;String, String&gt; ldapEnv = new Hashtable&lt;String, String&gt;(11);
              if (in_port.equals("636")) {
                  String keystore=in_certi_loc;
//"C:\\tibco\\tibcojre64\\1.7.0\\lib\\security\\cacerts2";

                  System.setProperty("javax.net.ssl.trustStore",keystore);
              }  else {
                 ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

	      ldapEnv.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
              
              if (in_port.equals("636")) {
                  ldapEnv.put(Context.SECURITY_PROTOCOL,"ssl");
                  ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "636");
              } else {
                ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + "389");
              }

              //ldapEnv.put(Context.PROVIDER_URL, "ldap://" + in_server + ":" + in_port);
	      ldapEnv.put(Context.SECURITY_AUTHENTICATION, "simple");
	      ldapEnv.put(Context.SECURITY_PRINCIPAL, in_userDN);
	      ldapEnv.put(Context.SECURITY_CREDENTIALS, com.tibco.pe.plugin.PluginProperties.getProperty("tibco.clientVar.Connections/LDAP/Interno/Pass"));
	      ldapEnv.put("java.naming.ldap.attributes.binary", "objectGUID");
	      

                            

	      ldapContext = new InitialDirContext(ldapEnv);

               
          // Create the search controls         
	      SearchControls searchCtls = new SearchControls();

	      //Specify the attributes to return
	      String returnedAtts[]={"objectGUID","distinguishedName", "cn","sAMAccountName","memberOf","mail","postOfficeBox","physicaldeliveryOfficeName","company","l","telephoneNumber"};
	      searchCtls.setReturningAttributes(returnedAtts);

	      //Specify the search scope
	      searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);
              

	      
	      // Search for objects using the filter
	      //NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

              
                //System.out.println(out_cn);  
				//Estaba asi !out_cn.equals("")
				// Cuando existe samacount siempre entra y son los datos que utiliza memeroff
				// Cuando no existe samaccount no entra y deberia checar con emplid
                out_cn="";
                if (out_cn.equals("") ) {
                  String searchFilter = "(&amp;(objectClass=user)(employeeID=" + in_employeeid + "))";
                  String searchBase = in_dn;
                  NamingEnumeration&lt;SearchResult&gt; answer = ldapContext.search(searchBase, searchFilter, searchCtls);

	          //Loop through the search results
                  out_guid = "";
	          while (answer.hasMoreElements())
	          {
	            SearchResult sr = (SearchResult)answer.next();

	            Attributes attrs = sr.getAttributes();
	        
	            byte[] guid = (byte[]) attrs.get("objectGUID").get();
		    out_guid = convertToBindingString(guid);
		    //out_guid = convertToByteString(guid);
                    String dn = attrs.get("distinguishedName").toString();
                    String[] name = dn.split(":");
                    out_dn = name[1].trim();
		    out_dn = out_dn.replace("á", "\\E1"); 
		    out_dn = out_dn.replace("é", "\\E9");
		    out_dn = out_dn.replace("í", "\\ED");
		    out_dn = out_dn.replace("ó", "\\F3");
		    out_dn = out_dn.replace("ú", "\\FA");
                    out_dn = out_dn.replace("ñ", "\\F1");
                    String cn = attrs.get("cn").toString();
                    String[] cname = cn.split(":");
                    out_cn = cname[1].trim();
                    
                   
                }
              }
              

	      ldapContext.close();
	}

	private static String convertToBindingString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(convertToDashedString(objectGUID));
	    
	    return displayStr.toString();
	}
	
	private static String convertToDashedString(byte[] objectGUID) {
	    StringBuilder displayStr = new StringBuilder();
	    
	    displayStr.append(prefixZeros((int) objectGUID[3] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[2] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[1] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[0] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[5] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[4] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[7] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[6] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[8] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[9] &amp; 0xFF));
	    displayStr.append("-");
	    displayStr.append(prefixZeros((int) objectGUID[10] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[11] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[12] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[13] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[14] &amp; 0xFF));
	    displayStr.append(prefixZeros((int) objectGUID[15] &amp; 0xFF));
	    
	    return displayStr.toString();
	}

	private static String prefixZeros(int value) {
	    if (value &lt;= 0xF) {
	        StringBuilder sb = new StringBuilder("0");
	        sb.append(Integer.toHexString(value));

	        return sb.toString();

	    } else {
	        return Integer.toHexString(value);
	    }
	}

	private static String convertToByteString(byte[] objectGUID) {
	    StringBuilder result = new StringBuilder();
	
	    for (int i = 0; i &lt; objectGUID.length; i++) {
	        String transformed = prefixZeros((int) objectGUID[i] &amp; 0xFF);
	        result.append("\\");
	        result.append(transformed);
	    }
	
	    return result.toString();
	}
}
</fullsource>
            <inputData>
                <row>
                    <fieldName>in_userDN</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_sAMAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_server</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_port</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_employeeid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>in_certi_loc</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </inputData>
            <outputData>
                <row>
                    <fieldName>out_guid</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_dn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_cn</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_samAccountName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_member</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_company</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_mail</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_poBox</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_physicaldeliveryOfficeName</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_location</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
                <row>
                    <fieldName>out_telephoneNumber</fieldName>
                    <fieldType>string</fieldType>
                    <fieldRequired>required</fieldRequired>
                </row>
            </outputData>
            <byteCode>
                <class>
                    <name>Employee_PeopleSoft_To_ActiveDirectory_ProcessSearchID_MANAGER</name>
                    <byteCode>yv66vgAAADMBSgkAZAC3CQBkALgJAGQAuQkAZAC6CQBkALsJAGQAvAkAZAC9CQBkAL4JAGQAvwkAZADACQBkAMEJAGQAwgkAZADDCQBkAMQJAGQAxQkAZADGCQBkAMcJAGQAyAoAZQDJCADKBwDLCgAVAMwIAM0KADQAzggAzwoA0ADRCADSBwDTCgAcAMkIANQKABwA1QgA1ggA1woAHADYCgAVANkIANoIANsIANwIAN0IAN4IAN8IAOAIAOEIAOIKAOMA5AgA5QgA5gcA5woAMADoBwDpCgAyAMkHAOoIAOsIAOwIAO0IAO4IAO8IAPAIAPEIAPIIAPMIAPQKADIA9QoAMgD2CAD3CAD4CwD5APoLAPsA/AsA+wD9BwD+CgBGAP8LAQABAQsBAgEDBwEECgBkAQUKAGUA2AoANAEGCgA0AQcIAQgIAQkKADQBCggBCwgBDAgBDQgBDggBDwgBEAgBEQgBEggBEwgBFAsA+QEVCgBkARYKAGQBFwgBGAgBGQoAHAEaCgEbARwIAR0HAR4HAR8BAAlpbl91c2VyRE4BABJMamF2YS9sYW5nL1N0cmluZzsBABFpbl9zQU1BY2NvdW50TmFtZQEACWluX3NlcnZlcgEAB2luX3BvcnQBAAVpbl9kbgEADWluX2VtcGxveWVlaWQBAAxpbl9jZXJ0aV9sb2MBAAhvdXRfZ3VpZAEABm91dF9kbgEABm91dF9jbgEAEm91dF9zYW1BY2NvdW50TmFtZQEACm91dF9tZW1iZXIBAAtvdXRfY29tcGFueQEACG91dF9tYWlsAQAJb3V0X3BvQm94AQAeb3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAMb3V0X2xvY2F0aW9uAQATb3V0X3RlbGVwaG9uZU51bWJlcgEADGdldGluX3VzZXJETgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEADHNldGluX3VzZXJETgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAFGdldGluX3NBTUFjY291bnROYW1lAQAUc2V0aW5fc0FNQWNjb3VudE5hbWUBAAxnZXRpbl9zZXJ2ZXIBAAxzZXRpbl9zZXJ2ZXIBAApnZXRpbl9wb3J0AQAKc2V0aW5fcG9ydAEACGdldGluX2RuAQAIc2V0aW5fZG4BABBnZXRpbl9lbXBsb3llZWlkAQAQc2V0aW5fZW1wbG95ZWVpZAEAD2dldGluX2NlcnRpX2xvYwEAD3NldGluX2NlcnRpX2xvYwEAC2dldG91dF9ndWlkAQALc2V0b3V0X2d1aWQBAAlnZXRvdXRfZG4BAAlzZXRvdXRfZG4BAAlnZXRvdXRfY24BAAlzZXRvdXRfY24BABVnZXRvdXRfc2FtQWNjb3VudE5hbWUBABVzZXRvdXRfc2FtQWNjb3VudE5hbWUBAA1nZXRvdXRfbWVtYmVyAQANc2V0b3V0X21lbWJlcgEADmdldG91dF9jb21wYW55AQAOc2V0b3V0X2NvbXBhbnkBAAtnZXRvdXRfbWFpbAEAC3NldG91dF9tYWlsAQAMZ2V0b3V0X3BvQm94AQAMc2V0b3V0X3BvQm94AQAhZ2V0b3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAhc2V0b3V0X3BoeXNpY2FsZGVsaXZlcnlPZmZpY2VOYW1lAQAPZ2V0b3V0X2xvY2F0aW9uAQAPc2V0b3V0X2xvY2F0aW9uAQAWZ2V0b3V0X3RlbGVwaG9uZU51bWJlcgEAFnNldG91dF90ZWxlcGhvbmVOdW1iZXIBAAY8aW5pdD4BAAMoKVYBAAZpbnZva2UBAA1TdGFja01hcFRhYmxlBwDLBwEeBwEgBwDpBwEhBwDqBwEiAQAKRXhjZXB0aW9ucwcBIwEAFmNvbnZlcnRUb0JpbmRpbmdTdHJpbmcBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAVY29udmVydFRvRGFzaGVkU3RyaW5nAQALcHJlZml4WmVyb3MBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBABNjb252ZXJ0VG9CeXRlU3RyaW5nBwDTAQAKU291cmNlRmlsZQEAQ0VtcGxveWVlX1Blb3BsZVNvZnRfVG9fQWN0aXZlRGlyZWN0b3J5X1Byb2Nlc3NTZWFyY2hJRF9NQU5BR0VSLmphdmEMAGYAZwwAaABnDABpAGcMAGoAZwwAawBnDABsAGcMAG0AZwwAbgBnDABvAGcMAHAAZwwAcQBnDAByAGcMAHMAZwwAdABnDAB1AGcMAHYAZwwAdwBnDAB4AGcMAKEAogEAAAEAE2phdmEvdXRpbC9IYXNodGFibGUMAKEBJAEAAzYzNgwBJQEmAQAYamF2YXgubmV0LnNzbC50cnVzdFN0b3JlBwEnDAEoASkBABhqYXZhLm5hbWluZy5wcm92aWRlci51cmwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAB2xkYXA6Ly8MASoBKwEAAToBAAMzODkMASwAegwBLQEuAQAbamF2YS5uYW1pbmcuZmFjdG9yeS5pbml0aWFsAQAgY29tLnN1bi5qbmRpLmxkYXAuTGRhcEN0eEZhY3RvcnkBAB1qYXZhLm5hbWluZy5zZWN1cml0eS5wcm90b2NvbAEAA3NzbAEAI2phdmEubmFtaW5nLnNlY3VyaXR5LmF1dGhlbnRpY2F0aW9uAQAGc2ltcGxlAQAeamF2YS5uYW1pbmcuc2VjdXJpdHkucHJpbmNpcGFsAQAgamF2YS5uYW1pbmcuc2VjdXJpdHkuY3JlZGVudGlhbHMBAC10aWJjby5jbGllbnRWYXIuQ29ubmVjdGlvbnMvTERBUC9JbnRlcm5vL1Bhc3MHAS8MATABMQEAImphdmEubmFtaW5nLmxkYXAuYXR0cmlidXRlcy5iaW5hcnkBAApvYmplY3RHVUlEAQAoamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9Jbml0aWFsRGlyQ29udGV4dAwAoQEyAQAlamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hDb250cm9scwEAEGphdmEvbGFuZy9TdHJpbmcBABFkaXN0aW5ndWlzaGVkTmFtZQEAAmNuAQAOc0FNQWNjb3VudE5hbWUBAAhtZW1iZXJPZgEABG1haWwBAA1wb3N0T2ZmaWNlQm94AQAacGh5c2ljYWxkZWxpdmVyeU9mZmljZU5hbWUBAAdjb21wYW55AQABbAEAD3RlbGVwaG9uZU51bWJlcgwBMwE0DAE1ASQBACAoJihvYmplY3RDbGFzcz11c2VyKShlbXBsb3llZUlEPQEAAikpBwEgDAE2ATcHASIMATgBOQwBOgE7AQAjamF2YXgvbmFtaW5nL2RpcmVjdG9yeS9TZWFyY2hSZXN1bHQMATwBPQcBPgwBPwFABwFBDAE/ATsBAAJbQgwArgCvDAFCAUMMAUQAegEAAsOhAQADXEUxDAFFAUYBAALDqQEAA1xFOQEAAsOtAQADXEVEAQACw7MBAANcRjMBAALDugEAA1xGQQEAAsOxAQADXEYxDAFHAKIMALAArwwAsQCyAQABLQEAATAMAKEAfgcBSAwBSQCyAQABXAEAqFBlb3BsZVNvZnRJZGVudGl0eU1hbmFnZW1lbnRNWC9FbXBsb3llZV9QZW9wbGVTb2Z0X1Byb2Nlc3MvRW1wbG95ZWVfUGVvcGxlU29mdF9Ub19BY3RpdmVEaXJlY3RvcnlfUHJvY2Vzcy9FbXBsb3llZV9QZW9wbGVTb2Z0X1RvX0FjdGl2ZURpcmVjdG9yeV9Qcm9jZXNzU2VhcmNoSURfTUFOQUdFUgEAEGphdmEvbGFuZy9PYmplY3QBACFqYXZheC9uYW1pbmcvZGlyZWN0b3J5L0RpckNvbnRleHQBABNbTGphdmEvbGFuZy9TdHJpbmc7AQAeamF2YXgvbmFtaW5nL05hbWluZ0VudW1lcmF0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABChJKVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBqYXZhL2xhbmcvU3lzdGVtAQALc2V0UHJvcGVydHkBADgoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBACRjb20vdGliY28vcGUvcGx1Z2luL1BsdWdpblByb3BlcnRpZXMBAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAYKExqYXZhL3V0aWwvSGFzaHRhYmxlOylWAQAWc2V0UmV0dXJuaW5nQXR0cmlidXRlcwEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAA5zZXRTZWFyY2hTY29wZQEABnNlYXJjaAEAbShMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YXgvbmFtaW5n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tgAfVysSX7YAH1crKhAHMxEA/364AF62AB9XKyoQBjMRAP9+uABetgAfVysSX7YAH1crKhAIMxEA/364AF62AB9XKyoQCTMRAP9+uABetgAfVysSX7YAH1crKhAKMxEA/364AF62AB9XKyoQCzMRAP9+uABetgAfVysqEAwzEQD/frgAXrYAH1crKhANMxEA/364AF62AB9XKyoQDjMRAP9+uABetgAfVysqEA8zEQD/frgAXrYAH1crtgAisAAAAAEAfAAAAFoAFgAAAQ4ACAEQABcBEQAmARIANQETAEQBFABLARUAWgEWAGkBFwBwARgAgAEZAJABGgCXARsApwEcALcBHQC+AR4AzgEfAN4BIADuASEA/gEiAQ4BIwEeASUACgCxALIAAQB7AAAAVAADAAIAAAAjGhAPowAbuwAcWRJgtwBhTCsauABitgAfVyu2ACKwGrgAYrAAAAACAHwAAAAWAAUAAAEpAAYBKgAQASsAGQEtAB4BMACkAAAAAwABHgAKALMArwABAHsAAAB1AAIABAAAADO7ABxZtwAdTAM9HCq+ogAhKhwzEQD/frgAXk4rEmO2AB9XKy22AB9XhAIBp//fK7YAIrAAAAACAHwAAAAeAAcAAAE1AAgBNwAQATgAGwE5ACIBOgAoATcALgE9AKQAAAAMAAL9AAoHALQB+gAjAAEAtQAAAAIAtg==</byteCode>
                </class>
            </byteCode>
        </config>
        <pd:inputBindings>
            <javaCodeActivityInput>
                <in_userDN>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/UserDN"/>
                </in_userDN>
                <in_sAMAccountName>
                    <xsl:value-of select="$Map-Data/login"/>
                </in_sAMAccountName>
                <in_server>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Server"/>
                </in_server>
                <in_port>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/Interno/Port"/>
                </in_port>
                <in_dn>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/LDAPAttributes/DNSearch"/>
                </in_dn>
                <in_employeeid>
                    <xsl:value-of select="$Start/pfx7:EMPLOYEE/pfx7:MANAGER_ID"/>
                </in_employeeid>
                <in_certi_loc>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Connections/LDAP/TCAPath"/>
                </in_certi_loc>
            </javaCodeActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:transition>
        <pd:from>Catch</pd:from>
        <pd:to>ErrorProcess (1)</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Map Data</pd:from>
        <pd:to>Search-ID_MANAGER</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Operacion-Fallo-1</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Search-ID_LDAP</pd:from>
        <pd:to>Search-ID_LDAP-2</pd:to>
        <pd:xpathDescription>Alta de Empleado</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-13434676</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Search-ID_LDAP/javaCodeActivityOutput/out_guid=""</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Search-ID_LDAP</pd:from>
        <pd:to>Assign-Modifica</pd:to>
        <pd:xpathDescription>Realizar Cambios</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16737895</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Search-ID_LDAP/javaCodeActivityOutput/out_guid!="" and  $Start/pfx7:EMPLOYEE/pfx7:EMPL_STAT!="T" and  $Start/pfx7:EMPLOYEE/pfx7:EMPL_STAT!="D"</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Search-ID_LDAP</pd:from>
        <pd:to>Assign Baja</pd:to>
        <pd:xpathDescription>Baja de Empleado</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-39424</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Search-ID_LDAP/javaCodeActivityOutput/out_guid!="" and  ($Start/pfx7:EMPLOYEE/pfx7:EMPL_STAT="T" or   $Start/pfx7:EMPLOYEE/pfx7:EMPL_STAT="D" )</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign Baja</pd:from>
        <pd:to>Remove_Group_Employee_LDAP-1-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Res Alta</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign Alta</pd:from>
        <pd:to>Assign-cnUser</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>Assign-Alta-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$_globalVariables/ns:GlobalVariables/Domain='PEAIMEX03'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Map-Data-1</pd:from>
        <pd:to>Add_Employee_LDAP</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_Group_Employee_LDAP</pd:from>
        <pd:to>Verificar Operacion</pd:to>
        <pd:xpathDescription>Add Group OK</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Add_Group_Employee_LDAP/javaCodeActivityOutput/out_result='Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign-cnUser</pd:from>
        <pd:to>Map-Data-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Remove_Group_Employee_LDAP-1</pd:from>
        <pd:to>Add_new_Group_Employee_LDAP</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Proccess_Groups</pd:from>
        <pd:to>Remove_Group_Employee_LDAP-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_Employee_LDAP</pd:from>
        <pd:to>Group (1)</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Group (1)</pd:from>
        <pd:to>Add_ControlCount_AD</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Verificar Operacion</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign-Modifica</pd:from>
        <pd:to>Assign-Grupos-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign-Alta-1</pd:from>
        <pd:to>Map Data</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Upd-Emp-Pend-Det</pd:from>
        <pd:to>GenerateError</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Search-ID_LDAP-2</pd:from>
        <pd:to>Assign Alta</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_ControlCount_AD</pd:from>
        <pd:to>Res Alta</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_ControlCount_AD</pd:from>
        <pd:to>Add_Group_Employee_LDAP</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Add_ControlCount_AD/javaCodeActivityOutput/out_result='Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign-Grupos-1</pd:from>
        <pd:to>Proccess_Groups</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_new_Group_Employee_LDAP</pd:from>
        <pd:to>Mod_Employee_LDAP-2</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Mod_Employee_LDAP-2</pd:from>
        <pd:to>Verificar Operacion</pd:to>
        <pd:xpathDescription>Succes Modify</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Mod_Employee_LDAP-2/javaCodeActivityOutput/out_result='Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Mod_Employee_LDAP-2</pd:from>
        <pd:to>Operacion-Fallo-1</pd:to>
        <pd:xpathDescription>Falla Cambios</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Baja_Count_AD</pd:from>
        <pd:to>Operacion-Fallo-1</pd:to>
        <pd:xpathDescription>Fallo Baja</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Baja_Count_AD</pd:from>
        <pd:to>Verificar Operacion</pd:to>
        <pd:xpathDescription>Succes Baja</pd:xpathDescription>
        <pd:lineType>Curved</pd:lineType>
        <pd:lineColor>-26368</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Baja_Count_AD/javaCodeActivityOutput/out_result='Success'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Add_Group_Employee_LDAP</pd:from>
        <pd:to>Res Alta</pd:to>
        <pd:xpathDescription>falla add gropup</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ErrorProcess (1)</pd:from>
        <pd:to>Upd-Emp-Pend-Det</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Remove_Group_Employee_LDAP-1-1</pd:from>
        <pd:to>Baja_Count_AD</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>Log</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Log</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Search-ID_MANAGER</pd:from>
        <pd:to>Search-ID_LDAP</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>