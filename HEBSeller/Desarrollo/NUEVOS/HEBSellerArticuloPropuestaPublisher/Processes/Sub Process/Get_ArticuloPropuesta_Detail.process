<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns="http://www.tibco.com/pe/DeployedVarsType" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:pfx2="http://www.tibco.com/pe/GenerateErrorActivity/InputSchema" xmlns:pfx="http://xmlns.heb.com/ei/Products" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <xsd:import namespace="http://xmlns.heb.com/ei/Products" schemaLocation="/Shared Resources/Schema Definitions/Custom/MAG_IMPORT_PRODUCTS_SOAP.xsd"/>
    <pd:name>Processes/Sub Process/Get_ArticuloPropuesta_Detail.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startType ref="pfx:BitacoraPropuestaArticulo"/>
    <pd:startX>160</pd:startX>
    <pd:startY>87</pd:startY>
    <pd:returnBindings>
        <xsl:copy-of select="$Map-Propuesta/Propuestas"/>
    </pd:returnBindings>
    <pd:endName>End</pd:endName>
    <pd:endType>
        <xsd:element name="Propuestas">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element ref="pfx:mag_import_products" minOccurs="0" maxOccurs="unbounded"/>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>
    </pd:endType>
    <pd:endX>525</pd:endX>
    <pd:endY>94</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables/>
    <pd:targetNamespace>http://xmlns.example.com/1519224942410</pd:targetNamespace>
    <pd:activity name="Map Propuesta">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>402</pd:x>
        <pd:y>91</pd:y>
        <config>
            <element>
                <xsd:element name="Propuestas">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element ref="pfx:mag_import_products" minOccurs="0" maxOccurs="unbounded"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <Propuestas>
                <xsl:for-each select="$JDBC-Get-Propuesta-Detail/resultSet/Record">
                    <pfx:mag_import_products>
                        <xsl:if test="store">
                            <store>
                                <xsl:value-of select="store"/>
                            </store>
                        </xsl:if>
                        <xsl:if test="websites">
                            <websites>
                                <xsl:value-of select="websites"/>
                            </websites>
                        </xsl:if>
                        <xsl:if test="attribute_set">
                            <attribute_set>
                                <xsl:value-of select="attribute_set"/>
                            </attribute_set>
                        </xsl:if>
                        <type>
                            <xsl:value-of select="type"/>
                        </type>
                        <category_ids>
                            <xsl:value-of select="category_ids"/>
                        </category_ids>
                        <Sku>
                            <xsl:value-of select="sku"/>
                        </Sku>
                        <has_options>
                            <xsl:value-of select="has_options"/>
                        </has_options>
                        <xsl:if test="name">
                            <name>
                                <xsl:value-of select="name"/>
                            </name>
                        </xsl:if>
                        <is_returnable>
                            <xsl:value-of select="0"/>
                        </is_returnable>
                        <xsl:if test="meta_title">
                            <meta_title>
                                <xsl:value-of select="meta_title"/>
                            </meta_title>
                        </xsl:if>
                        <meta_description>
                            <xsl:value-of select="meta_description"/>
                        </meta_description>
                        <page_layout>
                            <xsl:value-of select="'select'"/>
                        </page_layout>
                        <options_container>
                            <xsl:value-of select="'selected'"/>
                        </options_container>
                        <gift_wrapping_available>
                            <xsl:value-of select="0"/>
                        </gift_wrapping_available>
                        <marca>
                            <xsl:value-of select="marca"/>
                        </marca>
                        <Weight>
                            <xsl:value-of select="weight"/>
                        </Weight>
                        <price>
                            <xsl:value-of select="price"/>
                        </price>
                        <Status>
                            <xsl:value-of select="status"/>
                        </Status>
                        <is_recurring>
                            <xsl:value-of select="'No'"/>
                        </is_recurring>
                        <visibility>
                            <xsl:value-of select="visibility"/>
                        </visibility>
                        <tax_class_id>
                            <xsl:value-of select="0"/>
                        </tax_class_id>
                        <description>
                            <xsl:value-of select="description"/>
                        </description>
                        <short_description>
                            <xsl:value-of select="short_description"/>
                        </short_description>
                        <meta_keyword>
                            <xsl:value-of select="0"/>
                        </meta_keyword>
                        <qty>
                            <xsl:value-of select="if (string-length(qty) !=0)&#xA;then&#xA;round(qty)&#xA;else&#xA;0"/>
                        </qty>
                        <min_qty>
                            <xsl:value-of select="1"/>
                        </min_qty>
                        <use_config_min_qty>
                            <xsl:value-of select="1"/>
                        </use_config_min_qty>
                        <xsl:if test="is_qty_decimal">
                            <is_qty_decimal>
                                <xsl:value-of select="is_qty_decimal"/>
                            </is_qty_decimal>
                        </xsl:if>
                        <backorders>
                            <xsl:value-of select="0"/>
                        </backorders>
                        <use_config_backorders>
                            <xsl:value-of select="1"/>
                        </use_config_backorders>
                        <min_sale_qty>
                            <xsl:value-of select="1"/>
                        </min_sale_qty>
                        <use_config_min_sale_qty>
                            <xsl:value-of select="0"/>
                        </use_config_min_sale_qty>
                        <max_sale_qty>
                            <xsl:value-of select="0"/>
                        </max_sale_qty>
                        <use_config_max_sale_qty>
                            <xsl:value-of select="1"/>
                        </use_config_max_sale_qty>
                        <is_in_stock>
                            <xsl:value-of select="is_in_stock"/>
                        </is_in_stock>
                        <notify_stock_qty>
                            <xsl:value-of select="0"/>
                        </notify_stock_qty>
                        <use_config_notify_stock_qty>
                            <xsl:value-of select="0"/>
                        </use_config_notify_stock_qty>
                        <manage_stock>
                            <xsl:value-of select="1"/>
                        </manage_stock>
                        <use_config_manage_stock>
                            <xsl:value-of select="1"/>
                        </use_config_manage_stock>
                        <stock_status_changed_auto>
                            <xsl:value-of select="1"/>
                        </stock_status_changed_auto>
                        <use_config_qty_increments>
                            <xsl:value-of select="1"/>
                        </use_config_qty_increments>
                        <qty_increments>
                            <xsl:value-of select="1"/>
                        </qty_increments>
                        <use_config_enable_qty_inc>
                            <xsl:value-of select="1"/>
                        </use_config_enable_qty_inc>
                        <enable_qty_increments>
                            <xsl:value-of select="0"/>
                        </enable_qty_increments>
                        <is_decimal_divided>
                            <xsl:value-of select="0"/>
                        </is_decimal_divided>
                        <stock_status_changed_automatically>
                            <xsl:value-of select="1"/>
                        </stock_status_changed_automatically>
                        <use_config_enable_qty_increments>
                            <xsl:value-of select="1"/>
                        </use_config_enable_qty_increments>
                        <product_name>
                            <xsl:value-of select="product_name"/>
                        </product_name>
                        <store_id>
                            <xsl:value-of select="0"/>
                        </store_id>
                        <product_type_id>
                            <xsl:value-of select="product_type_id"/>
                        </product_type_id>
                        <departamento>
                            <xsl:value-of select="departamento"/>
                        </departamento>
                        <ficha_tecnica>
                            <xsl:value-of select="ficha_tecnica"/>
                        </ficha_tecnica>
                        <exclusivo_internet>
                            <xsl:value-of select="1"/>
                        </exclusivo_internet>
                        <presentacion>
                            <xsl:value-of select="presentacion"/>
                        </presentacion>
                        <es_pesable>
                            <xsl:value-of select="es_pesable"/>
                        </es_pesable>
                        <peso_unitario>
                            <xsl:value-of select="peso_unitario"/>
                        </peso_unitario>
                        <ean>
                            <xsl:value-of select="ean"/>
                        </ean>
                        <familia_comercial>
                            <xsl:value-of select="familia_comercial"/>
                        </familia_comercial>
                        <subfam_comercial>
                            <xsl:value-of select="subfam_comercial"/>
                        </subfam_comercial>
                        <color_configurable>
                            <xsl:value-of select="color_configurable"/>
                        </color_configurable>
                        <talla_configurable>
                            <xsl:value-of select="talla_configurable"/>
                        </talla_configurable>
                        <parent_sku>
                            <xsl:value-of select="parent_sku"/>
                        </parent_sku>
                        <xsl:if test="unidades_de_compra">
                            <unidades_de_compra>
                                <xsl:value-of select="unidades_de_compra"/>
                            </unidades_de_compra>
                        </xsl:if>
                        <vendor_name>
                            <xsl:value-of select="Vendor_name"/>
                        </vendor_name>
                    </pfx:mag_import_products>
                </xsl:for-each>
            </Propuestas>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="JDBC Get Propuesta Detail">
        <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
        <pd:x>277</pd:x>
        <pd:y>96</pd:y>
        <config>
            <timeout>%%Connections/Database/dbHEB2B/GLB_TIMEOUT%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/Database/dbHEB2B/GLB_MAX_ROWS_D%%</maxRows>
            <emptyStrAsNil>true</emptyStrAsNil>
            <jdbcSharedConfig>/Shared Resources/Connections/Database/dbHEB2B.sharedjdbc</jdbcSharedConfig>
            <statement>select  distinct PA.Id
	 ,  'admin' as 'store'
	 , (select Valor from dbheb2b..parametrossistema where Descripcion = 'eCommerceTiendaNacional') +
	   ( Select ',heb_' + S.IdPMM from dbHEB2B..Sucursal S  join dbHEB2B..SucursalAddIns SAI on SAI.IdSucursal =  S.Id and  SAI.EseCommerce=1 order by S.IdPMM for xml path('') )  as 'websites'
	,	case when isnull(DC1.IdPMM,DC2.IdPMM) is not null 
			 then 'Configurable'
			 else case when DC1.IdPMM is not null then 'Talla' 
			 else case when DC2.IdPMM is not null then 'Color' 
			 else 'Default HEB' end end end                              as 'attribute_set'
     ,  case when PA.EsEstilo = 1  then 'configurable' else 'simple' end as 'type'
	 ,	  ( ParSis.Valor + ',' )
		+ (case when RSHM1.IdMagento  is not null then       ltrim(rtrim(RSHM1.IdMagento))   else '' end 
		+  case when RSHM2.IdMagento  is not null then ',' + ltrim(rtrim(RSHM2.IdMagento))   else '' end 
		+  case when RSHM3.IdMagento  is not null then ',' + ltrim(rtrim(RSHM3.IdMagento))   else '' end 
		+  case when RSHM4.IdMagento  is not null then ',' + ltrim(rtrim(RSHM4.IdMagento))   else '' end 
		+  case when RSHM5.IdMagento  is not null then ',' + ltrim(rtrim(RSHM5.IdMagento))   else '' end 
		+  case when RSHM6.IdMagento  is not null then ',' + ltrim(rtrim(RSHM6.IdMagento))   else '' end 
		+  case when RSHM7.IdMagento  is not null then ',' + ltrim(rtrim(RSHM7.IdMagento))   else '' end 
		+  case when RSHM8.IdMagento  is not null then ',' + ltrim(rtrim(RSHM8.IdMagento))   else '' end 
		+  case when RSHM9.IdMagento  is not null then ',' + ltrim(rtrim(RSHM9.IdMagento))   else '' end 
		+  case when RSHM10.IdMagento is not null then ',' + ltrim(rtrim(RSHM10.IdMagento))  else '' end 
		+  case when RSHM11.IdMagento is not null then ',' + ltrim(rtrim(RSHM11.IdMagento))  else '' end 
		+  case when RSHM12.IdMagento is not null then ',' + ltrim(rtrim(RSHM12.IdMagento))  else '' end ) as 'category_ids'
     ,  substring( replace(P.nombre,' ',''),1, 3 ) +'-'+ltrim(rtrim(PA.Id))                      as 'sku'
     ,  case when PA.EsEstilo = 1  then 1 else 0 end                                             as 'has_options'
     ,  PA.DescripcionGeneral    as 'name'
     ,  PA.DescripcionGeneral    as 'meta_title'
     ,  PA.DescripcionEspecifica as 'meta_description'
     ,  case when isnull(PAAF.Marca,'') = '' then  M.Descripcion else  PAAF.Marca end            as 'marca'
     ,  isnull(PA.PesoBruto,0)   as 'weight'
     ,  PAP.PrecioVentaSugerido  as 'price'
     ,  TS.Status                as 'status'
     ,  4                        as 'visibility'		
     ,  PA.DescripcionGeneral    as 'description'
     ,  PA.DescripcionEspecifica as 'short_description'
     ,  PAAF.Existencia          as 'qty'
	 ,  TS.Status                as 'is_in_stock'		
	 ,  PA.DescripcionGeneral    as 'product_name'
	 ,  PAAF.Talla               as 'talla_configurable'
     ,  PAAF.Color               as 'color_configurable'
	 ,  case when PA.EsEstilo = 1 then 'Configurable' else 'Simple' end         as 'product_type_id'
	 ,  ltrim(rtrim(isnull(D.Descripcion,'DESCONOCIDO')))						as 'departamento'
	 ,  convert(varchar(max),PAAF.FichaTecnica) 
	  + PA.DescripcionEspecifica 
	  + case when isnull(PAAF.Marca,'') = '' then  M.Descripcion else  PAAF.Marca end 
	  + isnull(PAAF.Talla,'')
	  + isnull(PAAF.Color,'')                                                                as 'ficha_tecnica'
     ,  ltrim(rtrim(cast(PA.CapacidadPresentacion as int))) + ' ' + ltrim(rtrim(UMA.IdPMM))  as 'presentacion'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then 1 else 0 end as 'es_pesable'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then isnull(PA.PesoBruto,0) else null end as 'peso_unitario'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%'  then 'KG' else 'PZ' end as 'unidades_de_compra'
	 ,  PA.CodigoBarras																														as 'ean'
	 ,  ltrim(rtrim(isnull(C.Descripcion,'DESCONOCIDO')))																					as 'familia_comercial'
	 ,  ltrim(rtrim(isnull(S.Descripcion,'DESCONOCIDO')))																					as 'subfam_comercial'
	 ,  Null																																as 'parent_sku'
     ,  P.nombre																															as 'Vendor_name'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then 1.000 else 0 end as 'is_qty_decimal'
	FROM dbHEB2B..BitacoraPropuestaArticulo BPA 
	JOIN dbHEB2B..propuestaArticulo PA						  ON BPA.IdPropuestaArticulo = PA.Id
	JOIN dbHEB2B..proveedor P								  ON PA.IdProveedor = P.Id
	left JOIN dbHEB2B..marca M								  ON PA.IdMarca = M.Id
	JOIN dbHEB2B..UnidadMedidaArticulo UMA					  ON PA.idunidadpresentacion = UMA.Id
	JOIN dbHEB2B..propuestaarticuloprecio PAP			      ON PA.Id = PAP.IdPropuestaArticulo
	LEFT JOIN dbHEB2B..PropuestaArticuloEstilo  PAE			  ON PA.Id = PAE.IdPropuestaArticulo
	LEFT JOIN dbHEB2B..DimensionCodigo DC1					  ON PAE.IdDimensionCodigoUno  = DC1.Id
	LEFT JOIN dbHEB2B..DimensionCodigo DC2			  	  	  ON PAE.IdDimensionCodigoDos  = DC2.Id
	LEFT JOIN dbHEB2B..Dimension  D1					      ON  DC1.IdDimension = D1.Id
	LEFT JOIN dbHEB2B..Dimension  D2					      ON  DC2.IdDimension = D2.Id
	JOIN dbHEB2B..PropuestaArticuloAddField PAAF			  ON BPA.IdPropuestaArticulo = PAAF.idpropuestaArticulo
	left join dbHEB2B..parametrossistema ParSis	              On  ParSis.Descripcion = 'eCommerceCategoryDefault'
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM1	  ON PAAF.IdL1  = RSHM1.Id  and RSHM1.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM2	  ON PAAF.IdL2  = RSHM2.Id  and RSHM2.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM3 	  ON PAAF.IdL3  = RSHM3.Id  and RSHM3.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM4 	  ON PAAF.IdL4  = RSHM4.Id  and RSHM4.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM5	  ON PAAF.IdL5  = RSHM5.Id  and RSHM5.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM6	  ON PAAF.IdL6  = RSHM6.Id  and RSHM6.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM7 	  ON PAAF.IdL7  = RSHM7.Id  and RSHM7.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM8 	  ON PAAF.IdL8  = RSHM8.Id  and RSHM8.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM9	  ON PAAF.IdL9  = RSHM9.Id  and RSHM9.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM10   ON PAAF.IdL10 = RSHM10.Id and RSHM10.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM11	  ON PAAF.IdL11 = RSHM11.Id and RSHM11.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM12	  ON PAAF.IdL12 = RSHM12.Id and RSHM12.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..TypeStatus TS						  ON PAAF.IdTypeStatus = TS.Id

	left join dbHEB2B..departamento D						  On  PAAF.Iddepartamento = D.Id
	left join dbHEB2B..categoria C		     				  On  PAAF.Idcategoria    = C.Id
	left join dbHEB2B..subcategoria S		     			  On  PAAF.Idsubcategoria = S.Id

    WHERE  BPA.IdPropuestaArticulo =?
	and  PA.IdEstatusPropuesta = 15
UNION
Select  distinct PA.Id
	 ,  'admin' as 'store'
	 , (select Valor from dbheb2b..parametrossistema where Descripcion = 'eCommerceTiendaNacional') +
	   ( Select ',heb_' + S.IdPMM from dbHEB2B..Sucursal S  join dbHEB2B..SucursalAddIns SAI on SAI.IdSucursal =  S.Id and  SAI.EseCommerce=1 order by S.IdPMM for xml path('') )  as 'websites'
	 ,	case when isnull(DC1.IdPMM,DC2.IdPMM) is not null 
			 then 'Configurable'
			 else case when DC1.IdPMM is not null then 'Talla' 
			 else case when DC2.IdPMM is not null then 'Color' 
			 else 'Default HEB' end end end                              as 'attribute_set'
     ,  'simple'                               as 'type'
	 ,	  ( ParSis.Valor + ',' )
		+ (case when RSHM1.IdMagento  is not null then       ltrim(rtrim(RSHM1.IdMagento))   else '' end 
		+  case when RSHM2.IdMagento  is not null then ',' + ltrim(rtrim(RSHM2.IdMagento))   else '' end 
		+  case when RSHM3.IdMagento  is not null then ',' + ltrim(rtrim(RSHM3.IdMagento))   else '' end 
		+  case when RSHM4.IdMagento  is not null then ',' + ltrim(rtrim(RSHM4.IdMagento))   else '' end 
		+  case when RSHM5.IdMagento  is not null then ',' + ltrim(rtrim(RSHM5.IdMagento))   else '' end 
		+  case when RSHM6.IdMagento  is not null then ',' + ltrim(rtrim(RSHM6.IdMagento))   else '' end 
		+  case when RSHM7.IdMagento  is not null then ',' + ltrim(rtrim(RSHM7.IdMagento))   else '' end 
		+  case when RSHM8.IdMagento  is not null then ',' + ltrim(rtrim(RSHM8.IdMagento))   else '' end 
		+  case when RSHM9.IdMagento  is not null then ',' + ltrim(rtrim(RSHM9.IdMagento))   else '' end 
		+  case when RSHM10.IdMagento is not null then ',' + ltrim(rtrim(RSHM10.IdMagento))  else '' end 
		+  case when RSHM11.IdMagento is not null then ',' + ltrim(rtrim(RSHM11.IdMagento))  else '' end 
		+  case when RSHM12.IdMagento is not null then ',' + ltrim(rtrim(RSHM12.IdMagento))  else '' end ) as 'category_ids'
	 ,  substring(replace(P.nombre,' ',''),1, 3 ) +'-'+ ltrim(rtrim(PA.Id)) + ltrim(rtrim(PAE.Id))                  as 'sku'
     ,  0                        as 'has_options'
     ,  PA.DescripcionGeneral    as 'name'
     ,  PA.DescripcionGeneral    as 'meta_title'
     ,  PA.DescripcionEspecifica as 'meta_description'
     ,  case when isnull(PAAF.Marca,'') = '' then  M.Descripcion else  PAAF.Marca end            as 'marca'
     ,  isnull(PA.PesoBruto,0)   as 'weight'
     ,  PAP.PrecioVentaSugerido  as 'price'
     ,  TS.Status                as 'status'
     ,  1                        as 'visibility'		
     ,  PA.DescripcionGeneral    as 'description'
     ,  PA.DescripcionEspecifica as 'short_description'
     ,  PAAF.Existencia          as 'qty'
	 ,  TS.Status                as 'is_in_stock'		
	 ,  PA.DescripcionGeneral    as 'product_name'
	 ,  ltrim(rtrim(isnull(DC1.IdPMM,'')))										as 'talla_configurable'
	 ,  ltrim(rtrim(isnull(DC2.IdPMM,'')))										as 'color_configurable'
	 ,  'simple'																as 'product_type_id'
	 ,  ltrim(rtrim(isnull(D.Descripcion,'DESCONOCIDO')))						as 'departamento'
	 ,  convert(varchar(max),PAAF.FichaTecnica) 
	  + PA.DescripcionEspecifica 
	  + case when isnull(PAAF.Marca,'') = '' then  M.Descripcion else  PAAF.Marca end 
	  + isnull(PAAF.Talla,'')
	  + isnull(PAAF.Color,'')                                                                as 'ficha_tecnica'
     ,  ltrim(rtrim(cast(PA.CapacidadPresentacion as int))) + ' ' + ltrim(rtrim(UMA.IdPMM))  as 'presentacion'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then 1 else 0 end as 'es_pesable'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then isnull(PA.PesoBruto,0) else null end as 'peso_unitario'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%'  then 'KG' else 'PZ' end as 'unidades_de_compra'
	 ,  PAE.CodigoBarras                                            as 'ean'
	 ,  ltrim(rtrim(isnull(C.Descripcion,'DESCONOCIDO')))           as 'familia_comercial'
     ,  ltrim(rtrim(isnull(S.Descripcion,'DESCONOCIDO')))           as 'subfam_comercial'
	 ,  substring(P.nombre,1, 3 ) +'-'+  ltrim(rtrim(PA.Id))        as 'parent_sku'
     ,  P.nombre                                                    as 'Vendor_name'
	 ,  case when upper(UMA.descripcion) like '%GRAM%' or upper(UMA.descripcion) like '%KG%' or upper(UMA.descripcion) like '%KILOGRAM%' then 1.000 else 0 end as 'is_qty_decimal'
	FROM dbHEB2B..BitacoraPropuestaArticulo BPA 
	JOIN dbHEB2B..propuestaArticulo PA						  ON BPA.IdPropuestaArticulo = PA.Id
	JOIN dbHEB2B..proveedor P								  ON PA.IdProveedor = P.Id
	left JOIN dbHEB2B..marca M									  ON PA.IdMarca = M.Id
	JOIN dbHEB2B..UnidadMedidaArticulo UMA					  ON PA.idunidadpresentacion = UMA.Id
	JOIN dbHEB2B..propuestaarticuloprecio PAP			      ON PA.Id = PAP.IdPropuestaArticulo
	LEFT JOIN dbHEB2B..PropuestaArticuloEstilo  PAE			  ON PA.Id = PAE.IdPropuestaArticulo
	LEFT JOIN dbHEB2B..DimensionCodigo DC1					  ON PAE.IdDimensionCodigoUno  = DC1.Id
	LEFT JOIN dbHEB2B..DimensionCodigo DC2			  	  	  ON PAE.IdDimensionCodigoDos  = DC2.Id
	LEFT JOIN dbHEB2B..Dimension  D1					      ON  DC1.IdDimension = D1.Id
	LEFT JOIN dbHEB2B..Dimension  D2					      ON  DC2.IdDimension = D2.Id
	JOIN dbHEB2B..PropuestaArticuloAddField PAAF			  ON BPA.IdPropuestaArticulo = PAAF.idpropuestaArticulo
	left join dbHEB2B..parametrossistema ParSis	              On  ParSis.Descripcion = 'eCommerceCategoryDefault'
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM1	  ON PAAF.IdL1  = RSHM1.Id  and RSHM1.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM2	  ON PAAF.IdL2  = RSHM2.Id  and RSHM2.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM3 	  ON PAAF.IdL3  = RSHM3.Id  and RSHM3.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM4 	  ON PAAF.IdL4  = RSHM4.Id  and RSHM4.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM5	  ON PAAF.IdL5  = RSHM5.Id  and RSHM5.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM6	  ON PAAF.IdL6  = RSHM6.Id  and RSHM6.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM7 	  ON PAAF.IdL7  = RSHM7.Id  and RSHM7.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM8 	  ON PAAF.IdL8  = RSHM8.Id  and RSHM8.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM9	  ON PAAF.IdL9  = RSHM9.Id  and RSHM9.IdMagento  &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM10   ON PAAF.IdL10 = RSHM10.Id and RSHM10.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM11	  ON PAAF.IdL11 = RSHM11.Id and RSHM11.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..RelationshipHierarchyMagento  RSHM12	  ON PAAF.IdL12 = RSHM12.Id and RSHM12.IdMagento &lt;&gt; ParSis.Valor
	LEFT JOIN dbHEB2B..TypeStatus TS						  ON PAAF.IdTypeStatus = TS.Id
	left join dbHEB2B..departamento D						  On  PAAF.Iddepartamento = D.Id
	left join dbHEB2B..categoria C		     				  On  PAAF.Idcategoria    = C.Id
	left join dbHEB2B..subcategoria S		     			  On  PAAF.Idsubcategoria = S.Id
	WHERE  PA.EsEstilo=1  
	and BPA.IdPropuestaArticulo =?
	and  PA.IdEstatusPropuesta = 15</statement>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>IdPropuestaEstilos</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
                <parameter>
                    <parameterName>IdPropuestaVariaciones</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
            </Prepared_Param_DataType>
            <oraObjects/>
            <oraTables/>
            <QueryOutputCachedSchemaColumns>Id</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>store</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>websites</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>-1</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar(max)</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>attribute_set</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>type</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>category_ids</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>sku</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>has_options</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>name</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>meta_title</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>meta_description</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>marca</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>-1</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar(max)</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>weight</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>6</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>float</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>price</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>3</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>decimal</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>status</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>visibility</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>description</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>short_description</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>qty</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>3</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>decimal</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>is_in_stock</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>product_name</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>talla_configurable</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>color_configurable</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>product_type_id</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>departamento</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ficha_tecnica</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>-1</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar(max)</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>presentacion</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>es_pesable</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>peso_unitario</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>6</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>float</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>unidades_de_compra</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>ean</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>familia_comercial</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>subfam_comercial</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>parent_sku</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>Vendor_name</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>nvarchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>RequiredElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>is_qty_decimal</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>2</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>numeric</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
        </config>
        <pd:inputBindings>
            <jdbcQueryActivityInput>
                <IdPropuestaEstilos>
                    <xsl:choose>
                        <xsl:when test="exists($Start/pfx:BitacoraPropuestaArticulo/IdPropuestaArticulo)">
                            <xsl:value-of select="$Start/pfx:BitacoraPropuestaArticulo/IdPropuestaArticulo"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </IdPropuestaEstilos>
                <IdPropuestaVariaciones>
                    <xsl:choose>
                        <xsl:when test="exists($Start/pfx:BitacoraPropuestaArticulo/IdPropuestaArticulo)">
                            <xsl:value-of select="$Start/pfx:BitacoraPropuestaArticulo/IdPropuestaArticulo"/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:attribute name="xsi:nil">true</xsl:attribute>
                        </xsl:otherwise>
                    </xsl:choose>
                </IdPropuestaVariaciones>
            </jdbcQueryActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Generate Error">
        <pd:type>com.tibco.pe.core.GenerateErrorActivity</pd:type>
        <pd:resourceType>ae.activities.throw</pd:resourceType>
        <pd:x>279</pd:x>
        <pd:y>229</pd:y>
        <config>
            <faultName/>
        </config>
        <pd:inputBindings>
            <pfx2:ActivityInput>
                <message>
                    <xsl:value-of select="concat('ERROR :: La Propuesta ',$Start/pfx:BitacoraPropuestaArticulo/IdPropuestaArticulo , ' no contiene  informacion favor de revisar la consistencia de los datos')"/>
                </message>
                <messageCode>
                    <xsl:value-of select="'BWENGINE-100030'"/>
                </messageCode>
            </pfx2:ActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>JDBC Get Propuesta Detail</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Map Propuesta</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>JDBC Get Propuesta Detail</pd:from>
        <pd:to>Map Propuesta</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>JDBC Get Propuesta Detail</pd:from>
        <pd:to>Generate Error</pd:to>
        <pd:xpathDescription>Is empty</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>count($JDBC-Get-Propuesta-Detail/resultSet/Record)&lt;=0</pd:xpath>
    </pd:transition>
</pd:ProcessDefinition>